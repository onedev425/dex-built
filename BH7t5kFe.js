function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["CRWIkueS.js","assets/index-CyIKZwcA.js","assets/index-C3LuW5Z2.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as t,s as T,j as e,F as c,K as at,Q as ce,T as m,t as s,p as ee,V as Bt,I as z,v as ye,X as Wt,bj as Ut,q as A,w as pe,A as te,ba as Vt,bb as Ht,bc as q,aM as je,L as _e,a4 as nt,bk as Qt,$ as se,a9 as ae,bl as qt,aJ as ze,bm as Gt,D as Z,ap as it,ab as lt,aq as rt,ar as ot,ao as we,at as ct,ak as dt,am as Ie,av as mt,bn as Kt,ag as Fe,aw as Re,B as Yt,z as Zt,bo as Jt,be as pt,P as Xt,aL as es,k as ts,af as ss,bg as as,bp as ns,bq as is,br as ls,bi as rs,Z as os,bs as cs,__tla as ds}from"./assets/index-CyIKZwcA.js";import{a as ms,b as ps,c as us,u as xs,A as ut}from"./nBoaRR4P.js";import{S as gs}from"./BGeRo-1L.js";import{G as hs}from"./Cse5bgR0.js";import{I as fs}from"./nkxDqpDa.js";import{u as xt}from"./C20jg5MW.js";import{u as bs}from"./CWmyRVe8.js";import{u as Le,__tla as ys}from"./BQokClGM.js";import{g as js,a as ws,u as vs,T as Ss,b as Cs,c as gt,d as As,e as ht,__tla as Ns}from"./DaRmYrn3.js";import{C as ft,__tla as Os}from"./VQNeEiYk.js";import{u as ks,C as Ms}from"./B7ad4Bv7.js";import{u as Ds}from"./CbB86d3W.js";import{R as Ts}from"./DG2H1jGl.js";import{I as Ps}from"./CzdZMSiN.js";import{P as _s}from"./xyTk0RBf.js";import{u as zs}from"./BlqyVemR.js";import{A as Is}from"./CBlIVkVu.js";import{u as Fs,__tla as Rs}from"./CJ_Ik3qV.js";import"./CkVRNEhN.js";import"./DYrZbK8R.js";import"./C2yJ0wdw.js";import"./B3Cf38Ih.js";import"./Cm6z4UIW.js";import"./Bfr6H5f3.js";import"./CRWIkueS.js";import{__tla as Ls}from"./Cx7gR159.js";import"./rzhudTEk.js";import"./l25LWlPl.js";let bt,Es=Promise.all([(()=>{try{return ds}catch{}})(),(()=>{try{return ys}catch{}})(),(()=>{try{return Ns}catch{}})(),(()=>{try{return Os}catch{}})(),(()=>{try{return Rs}catch{}})(),(()=>{try{return Ls}catch{}})()]).then(async()=>{(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},u=new Error().stack;u&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[u]="92eb2fbd-4995-45e5-b8fa-801f708261ef",n._sentryDebugIdIdentifier="sentry-dbid-92eb2fbd-4995-45e5-b8fa-801f708261ef")}catch{}})();const Ee=({stream:n,toggleStream:u,canStream:o,outputAsset:i,quote:r,invertedPriceDiff:p,title:g})=>{var x,y,C,b;const f=((r==null?void 0:r.estimatedTime)||0)*1e3,a=(((x=r==null?void 0:r.streamingSwap)==null?void 0:x.estimatedTime)||0)*1e3,j=a&&f?a-f:0,O=(y=r==null?void 0:r.streamingSwap)!=null&&y.expectedOutputUSD?Number(r.streamingSwap.expectedOutputUSD)-Number(r.expectedOutputUSD):0,N=(C=r==null?void 0:r.streamingSwap)!=null&&C.expectedOutputUSD?Number(r.expectedOutputUSD)-Number(r.streamingSwap.expectedOutputUSD):0,k=p?N:O,S=t.useMemo(()=>new T({value:(r==null?void 0:r.expectedOutput)||"0",decimal:(i==null?void 0:i.decimal)||0}),[i==null?void 0:i.decimal,r==null?void 0:r.expectedOutput]),l=t.useMemo(()=>{var d;return new T({value:((d=r==null?void 0:r.streamingSwap)==null?void 0:d.expectedOutput)||"0",decimal:(i==null?void 0:i.decimal)||0})},[i==null?void 0:i.decimal,(b=r==null?void 0:r.streamingSwap)==null?void 0:b.expectedOutput]),h=xt();return e.jsx(c,{animateOpacity:!0,as:at,in:o,w:"100%",children:e.jsxs(ce,{gap:2,p:3,sx:{w:"full",borderRadius:16},variant:"filledContainerTertiary",children:[e.jsxs(c,{children:[e.jsx(m,{color:"textSecondary",fontWeight:"semibold",ml:2,textStyle:"caption",children:g||s("views.swap.priceOptimizationAvailable")}),e.jsx(ee,{content:s("views.swap.priceOptimizationInfo"),onClick:()=>Bt(Wt),place:"bottom",children:e.jsx(z,{className:"ml-1",color:"secondary",name:"infoCircle",size:18})})]}),e.jsxs(c,{gap:1,children:[e.jsx(ce,{borderColor:n?"brand.btnPrimary":void 0,flex:1,onClick:()=>u(!0),px:2,py:1,sx:{cursor:"pointer"},variant:"filledTertiary",children:e.jsxs(c,{direction:"column",children:[e.jsxs(c,{align:"center",gap:1,justify:"space-between",children:[e.jsx(m,{textStyle:"caption-xs",children:s("views.swap.priceOptimized")}),e.jsx(z,{color:"yellow",name:"coin",size:20})]}),e.jsx(c,{gap:1,children:e.jsxs(c,{direction:"column",mt:.5,children:[e.jsx(c,{gap:1,children:e.jsx(m,{fontWeight:"normal",opacity:a?1:.5,textStyle:"caption-xs",children:a?ye(a,{approx:!0}):"Time: N/A"})}),e.jsxs(c,{gap:1,children:[e.jsxs(m,{textStyle:"caption-xs",children:[l.toSignificant(6)," ",(i==null?void 0:i.ticker)||""]}),e.jsxs(m,{color:"brand.green",fontWeight:"normal",textStyle:"caption-xs",children:["(+",h(k),")"]})]})]})})]})}),e.jsx(ce,{borderColor:n?void 0:"brand.alpha.btnPrimary",flex:1,onClick:()=>u(!1),px:2,py:1,sx:{cursor:"pointer"},variant:"filledTertiary",children:e.jsxs(c,{direction:"column",children:[e.jsxs(c,{align:"center",gap:1,justify:"space-between",children:[e.jsx(m,{textStyle:"caption-xs",children:s("views.swap.timeOptimized")}),e.jsx(z,{color:"secondaryBtn",name:"timer",size:22})]}),e.jsx(c,{gap:1,children:e.jsxs(c,{direction:"column",mt:.5,children:[e.jsxs(c,{gap:1,children:[e.jsx(m,{fontWeight:"normal",opacity:f?1:.5,textStyle:"caption-xs",children:f?ye(f,{approx:!0}):"Time: N/A"}),!!j&&e.jsxs(m,{color:"brand.green",fontWeight:"normal",textStyle:"caption-xs",children:["(",ye(j,{approx:!0})," faster)"]})]}),e.jsxs(m,{textStyle:"caption-xs",children:[S.toSignificant(6)," ",(i==null?void 0:i.ticker)||""]})]})})]})})]})]})})},$e=6e3;function Be(){var r;const{data:n}=Ut(),u=(r=n==null?void 0:n[0])==null?void 0:r.thorchain,o=t.useCallback(p=>(p-(u||0))*$e,[u]),i=t.useCallback(p=>p*$e,[]);return{getBlockTimeDifference:o,estimateTimeFromBlocks:i}}const yt=t.memo(({asset:n,logoURI:u,select:o,extraInfo:i,isSelected:r,balance:p,filled:g})=>{const f=Number(g)>=100,a=i?(100/Number(i)*100).toFixed(2):"-";return e.jsx(A,{alignCenter:!0,className:pe("dark:bg-dark-dark-gray bg-btn-light-tint z-0 lig rounded-3xl p-2 hover:duration-150 transition dark:hover:bg-dark-border-primary hover:bg-btn-light-tint-active border border-transparent",{"brightness-90 dark:brightness-110 dark:!bg-dark-border-primary !bg-btn-light-tint-active border-btn-primary":r},f?"cursor-not-allowed":"cursor-pointer"),onClick:()=>{!f&&o(n)},children:e.jsxs(A,{className:"gap-x-3 pl-2",flex:1,children:[e.jsx(A,{center:!0,className:"gap-x-2",children:e.jsx(te,{asset:n,logoURI:u,size:34})}),e.jsxs(A,{col:!0,flex:1,children:[e.jsx(A,{alignCenter:!0,justify:"between",children:e.jsx(m,{fontWeight:"medium",textStyle:"body",children:n==null?void 0:n.ticker})}),e.jsx(A,{row:!0,className:"gap-x-2 justify-between pr-2",children:e.jsx(ee,{content:a?s("views.lending.crRatio",{cr:a}):"",children:e.jsxs(A,{center:!0,className:"gap-1",children:[e.jsx(m,{fontWeight:"light",textStyle:"caption",textTransform:"uppercase",variant:"secondary",children:"LTV"}),e.jsx(m,{textStyle:"caption",variant:"primaryBtn",children:i?`${i}%`:"N/A"}),e.jsx(z,{color:"secondary",name:"infoCircle",size:14})]})})})]}),e.jsx(A,{center:!0,className:"gap-2",children:!!p&&e.jsx(m,{fontWeight:"medium",textStyle:"caption-xs",variant:"secondary",children:p.toSignificant(6)})}),f&&e.jsx(A,{center:!0,children:e.jsx(m,{color:"brand.red",textStyle:"caption-xs",children:s("views.lending.capReached")})}),typeof g<"u"&&e.jsx(ee,{content:`${s("common.filled")}: ${js(g)||"N/A"}`,children:e.jsxs(c,{position:"relative",children:[e.jsx(Vt,{color:f?"brand.red":"brand.btnPrimary",size:"35px",trackColor:"borderPrimary",value:g}),e.jsx(c,{alignItems:"center",bottom:0,justifyContent:"center",left:0,position:"absolute",right:0,top:0,children:e.jsxs(m,{className:pe("text-[10px]",{"text-[9px]":g>=100}),fontWeight:"semibold",textStyle:"caption-xs",variant:"secondary",children:[Math.floor(g),"%"]})})]})})]})})}),jt=({assets:n,onSelect:u,onClose:o,isLoading:i,setQuery:r,selectedAsset:p})=>{const{filteredAssets:g,select:f}=ms({assets:n,onSelect:u,onClose:o}),a=t.useCallback(j=>{f(j),setTimeout(()=>r==null?void 0:r(""),500)},[f,r]);return e.jsxs(A,{col:!0,className:pe("rounded-box-lg justify-center items-start w-2/5 py-5 px-6",Ht.secondary),flex:1,children:[e.jsx(m,{fontWeight:"medium",mb:2,ml:2,textStyle:"caption",textTransform:"none",variant:"secondary",children:s("views.lending.selectCollateralAsset")}),g.length?e.jsx(A,{className:"!overflow-x-clip flex-col overflow-y-auto gap-1.5 w-full h-full",children:g.map(j=>t.createElement(yt,{...j,isSelected:p==null?void 0:p.eqAsset(j.asset),key:`${j.asset.symbol}${j.asset.type}`,select:a}))}):e.jsx(A,{justifyCenter:!0,className:"pt-4",flex:1,children:i?e.jsx(z,{spin:!0,name:"loader",size:24}):e.jsx(m,{children:s("components.assetSelect.noResultsFound")})})]})},G=1,wt="https://twitter.com/THORChain/status/1693423215580958884",vt=({isOpened:n,onClose:u,onConfirm:o,asset:i,amount:r,estimatedTime:p,expectedOutputAmount:g,collateralAmount:f,collateralAsset:a,networkFee:j,expectedDebtInfo:O,slippagePercent:N})=>{const[k,S]=t.useState(!1),l=N>G,h=t.useMemo(()=>{if(!p)return;const x=Math.floor(p/60),y=Math.floor(x/60),C=y>0?`${y}h `:"",b=x>0?`${x%60}m `:"",d=p%60>0?` ${p%60}s`:"";return`${C}${b}${d}`},[p]);return e.jsxs(ft,{buttonDisabled:l&&!k,inputAssets:[i],isOpened:n,onClose:u,onConfirm:()=>o((g==null?void 0:g.toSignificant(6))||"0"),children:[e.jsxs(A,{col:!0,className:"mb-5",children:[e.jsx(q,{label:e.jsxs(c,{align:"center",alignContent:"center",gap:1,children:[e.jsx(m,{color:"textSecondary",mr:1,textStyle:"caption",textTransform:"capitalize",children:s("views.views.lending.borrow")}),e.jsxs(c,{align:"center",gap:.5,children:[e.jsx(m,{textStyle:"caption",children:i.ticker}),e.jsx(te,{asset:i,size:22})]}),e.jsxs(c,{align:"center",gap:.5,children:[e.jsx(m,{fontWeight:"light",mx:1,children:"for"}),e.jsx(m,{textStyle:"caption",children:a.ticker}),e.jsx(te,{asset:a,size:22})]})]}),value:void 0}),e.jsx(q,{className:"min-h-[38px]",label:s("views.lending.collateral"),showBorder:!1,value:e.jsxs(c,{align:"center",gap:.5,children:[e.jsxs(m,{textStyle:"caption",children:[r.toSignificant(6)," ",a.ticker]}),e.jsx(te,{asset:a,size:22})]})}),e.jsx(q,{className:"min-h-[38px]",label:s("views.lending.collateralAfterSlippage"),value:e.jsxs(m,{textStyle:"caption",children:[f.toSignificant(6)," ",a.ticker]})}),e.jsx(q,{className:"min-h-[38px]",label:s("views.lending.borrow"),showBorder:!1,value:e.jsxs(c,{align:"center",gap:1,children:[e.jsx(m,{textStyle:"caption",children:g?`${g.toSignificant(6)} ${i.ticker}`:j!=null&&j.gte(r)?s("views.savings.notEnoughForOutboundFee"):e.jsx(z,{spin:!0,color:"primary",name:"loader",size:24})}),e.jsx(te,{asset:i,size:22})]})}),e.jsx(q,{className:"min-h-[36px]",label:s("views.lending.expectedDebt"),showBorder:!1,value:e.jsx(c,{align:"center",gap:1,children:e.jsx(m,{textStyle:"caption",children:O||e.jsx(z,{spin:!0,color:"primary",name:"loader",size:24})})})}),e.jsx(q,{className:"min-h-[36px]",label:s("common.slippage"),value:e.jsxs(m,{color:N>G?"brand.red":"textPrimary",textStyle:"caption",children:[N.toFixed(1),"%"]})}),e.jsx(q,{className:"min-h-[38px]",label:s("views.wallet.estimatedTime"),showBorder:!1,value:e.jsx(m,{textStyle:"caption",children:h||"N/A"})}),e.jsx(je,{className:"mt-4",title:e.jsx(e.Fragment,{children:e.jsxs(m,{mx:2,children:[s("views.lending.experimentalDisclaimer")," ",e.jsx(_e,{className:"text-twitter-blue cursor-pointer",to:wt,children:e.jsxs(m,{fontWeight:"medium",noOfLines:1,variant:"blue",children:[s("views.lending.riskDisclaimer")," \u2192"]})})]})}),type:"warn"})]}),l&&e.jsx(nt,{className:"pt-4 pb-2",label:e.jsx(A,{alignCenter:!0,children:e.jsx(m,{children:s("views.swap.slippageConfirmationWarning")})}),onValueChange:S,value:k})]})},St=({depth:n,totalFeeUsd:u,slippagePercent:o})=>{const i=Ct(Number(n),o);return e.jsx(ee,{content:i.tooltip,children:e.jsxs(c,{alignItems:"center",gap:2,children:[e.jsx(m,{color:i.color,textStyle:"caption",children:(u==null?void 0:u.toCurrency())||"0"}),e.jsx(z,{color:"secondary",name:"infoCircle",size:20})]})})};function Ct(n,u){return n?n>85&&u<G?{color:"brand.green",tooltip:s("views.lending.slippage.low")}:n>70&&u<G?{color:"brand.yellow",tooltip:s("views.lending.slippage.medium")}:{color:"brand.red",tooltip:s("views.lending.slippage.high")}:{color:"",tooltip:""}}function At(){const{data:n}=Qt(),{getMaxBalance:u,isWalletConnected:o}=Le(),[i,r]=t.useState([]);return t.useEffect(()=>{n&&Promise.all(n.map(async p=>{const g=se.from({asset:p.asset});return{...p,asset:g,derivedDepthPercentage:Number(p.derivedDepthPercentage),balance:o(g.chain)?await u(g):void 0,extraInfo:p.ltvPercentage&&p.ltvPercentage!=="NaN"&&p.ltvPercentage!=="Infinity"?p.ltvPercentage:void 0,filled:p.filledPercentage?Number(p.filledPercentage):void 0,lendingAvailable:p.lendingAvailable,ltvPercentage:Number.isNaN(Number(p.ltvPercentage))||p.ltvPercentage==="Infinity"?"":p.ltvPercentage}})).then(p=>r(p.filter(g=>g.lendingAvailable)))},[n,u,o]),i}const Nt=()=>{const{getWalletAddress:n,isWalletLoading:u}=ae(),[o,i]=t.useState(null),[r]=qt(),[p,g]=t.useState(!1),f=t.useMemo(()=>(o==null?void 0:o.map(l=>l.asset))||[],[o]),{isLoading:a,data:j}=ze(f),O=t.useMemo(()=>a?new T(0):o==null?void 0:o.reduce((l,{asset:h,collateralCurrent:x})=>{var b;const y=((b=j[h.toString()])==null?void 0:b.price_usd)||0,C=Number(x.toFixed(2))||0;return l.add(new T(y).mul(C))},new T(0)),[o,j,a]),N=t.useCallback(async l=>{const h=n(l.chain);if(h){const{data:x}=await r({asset:`${l.chain}.${l.ticker}`,address:h}),y=se.fromStringSync(l.toString(),(x==null?void 0:x.collateralDeposited)||"0"),C=se.fromStringSync(l.toString(),(x==null?void 0:x.collateralWithdrawn)||"0"),b=se.fromStringSync(l.toString(),(x==null?void 0:x.collateralCurrent)||"0"),d=new T({value:(x==null?void 0:x.debtIssued)||"0",decimal:8}),D=new T({value:(x==null?void 0:x.debtRepaid)||"0",decimal:8}),E=new T({value:(x==null?void 0:x.debtCurrent)||"0",decimal:8});return Number.parseFloat((x==null?void 0:x.debtCurrent)||"0")?{asset:l,collateralCurrent:b,collateralDeposited:y,collateralWithdrawn:C,debtCurrent:E,debtIssued:d,debtRepaid:D,lastOpenHeight:(x==null?void 0:x.lastOpenHeight)||0,ltvPercentage:x==null?void 0:x.ltvPercentage}:null}return null},[r,n]),k=t.useCallback(async()=>{if(u)return;g(!0);const l=Gt.map(N),h=(await Promise.allSettled(l)).reduce((x,y)=>"value"in y&&y.value!==null?[...x,y.value]:x,[]);i(h),g(!1)},[N,u]),S=o==null?void 0:o.reduce((l,h)=>l.add(h.debtCurrent),T.fromBigInt(0n,8));return{refreshLoans:k,loans:o,totalCollateral:O,totalBorrowed:S,loansData:o||[],isLoading:p}},Ot=t.memo(({loading:n,label:u,disabled:o,handleSubmit:i,address:r,setIsConnectModalOpen:p,hasError:g})=>e.jsx(A,{className:"self-stretch pt-5",children:r?e.jsx(A,{className:"w-full",children:e.jsx(Z,{stretch:!0,disabled:o,error:g,loading:n,onClick:i,size:"lg",variant:"fancy",children:u})}):e.jsx(Z,{stretch:!0,loading:n,onClick:()=>p(!0),size:"lg",variant:"fancy",children:s("common.connectWallet")})})),kt=({header:n,value:u,tooltipText:o})=>e.jsxs(ce,{flex:1,gap:4,height:"full",px:4,variant:"filledContainerSecondary",children:[e.jsxs(c,{justify:"space-between",w:"full",children:[e.jsx(m,{textStyle:"subtitle1",children:n}),o&&e.jsx(ee,{content:o,place:"bottom",children:e.jsx(z,{color:"primaryBtn",name:"infoCircle",size:24})})]}),e.jsx(m,{textStyle:"h2",children:u})]}),Mt="https://twitter.com/THORChain/status/1693423215580958884",Dt=({isOpened:n,onClose:u,onConfirm:o,asset:i,amount:r,tabLabel:p,estimatedTime:g,expectedOutputAmount:f,expectedOutputMaxSlippage:a,collateralAmount:j,collateralAsset:O,networkFee:N,expectedDebtInfo:k,slippagePercent:S,inputAmount:l})=>{const[h,x]=t.useState(!1),y=S>G,C=t.useMemo(()=>{if(!g)return;const w=Math.floor(g/60),_=Math.floor(w/60),P=_>0?`${_}h `:"",F=w>0?`${w%60}m `:"",v=g%60>0?` ${g%60}s`:"";return`${P}${F}${v}`},[g]),b=t.useMemo(()=>[{label:s("common.action"),value:p},{label:s("common.asset"),value:`${i.ticker}`,icon:i}],[i,p]),d=t.useMemo(()=>[{label:s("views.wallet.estimatedTime"),value:C||"N/A"},{label:s("views.lending.sendAmount"),value:f?`${f.toSignificant(6)} ${i.ticker}`:N!=null&&N.gte(r)?s("views.savings.notEnoughForOutboundFee"):e.jsx(z,{spin:!0,color:"primary",name:"loader",size:24})},{label:s("views.lending.repayDebt"),value:`${l==null?void 0:l.toSignificant(6)} ${i.ticker}`||"N/A"},{label:s("common.slippage"),value:e.jsxs(m,{color:S>G?"brand.red":"textPrimary",textStyle:"caption",children:[S.toFixed(1),"%"]})}],[r,i.ticker,f,l,N,S,C]),D=t.useMemo(()=>[{label:s("views.lending.collateral"),value:`${O==null?void 0:O.ticker}`,icon:O},{label:s("views.wallet.estimatedTime"),value:C||"N/A"},{label:p,value:f?`${f.toSignificant(6)} ${i.ticker}`:N!=null&&N.gte(r)?s("views.savings.notEnoughForOutboundFee"):e.jsx(z,{spin:!0,color:"primary",name:"loader",size:24})},{label:s("common.minReceived"),value:a?`${a==null?void 0:a.toSignificant(6)} ${i.ticker}`:e.jsx(z,{spin:!0,color:"primary",name:"loader",size:24})},{label:s("views.lending.collateralValue"),value:j&&O?`${j.toSignificant(6)} ${O.ticker}`:e.jsx(z,{spin:!0,color:"primary",name:"loader",size:24})},{label:s("views.lending.expectedDebt"),value:k||e.jsx(z,{spin:!0,color:"primary",name:"loader",size:24})}],[r,i,j,O,k,f,a,N,p,C]),E=t.useMemo(()=>k?b.concat(D):b.concat(d),[D,k,d,b]);return e.jsx(ft,{buttonDisabled:y&&!h,inputAssets:[i],isOpened:n,onClose:u,onConfirm:()=>o((f==null?void 0:f.toSignificant(6))||"0"),children:e.jsxs(A,{col:!0,className:"mb-5",children:[E.map(({label:w,value:_,icon:P})=>e.jsx(q,{label:w,value:e.jsxs(A,{center:!0,className:"gap-1",children:[e.jsx(m,{textStyle:"caption",children:_}),P&&e.jsx(te,{asset:P,size:22})]})},w)),e.jsx(je,{className:"mt-4",title:e.jsx(e.Fragment,{children:e.jsxs(m,{mx:2,children:[s("views.lending.experimentalDisclaimer")," ",e.jsx(_e,{className:"text-twitter-blue cursor-pointer",to:Mt,children:e.jsxs(m,{fontWeight:"medium",noOfLines:1,variant:"blue",children:[s("views.lending.riskDisclaimer")," \u2192"]})})]})}),type:"warn"}),y&&e.jsx(nt,{className:"pt-4 pb-2",label:e.jsx(A,{alignCenter:!0,children:e.jsx(m,{children:s("views.swap.slippageConfirmationWarning")})}),onValueChange:x,value:h})]})})};function ve({children:n}){return e.jsx(c,{align:"start",direction:"column",flex:1,gap:2,justify:"center",children:n})}function Tt({repayAsset:n,collateralAsset:u,amount:o,onSuccess:i,repayQuote:r,stream:p}){const[g,f]=t.useState(!1),a=it(),{getWalletAddress:j}=ae(),O=t.useMemo(()=>j(u.chain),[j,u.chain]),N=t.useCallback(async l=>{var y;const{thorchain:h}=await(await lt(()=>import("./CRWIkueS.js"),__vite__mapDeps([0,1,2]))).getSwapKitClient();if(!h)throw new Error("SwapKit client not found");f(!1);const x=rt();a(ot({id:x,label:s("txManager.closeLoan",{asset:n.ticker,amount:l}),type:we.TC_LENDING_CLOSE,inChain:n.chain}));try{const C=await h.loan({type:"close",memo:p?(y=r==null?void 0:r.streamingSwap)==null?void 0:y.memo:r==null?void 0:r.memo,assetValue:n.add(o),minAmount:n.set(l)});i==null||i(),C&&a(ct({id:x,txid:C,timestamp:new Date,advancedTracker:!0,initialPayload:r?{isLending:!0,...r,fromAddress:O}:void 0,type:we.TC_LENDING_CLOSE}))}catch(C){dt(C),Ie(s("txManager.failed"),void 0,void 0,C),a(mt({id:x,status:"error"}))}},[a,n,p,r,o,i,O]),k=t.useCallback(()=>{f(!0)},[]),S=t.useCallback(()=>{f(!1)},[]);return{handleRepay:N,isConfirmOpen:g,openRepayConfirm:k,closeRepayConfirm:S}}const We=n=>{const[u,o]=t.useState(!1),i=t.useMemo(()=>!!n,[n]),r=t.useCallback(p=>o(p&&!!i),[i]);return t.useEffect(()=>{r(i)},[i,r]),{toggleStream:r,stream:u,canStream:i}},Pt=({asset:n,collateralAsset:u,percentage:o})=>{var b,d,D,E;const{getWalletAddress:i}=ae(),[r,p]=t.useState(new T({value:0,decimal:8})),g=t.useMemo(()=>i(u.chain),[i,u.chain]),f=t.useMemo(()=>i(n.chain),[i,n.chain]),{data:a,isFetching:j,error:O}=Kt({senderAddress:f,collateralAddress:g,amountPercentage:o.toFixed(),collateralAsset:u.toString(),repayAsset:n.toString()},{skip:!o.toFixed()}),{canStream:N,toggleStream:k,stream:S}=We((b=a==null?void 0:a.streamingSwap)==null?void 0:b.memo),l=t.useMemo(()=>S&&(a!=null&&a.streamingSwap)?a.streamingSwap:a,[a,S]);t.useEffect(()=>{(()=>{if(!l||O)return p(new T({value:0,decimal:8}));const w=new T({value:l.repayAssetAmount,decimal:n.decimal});p(w)})()},[n,l,O]);const h=t.useMemo(()=>{var w,_,P;return{estimatedTime:a==null?void 0:a.estimatedTime,expectedOutput:(a==null?void 0:a.repayAssetAmount)||"",expectedOutputUSD:(a==null?void 0:a.repayAssetAmount)||"",streamingSwap:{estimatedTime:(w=a==null?void 0:a.streamingSwap)==null?void 0:w.estimatedTime,expectedOutput:((_=a==null?void 0:a.streamingSwap)==null?void 0:_.repayAssetAmount)||"",expectedOutputUSD:((P=a==null?void 0:a.streamingSwap)==null?void 0:P.repayAssetAmountUSD)||""}}},[a==null?void 0:a.estimatedTime,a==null?void 0:a.repayAssetAmount,(d=a==null?void 0:a.streamingSwap)==null?void 0:d.estimatedTime,(D=a==null?void 0:a.streamingSwap)==null?void 0:D.repayAssetAmount,(E=a==null?void 0:a.streamingSwap)==null?void 0:E.repayAssetAmountUSD]),x=t.useMemo(()=>new T({value:(l==null?void 0:l.expectedDebtRepaid)||0,decimal:8}),[l]),y=t.useMemo(()=>{if(!l)return 0;const{expectedDebtRepaid:w,repayAssetAmountUSD:_}=l,P=Number(w);return(Number(_)-P)/P*100},[l]),C=t.useMemo(()=>{var P;const w=(P=l==null?void 0:l.fees.THOR)==null?void 0:P.find(F=>F.type==="outbound"),_=((w==null?void 0:w.totalFeeUSD)||0)-((w==null?void 0:w.affiliateFeeUSD)||0);return new T({value:_,decimal:8})},[l==null?void 0:l.fees.THOR]);return{isLoading:j,repayAssetAmount:r,repayQuote:a,canStream:N,stream:S,toggleStream:k,repayOptimizeQuoteDetails:h,repaySlippage:y,repayDebtAmount:x,totalFeeUsd:C}},_t=({loan:{collateralCurrent:n,debtCurrent:u,asset:o,lastOpenHeight:i},setBorrowTab:r,setCollateralAsset:p})=>{var fe;const[g,f]=t.useState(!1),[a,j]=t.useState(!1),[O,N]=t.useState(new T({decimal:2,value:0})),[k,S]=t.useState(),[l,h]=t.useState(se.from({asset:"ETH.USDC-0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"})),{getBlockTimeDifference:x}=Be(),{getMaxBalance:y}=Le(),{setIsConnectModalOpen:C}=Fe(),{getWalletAddress:b}=ae(),d=zs({includeRune:!0}),{data:D}=ze([o,l]),E=t.useCallback($=>{$.stopPropagation(),f(W=>!W)},[]),w=Re(O,500),_=x(i+Ce),P=t.useMemo(()=>b(l.chain),[b,l.chain]),F=_<=0,{repayAssetAmount:v,isLoading:ne,repayQuote:B,stream:ie,canStream:le,toggleStream:re,repayOptimizeQuoteDetails:I,repaySlippage:L,repayDebtAmount:U,totalFeeUsd:de}=Pt({asset:l,collateralAsset:o,percentage:w,totalAmount:u,hasLoanMatured:F}),{isApproved:oe,isLoading:me}=Fs({assetValue:l.set(v.getValue("string")),force:!0}),Ne=ws({asset:l}),Oe=t.useMemo(()=>{var W;const $=((W=D[o.toString()])==null?void 0:W.price_usd)||0;return n.mul($).toCurrency("$")},[o,n,D]),xe=t.useMemo(()=>l.toString(),[l]),ge=t.useMemo(()=>{var W;const $=((W=D[xe])==null?void 0:W.price_usd)||0;return v.mul($).getValue("number")},[v,xe,D]);t.useEffect(()=>{P?y(l).then($=>S($)):S(void 0)},[P,l,y]);const K=t.useMemo(()=>({asset:l,value:v,balance:k,usdPrice:ge}),[l,v,k,ge]),he=t.useMemo(()=>!(!F||v.lte(0)||k!=null&&k.lt(v)),[v,k,F]),V=t.useCallback(()=>{N(new T({decimal:2,value:0}))},[]),{openRepayConfirm:J,handleRepay:H,isConfirmOpen:Q,closeRepayConfirm:ke}=Tt({repayAsset:l,collateralAsset:o,amount:v,onSuccess:V,repayQuote:B,stream:ie});t.useEffect(()=>{!F&&w.gt(0)&&Ie(s("views.lending.maturityError"))},[w,F]);const R=ye(_,{approx:!0});return e.jsxs(c,{alignSelf:"stretch",direction:"column",justify:"center",w:"full",children:[e.jsxs(ce,{className:"!rounded-3xl flex-col flex !gap-0 !px-3 !py-3",variant:"filledContainerSecondary",children:[e.jsxs(c,{direction:{base:"column",lg:"row"},flex:4,gap:2,children:[e.jsxs(c,{flex:5,children:[e.jsx(ve,{children:e.jsxs(c,{gap:1,children:[e.jsx(c,{align:"center",children:e.jsx(te,{asset:o,size:36})}),e.jsxs(c,{direction:"column",children:[e.jsx(m,{children:`${n.toSignificant(4)} ${o.symbol}`}),e.jsx(m,{children:Oe})]})]})}),e.jsx(ve,{children:e.jsx(m,{textAlign:"end",children:`$${u.toFixed(2)}`})}),e.jsx(ve,{children:e.jsx(m,{variant:F?"green":"primary",children:F?s("views.lending.repayAvailable"):R})})]}),e.jsxs(c,{align:"center",direction:"row",flex:{md:2,lg:3,xl:3},gap:2,justify:"end",mt:{base:2,md:0},pl:{md:4,lg:8},children:[e.jsx(Z,{flex:1,onClick:$=>{$.stopPropagation(),r(),p(o)},variant:"outlinePrimary",children:s("views.lending.borrow")}),e.jsx(Z,{flex:1,onClick:E,rightIcon:e.jsx(z,{className:pe({"-rotate-180":g}),name:"chevronDown",size:14}),variant:"outlineSecondary",children:s("views.lending.repay")})]})]}),e.jsx(at,{in:g,children:e.jsx(c,{align:"center",flex:1,justify:"center",w:"full",children:e.jsx(ce,{bg:"borderPrimary",borderRadius:"3xl",mt:{base:2,md:4},variant:"filledContainerPrimary",w:"full",children:e.jsxs(c,{align:"center",direction:"column",display:"flex",flex:1,justify:"center",children:[e.jsxs(c,{alignSelf:"stretch",direction:{base:"column",lg:"row"},flex:1,gap:{base:4,lg:8},children:[e.jsxs(c,{direction:"column",flex:1,children:[e.jsxs(c,{alignItems:"center",justifyContent:"space-between",children:[e.jsxs(m,{textStyle:"caption",children:[s("views.lending.repayAsset"),":"]}),e.jsx(ps,{showAssetType:!0,assets:d,onSelect:h,selected:K.asset})]}),e.jsx(_s,{highlightDisabled:!0,className:"!p-0",onChange:N,percent:O,slideClassName:"!pb-0",title:s("views.lending.repayPercent")}),e.jsx(Ee,{canStream:le,outputAsset:K.asset,quote:I,stream:ie,title:s("views.lending.txOptimizeTitle"),toggleStream:re})]}),e.jsxs(c,{direction:"column",flex:1,children:[e.jsx(c,{alignItems:"center",minH:"40px",children:e.jsxs(m,{textStyle:"caption",children:[s("views.lending.repayAmount"),":"]})}),e.jsxs(c,{children:[e.jsx(c,{flex:1,justifyContent:"space-between",children:ne?e.jsx(c,{alignItems:"center",minH:"44px",children:e.jsx(z,{spin:!0,color:"primary",name:"loader",size:22})}):e.jsx(Ps,{disabled:!0,amountValue:v,className:"!text-2xl  pt-[1.5px] md:!w-full"})}),e.jsx(us,{showAssetType:!0,className:"cursor-default p-2",selected:K.asset})]}),e.jsx(c,{mt:3,children:e.jsxs(c,{flex:1,justifyContent:"space-between",children:[ne?e.jsx(c,{alignItems:"center",minH:"21px",children:e.jsx(z,{spin:!0,color:"secondary",name:"loader",size:16})}):e.jsx(m,{variant:"secondary",children:K.usdPrice.toFixed(2)}),e.jsx(c,{mr:4,children:e.jsxs(m,{variant:"secondary",children:[s("common.balance"),":"," ",((fe=K.balance)==null?void 0:fe.toSignificant(6))||"0"]})})]})}),!!B&&e.jsxs(c,{direction:"column",children:[e.jsx(c,{className:"border-0 border-t border-solid border-bottom border-light-typo-gray dark:border-dark-typo-gray !border-opacity-20 mt-3 mb-1"}),e.jsx(q,{label:"Repay Slippage",showBorder:!1,size:"sm",value:de.toCurrency()})]}),L>G&&e.jsx(c,{mt:3,children:e.jsx(je,{title:e.jsx(m,{color:"brand.yellow",mx:2,textStyle:"caption",children:s("views.lending.slippageRepayWarning")}),type:"warn"})})]})]}),v.getValue("number")>0&&(!oe||me)?e.jsx(Z,{stretch:!0,disabled:me,loading:me,mt:6,onClick:()=>j(!0),size:"md",variant:"fancy",children:s("common.approve")}):e.jsx(Z,{stretch:!0,disabled:!he,error:!he,mt:6,onClick:$=>{if($.stopPropagation(),!P){C(!0);return}J()},size:"md",variant:"fancy",children:P?s("views.lending.repay"):s("common.connectWallet")})]})})})})]}),e.jsx(Is,{handleApprove:Ne,inputAsset:l,setVisible:j,visible:a}),e.jsx(Dt,{amount:v,asset:l,expectedOutputAmount:v,inputAmount:U,isOpened:Q,onClose:ke,onConfirm:H,slippagePercent:L,tabLabel:s("views.lending.repay")})]},`${o.symbol} + ${o.symbol}`)};var ue=(n=>(n.Borrow="borrow",n.Repay="repay",n))(ue||{}),Se=(n=>(n[n.Borrow=0]="Borrow",n[n.Positions=1]="Positions",n))(Se||{});let Ue,Ve,He,Qe,Ce,Ae,qe,Ge;Ue=({setTab:n,setViewTab:u,setCollateralAsset:o,refreshLoans:i,totalBorrowed:r,totalCollateral:p,loans:g,isLoading:f})=>{const a=xt(),{setIsConnectModalOpen:j}=Fe(),{hasWallet:O}=ae(),N=()=>{n(ue.Borrow),u(Se.Borrow)},k=t.useMemo(()=>[{header:s("views.lending.totalCollateralValue"),value:p!=null&&p.gt(0)?a(p.toFixed(2)):"-",tooltipText:"Fair market value of the assets used to secure a loan"},{header:s("views.lending.totalDebtValue"),value:r!=null&&r.gt(0)?a(r):"-",tooltipText:"Value of borrowed assets"}],[a,r,p]);return t.useEffect(()=>{i()},[i]),e.jsx(Yt,{alignSelf:"stretch",w:"full",children:O?e.jsxs(c,{direction:"column",gap:3,mt:6,children:[e.jsx(c,{flex:2,justifyContent:"space-between",w:"full",children:e.jsxs(c,{alignItems:"center",flex:1,justifyContent:"space-between",children:[e.jsx(m,{ml:3,mr:2,textStyle:"h3",children:s("views.lending.myLoans")}),e.jsx(Ts,{loading:f,onLoad:i,size:16})]})}),e.jsx(c,{direction:{base:"column",md:"row"},flex:2,gap:8,justifyContent:"space-between",mt:4,w:"full",children:k.map(S=>e.jsx(kt,{header:S.header,tooltipText:S.tooltipText,value:S.value},S.header))}),e.jsxs(c,{direction:"column",gap:2,justify:"center",mt:6,children:[!!g.length&&e.jsx(c,{direction:"row",px:"12px",children:e.jsxs(c,{direction:"row",flex:1,gap:2,children:[e.jsxs(c,{flex:5,children:[e.jsx(c,{flex:1,children:e.jsx(m,{color:"secondary",ml:3,textStyle:"caption",children:s("views.lending.collateral")})}),e.jsx(c,{flex:1,children:e.jsx(m,{color:"secondary",textStyle:"caption",children:s("views.lending.debt")})}),e.jsx(c,{flex:1,children:e.jsx(ee,{content:s("views.lending.unlockDescription"),children:e.jsxs(c,{align:"center",flex:1,gap:1,children:[e.jsx(m,{color:"secondary",textStyle:"caption",children:s("views.lending.unlock")}),e.jsx(z,{color:"secondary",name:"infoCircle",size:14})]})})})]}),e.jsx(c,{display:{lg:"flex",base:"none"},flex:3,pl:"32px",children:e.jsx(m,{color:"secondary",textStyle:"caption",children:s("views.lending.actions")})})]})}),g.length?g.map(S=>e.jsx(_t,{loan:S,setBorrowTab:N,setCollateralAsset:o},S.asset.ticker)):e.jsx(c,{justify:"center",w:"full",children:f?e.jsx(z,{spin:!0,name:"loader",size:32}):e.jsx(m,{children:"No open loans to display"})})]})]}):e.jsx(c,{alignItems:"center",alignSelf:"stretch",justifyContent:"center",w:"full",children:e.jsx(Z,{stretch:!0,alignSelf:"center",maxW:"460px",mt:3,onClick:()=>j(!0),size:"lg",variant:"fancy",children:s("common.connectWallet")})})})},Ve=({recipientAddress:n,senderAddress:u,assetIn:o,assetOut:i,amount:r,slippage:p,estimatedLoanSizeUsd:g})=>{var le,re;const f=r.gte(0)?r.toSignificant(8):"0",a=Re(f),j=Re(p),{getWalletAddress:O}=ae(),N=t.useMemo(()=>O(Zt.Ethereum),[O]),k=ks(N),S=t.useMemo(()=>He({VTHORBalance:k,loanSizeUsd:g}),[k,g]),{currentData:l,error:h,isFetching:x}=Jt({affiliateBasisPoints:S,assetIn:o.toString(),assetOut:i.toString(),amount:a,slippage:j.toString(),senderAddress:u,recipientAddress:n},{skip:r.lte(0),refetchOnMountOrArgChange:!0}),{canStream:y,toggleStream:C,stream:b}=We(((le=l==null?void 0:l.streamingSwap)==null?void 0:le.memo)||((re=l==null?void 0:l.calldata)==null?void 0:re.memo)),d=t.useMemo(()=>b&&(l!=null&&l.streamingSwap)?l.streamingSwap:l,[l,b]),D=t.useMemo(()=>new T({value:(d==null?void 0:d.expectedOutput)||0,decimal:i.decimal}),[i.decimal,d==null?void 0:d.expectedOutput]),E=t.useMemo(()=>se.fromStringSync(i.toString(),d==null?void 0:d.expectedOutput),[i,d==null?void 0:d.expectedOutput]),w=t.useMemo(()=>new T({value:(d==null?void 0:d.expectedOutputMaxSlippage)||0,decimal:i.decimal}),[i.decimal,d==null?void 0:d.expectedOutputMaxSlippage]),_=t.useMemo(()=>new T({value:(d==null?void 0:d.expectedDebtIssued)||0,decimal:8}),[d==null?void 0:d.expectedDebtIssued]),P=t.useMemo(()=>D.sub(w),[D,w]),F=t.useMemo(()=>new T({value:(d==null?void 0:d.expectedOutputUSD)||0,decimal:8}).sub(new T({value:(d==null?void 0:d.expectedOutputMaxSlippageUSD)||0,decimal:8})),[d==null?void 0:d.expectedOutputMaxSlippageUSD,d==null?void 0:d.expectedOutputUSD]),v=t.useMemo(()=>new T({value:(d==null?void 0:d.expectedCollateralDeposited)||0,decimal:o.decimal}),[o.decimal,d==null?void 0:d.expectedCollateralDeposited]),ne=t.useMemo(()=>{var U;const I=(U=d==null?void 0:d.fees.THOR)==null?void 0:U.find(de=>de.type==="outbound"),L=((I==null?void 0:I.totalFeeUSD)||0)-((I==null?void 0:I.affiliateFeeUSD)||0);return new T({value:L,decimal:8})},[d==null?void 0:d.fees.THOR]),B=t.useMemo(()=>{var L;const I=(L=d==null?void 0:d.fees.THOR)==null?void 0:L.find(U=>U.type==="outbound");return new T({value:(I==null?void 0:I.affiliateFeeUSD)||0,decimal:8})},[d==null?void 0:d.fees.THOR]);t.useEffect(()=>{C(!!o.toString()&&!!(l!=null&&l.streamingSwap))},[o,l==null?void 0:l.streamingSwap,C]);const ie=t.useMemo(()=>{if(!l)return 0;const I=_.getValue("number"),L=D.getValue("number");return(I-L-B.getValue("number"))/L*100},[l,B,_,D]);return{collateralAmount:v,expectedDebt:_,expectedOutput:D,expectedOutputMaxSlippage:w,hasError:!!h,borrowQuote:l,slippageAmount:P,slippageAmountUsd:F,totalFeeUsd:ne,isFetching:x,toggleStream:C,stream:b,canStream:y,expectedOutputAssetValue:E,borrowSlippage:ie,exchangeFeeUsd:B}},He=({VTHORBalance:n,loanSizeUsd:u})=>{if(u<100||n.gte(5e5))return"0";let o=100;return u>25e3&&(o-=20),u>1e5&&(o-=30),u>25e4&&(o-=40),u>5e5&&(o-=50),n.gte(1e3)&&(o-=20),n.gte(1e4)&&(o-=30),n.gte(1e5)&&(o-=40),`${Math.floor(o)}`},Qe="https://docs.thorchain.org/thorchain-finance/lending",Ce=432e3,Ae=!1,qe=[{value:1,text:"1%"},{value:3,text:"3%"},{value:5,text:"5%"},{value:10,text:"10%"}],Ge=()=>{const n=it(),u=At(),{getMaxBalance:o}=Le(),{isChainHalted:i}=pt(),{setIsConnectModalOpen:r}=Fe(),{getWalletAddress:p}=ae(),{customRecipientMode:g,setCustomRecipientMode:f}=Xt(),{isLendingPaused:a}=pt(),{tokens:j}=xs(),O=Ds(j,!0),{assetInputProps:N,assets:k}=bs(O,{thorchainPriority:!0}),[S,l]=t.useState(10),{asset:h,setAsset:x,amount:y,setAmount:C}=vs(es.Lending,cs),[b,d]=t.useState(se.from({asset:"ETH.USDC-0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"})),[D,E]=t.useState(""),[w,_]=t.useState(),[P,F]=t.useState(),v=t.useMemo(()=>u.find(M=>M.asset.eqAsset(h)),[h,u]),[ne,B]=t.useState(!1),[ie,le]=t.useState(ue.Borrow),[re,I]=t.useState(Se.Borrow),{data:L}=ze([h,b]),[U,de]=t.useState(!0),oe=t.useMemo(()=>{var M;return(((M=L[h.toString()])==null?void 0:M.price_usd)||0)*y.getValue("number")},[y,h,L]),{refreshLoans:me,totalBorrowed:Ne,totalCollateral:Oe,loansData:xe,isLoading:ge}=Nt(),{estimateTimeFromBlocks:K}=Be(),he=t.useMemo(()=>Number(v==null?void 0:v.ltvPercentage)*oe/100,[v==null?void 0:v.ltvPercentage,oe]),V=t.useMemo(()=>p(h.chain),[p,h.chain]),J=t.useMemo(()=>p(b.chain),[p,b.chain]);t.useEffect(()=>{E(J||"")},[J]);const{expectedDebt:H,expectedOutput:Q,hasError:ke,borrowQuote:R,collateralAmount:fe,isFetching:$,totalFeeUsd:W,stream:Me,canStream:zt,toggleStream:It,expectedOutputAssetValue:Ke,borrowSlippage:be,exchangeFeeUsd:De}=Ve({slippage:S,senderAddress:V,recipientAddress:D,amount:y,assetIn:h,assetOut:b,estimatedLoanSizeUsd:he}),Ye=t.useMemo(()=>{var M;return(((M=L[b.toString()])==null?void 0:M.price_usd)||0)*Number(Q.toFixed(2))||0},[b,Q,L]);t.useEffect(()=>{V?o(h).then(M=>_(M)):_(void 0)},[V,h,o]),t.useEffect(()=>{J?o(b).then(M=>F(M)):F(void 0)},[J,b,o]);const Te=t.useMemo(()=>H!=null&&H.gt(0)?H==null?void 0:H.toCurrency():"-",[H]),Ze=t.useCallback(async()=>{var tt,st;const{thorchain:M,validateAddress:X}=await(await lt(()=>import("./CRWIkueS.js"),__vite__mapDeps([0,1,2]))).getSwapKitClient();if(!M)throw new Error("SwapKit client not found");const Y=X({chain:b.chain,address:D});if(typeof Y=="boolean"&&!Y)throw new Error("Invalid recipient address");if(!R)throw new Error("Invalid lending quote");return M.loan({type:"open",assetValue:h.add(y),minAmount:b.add(Q),memo:Me?((tt=R.streamingSwap)==null?void 0:tt.memo)||((st=R.calldata)==null?void 0:st.memoStreamingSwap):R.memo})},[y,b,R,h,Q,D,Me]),Ft=t.useCallback(async M=>{B(!1);const X=rt();n(ot({id:X,label:s("txManager.openLoan",{asset:h.ticker,amount:M}),type:we.TC_LENDING_OPEN,inChain:h.chain}));try{const Y=await Ze();C(new T({value:0,decimal:h.decimal})),Y&&n(ct({id:X,txid:Y,timestamp:new Date,advancedTracker:!0,initialPayload:R?{isLending:!0,...R,fromAddress:V}:void 0,type:we.TC_LENDING}))}catch(Y){dt(Y),Ie(s("txManager.failed"),void 0,void 0,Y),n(mt({id:X,status:"error"}))}},[n,R,V,h.chain,h.decimal,h.ticker,Ze,C]),Rt=t.useMemo(()=>!(D&&U)||a||Ae||y.lte(0)||w&&y.gt(w)||i[h.chain],[D,a,y,h.chain,w,i,U]),Je=ie===ue.Borrow?s("common.borrow"):s("common.repay"),Xe=t.useMemo(()=>({asset:h,value:y,balance:w,usdPrice:oe}),[h,y,w,oe]),et=t.useMemo(()=>({asset:Ke||b,value:Q,balance:P,usdPrice:Ye}),[Ke,b,Q,P,Ye]),Lt=t.useMemo(()=>D?R?Je:s("views.swap.noValidQuote"):s("views.swap.connectOrFillRecipient"),[R,D,Je]),Pe=t.useMemo(()=>ts.duration(K(Ce)).asDays(),[K]),Et=t.useMemo(()=>[{label:s("views.lending.expectedDebt"),value:`${Te}`},{label:s("views.lending.borrowSlippage"),value:e.jsx(St,{depth:(v==null?void 0:v.derivedDepthPercentage)||0,slippagePercent:be,totalFeeUsd:W})},{label:s("views.lending.repayMaturity"),value:e.jsx(A,{center:!0,children:e.jsx(ss,{tooltip:s("views.lending.maturityDescription",{days:Pe}),value:e.jsxs(m,{textStyle:"caption",children:[Pe," ",s("views.savings.days")]})})})},{label:s("views.lending.exchangeFee"),value:De.gt(0)?e.jsx(m,{textStyle:"caption",children:De.toCurrency()}):e.jsx(m,{textStyle:"caption",variant:"green",children:"FREE"})}],[be,v==null?void 0:v.derivedDepthPercentage,Te,De,Pe,W]),$t=t.useCallback(M=>{C(M)},[C]);return e.jsxs(A,{col:!0,className:"w-full max-w-[880px] flex self-center gap-3 mt-2",children:[e.jsx(as,{content:"Deposit and borrow native assets with THORSwap LENDING",keywords:"Borrow, Lending, THORSwap, APY, Native assets",title:s("views.lending.borrow")}),(a||Ae)&&e.jsx(ns,{announcement:{type:is.Error,message:s("views.lending.lendingPaused")},showClose:!1}),e.jsxs(Ss,{index:re,onChange:I,children:[e.jsxs(Cs,{children:[e.jsx(gt,{children:s("views.lending.borrow")}),e.jsx(gt,{children:s("views.lending.myLoans")})]}),e.jsxs(As,{children:[e.jsx(ht,{children:e.jsxs(c,{direction:"column",gap:3,maxWidth:"480px",mx:"auto",children:[e.jsx(A,{className:"flex w-full justify-between",children:e.jsx(A,{alignCenter:!0,children:e.jsx(m,{className:"ml-3 mr-2",textStyle:"h3",children:s("views.lending.header",{asset:b.ticker})})})}),e.jsxs(c,{direction:"row",justify:"space-between",children:[e.jsxs(c,{alignItems:"center",direction:"row",flexWrap:"wrap",gap:1,px:3,children:[e.jsx(m,{fontWeight:"medium",noOfLines:1,textStyle:"body",variant:"primary",children:s("views.lending.liquidationDisclaimer",{asset:h.ticker,borrowAsset:b.ticker})}),e.jsx(_e,{className:"text-twitter-blue cursor-pointer",to:Qe,children:e.jsx(m,{fontWeight:"medium",noOfLines:1,textStyle:"caption",variant:"blue",children:`${s("common.learnMore")} \u2192`})})]}),e.jsxs(hs,{children:[e.jsx(A,{children:e.jsx(m,{textStyle:"caption",children:s("views.swap.transactionSettings")})}),e.jsx(A,{className:"space-x-2",children:e.jsx(m,{textStyle:"caption-xs",variant:"secondary",children:s("views.swap.slippageTolerance")})}),e.jsxs(A,{alignCenter:!0,className:"w-full space-x-2",children:[e.jsx(ls,{stretch:!0,border:"rounded",className:"text-right",containerClassName:"bg-light-gray-light dark:bg-dark-gray-light bg-opacity-40",onChange:M=>l(Number(M.target.value)),placeholder:s("common.percentage"),symbol:"%",type:"number",value:S}),qe.map(({value:M,text:X})=>e.jsx(Z,{onClick:()=>l(M),size:"sm",variant:S===M?"primary":"outlineTint",children:e.jsx(m,{textStyle:"caption-xs",children:X})},M))]}),e.jsxs(e.Fragment,{children:[e.jsx(A,{children:e.jsx(m,{textStyle:"caption",children:s("views.setting.transactionMode")})}),e.jsxs(A,{alignCenter:!0,justify:"between",children:[e.jsxs(A,{alignCenter:!0,className:"space-x-2",children:[e.jsx(m,{textStyle:"caption-xs",variant:"secondary",children:s("views.setting.customRecipientMode")}),e.jsx(ee,{content:s("common.customRecipientTooltip"),place:"top",children:e.jsx(z,{color:"secondary",name:"questionCircle",size:16})})]}),e.jsx(gs,{checked:g,onChange:()=>f(!g),selectedText:"ON",unselectedText:"OFF"})]})]})]})]}),e.jsx(A,{row:!0,className:"justify-center gap-5",children:e.jsxs(A,{col:!0,className:pe("flex h-full"),children:[e.jsx(rs,{className:"!rounded-2xl md:!rounded-3xl !p-4 flex-col items-center self-stretch mt-2 space-y-1 shadow-lg md:w-full md:h-auto max-w-[480px]",size:"lg",children:e.jsxs(c,{direction:"column",gap:2,children:[e.jsxs(c,{direction:"column",children:[e.jsx(c,{alignItems:"center",direction:"row",justifyContent:"space-between",mr:2,children:e.jsx(m,{mb:1,ml:5,textStyle:"caption",children:s("views.lending.collateral")})}),e.jsx(ut,{noFilters:!0,hideZeroPrice:!0,AssetListComponent:jt,assets:u,className:"flex-1 !py-1",displayAssetTypeComponent:e.jsxs(A,{center:!0,className:"gap-1",children:[e.jsx(m,{fontWeight:"light",textStyle:"caption",textTransform:"uppercase",variant:"secondary",children:"LTV"}),e.jsx(m,{textStyle:"caption",variant:"primaryBtn",children:v!=null&&v.ltvPercentage?`${v.ltvPercentage}%`:"N/A"})]}),onAssetChange:x,onValueChange:$t,poolAsset:Xe,selectedAsset:Xe})]}),e.jsxs(c,{direction:"column",mb:2,children:[e.jsx(m,{mb:1,ml:5,textStyle:"caption",children:s("views.lending.borrow")}),e.jsx(ut,{hideZeroPrice:!0,...N,disabled:!0,assets:k.filter(M=>os(M.asset)).filter(M=>M.asset.type!=="Synth"),className:"flex-1 !py-1",onAssetChange:d,poolAsset:et,selectedAsset:et}),!!V&&e.jsx(c,{alignContent:"stretch",flex:1,mt:1,children:e.jsx(Ms,{isOutputWalletConnected:!!J,outputAssetChain:b.chain,recipient:D,setIsValidRecipient:de,setRecipient:E})})]}),e.jsx(Ee,{canStream:zt,outputAsset:b,quote:R,stream:Me,title:s("views.lending.txOptimizeTitle"),toggleStream:It}),e.jsx(fs,{horizontalInset:!0,items:Et,size:"sm"}),be>G&&e.jsx(c,{mt:3,children:e.jsx(je,{title:e.jsx(m,{color:"brand.yellow",mx:2,textStyle:"caption",children:s("views.lending.slippageBorrowWarning")}),type:"warn"})}),e.jsx(Ot,{address:V,disabled:Rt,handleSubmit:()=>B(!0),hasError:!y||ke||a,label:Lt,loading:$,setIsConnectModalOpen:r})]})}),e.jsx(vt,{amount:y,asset:b,collateralAmount:fe,collateralAsset:h,estimatedTime:R==null?void 0:R.estimatedTime,expectedDebtInfo:Te,expectedOutputAmount:Q,isOpened:ne,onClose:()=>B(!1),onConfirm:Ft,slippagePercent:be})]})})]})}),e.jsx(ht,{children:e.jsx(Ue,{isLoading:ge,loans:xe,refreshLoans:me,setCollateralAsset:x,setTab:le,setViewTab:I,totalBorrowed:Ne,totalCollateral:Oe})})]})]})]})},bt=Ge});export{Es as __tla,bt as default};
