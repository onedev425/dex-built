function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["CRWIkueS.js","assets/index-CyIKZwcA.js","assets/index-C3LuW5Z2.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as a,j as e,q as w,w as P,bb as xe,A as ee,T as C,I as Ee,t as r,E as je,R as q,aE as Me,ap as be,ag as Ne,a9 as se,be as Ce,ai as Te,$ as T,z as _,s as y,dm as _e,dn as Re,dp as ve,aJ as Ie,dq as te,aq as Le,ar as Ue,ao as Ye,ab as ke,at as Pe,ak as qe,am as $e,av as De,al as Oe,af as We,F as Ve,aM as ae,bU as ie,D as H,aH as Be,bY as Fe,__tla as He}from"./assets/index-CyIKZwcA.js";import{G as ne}from"./Cse5bgR0.js";import{P as re}from"./GQQXxAVl.js";import{V as oe}from"./DA3rLf5F.js";import{L as t,P as l}from"./DKb0irD5.js";import{I as le}from"./nkxDqpDa.js";import{L as ze}from"./CC7w5R6c.js";import{L as Ge}from"./B0Nsn_Oa.js";import{C as Je,__tla as Ke}from"./VQNeEiYk.js";import{u as Qe}from"./C2yJ0wdw.js";import{P as Xe}from"./xyTk0RBf.js";import"./BGeRo-1L.js";import"./CkVRNEhN.js";import"./CzdZMSiN.js";let ce,Ze=Promise.all([(()=>{try{return He}catch{}})(),(()=>{try{return Ke}catch{}})()]).then(async()=>{(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},c=new Error().stack;c&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[c]="721cffd3-45c0-4963-88c8-471565728a3f",s._sentryDebugIdIdentifier="sentry-dbid-721cffd3-45c0-4963-88c8-471565728a3f")}catch{}})();let z,$,G,J;z=({className:s,assetValue:c,stretch:f})=>{const[u="-",g]=c.toSignificant(6).split(" ");return e.jsxs(w,{alignCenter:!0,className:P("p-1 rounded-full flex-1 w-full self-stretch",{"max-w-[150px]":!f},xe.secondary,s),children:[e.jsx(ee,{asset:c}),e.jsxs(w,{col:!0,className:"ml-3",children:[e.jsx(C,{children:u}),e.jsx(C,{fontWeight:"normal",variant:"secondary",children:g})]})]})},$=a.memo(z),G=a.memo(({onPercentChange:s,percent:c,poolAsset:f,runeAmount:u,assetAmount:g,liquidityType:m})=>e.jsxs("div",{className:"relative self-stretch md:w-full",children:[e.jsx("div",{className:P("absolute flex items-center justify-center top-1/2 rounded-3xl left-1/2 -translate-y-2 -translate-x-1/2 w-[52px] h-[52px]","border-10 border-solid bg-blue dark:border-dark-border-primary border-light-border-primary"),children:e.jsx(Ee,{color:"white",name:"arrowDown",size:20})}),e.jsx(Xe,{onChange:s,percent:c,title:r("common.withdrawPercent")}),e.jsxs(je,{className:"min-h-[107px] p-4 flex-col md:flex-row items-end md:items-center gap-2",children:[e.jsx(w,{children:e.jsx(C,{className:"whitespace-nowrap",children:`${r("common.receive")}:`})}),e.jsxs(w,{className:"gap-2 py-1 flex-1 self-stretch md:self-center",children:[e.jsx(w,{className:P("overflow-hidden transition-all origin-left",{"scale-x-0":m===t.RUNE}),flex:m===t.RUNE?0:1,children:e.jsx($,{stretch:!0,assetValue:f.set(g.getValue("string"))})}),e.jsx(w,{className:P("overflow-hidden transition-all origin-right",{"scale-x-0":m===t.ASSET}),flex:m===t.ASSET?0:1,children:e.jsx($,{stretch:!0,assetValue:q.set(u.getValue("string"))})})]})]})]})),J=({poolAsset:s,shares:c})=>{const f=Me(),u=be(),{setIsConnectModalOpen:g}=Ne(),{hasWallet:m,getWalletAddress:d}=se(),{isChainPauseLPAction:R}=Ce(),{getChainWithdrawLPPaused:p}=Te(),j=a.useMemo(()=>R(s.chain)||p(s.chain),[R,s.chain,p]),[o,L]=a.useState(Object.keys(c)[0]),A=c[o],S=a.useMemo(()=>{switch(o){case l.RUNE_ASYM:return t.RUNE;case l.ASSET_ASYM:return t.ASSET;default:return t.SYMMETRICAL}},[o]),[n,U]=a.useState(S),[x,de]=a.useState(0),[ue,D]=a.useState(!1),me=a.useMemo(()=>{const i=o===l.ASSET_ASYM?s:T.from({chain:_.THORChain});return!!d(i.chain)},[d,o,s]),{feeInUSD:K}=Qe({inputAsset:n===t.ASSET?s:q,type:"outbound"}),{runeAmount:M,assetAmount:b}=a.useMemo(()=>{if(!A)return{runeAmount:new y(0),assetAmount:new y(0)};const{assetPending:i,runePending:E,sharedUnits:B,poolUnits:F,poolAssetDepth:I,poolRuneDepth:k}=A;if(o===l.PENDING)return{runeAmount:y.fromBigInt(BigInt(E),8).mul(x/100),assetAmount:y.fromBigInt(BigInt(i),8).mul(x/100)};const N={percent:x/100,liquidityUnits:B,poolUnits:F||"0",assetDepth:I||"0",runeDepth:k||"0"};return n===t.SYMMETRICAL?_e(N):{runeAmount:n===t.RUNE?Re(N):y.fromBigInt(0n,8),assetAmount:n===t.ASSET?ve(N):y.fromBigInt(0n,8)}},[o,A,x,n]),{data:O}=Ie([q,s],{pollingInterval:6e4}),[Q,X]=a.useMemo(()=>{var i,E;return[(i=O[te(q).identifier])==null?void 0:i.price_usd,(E=O[te(s).identifier])==null?void 0:E.price_usd]},[O,s]),he=a.useCallback(i=>{L(i),i===l.RUNE_ASYM?U(t.RUNE):i===l.ASSET_ASYM?U(t.ASSET):U(t.SYMMETRICAL)},[]),pe=a.useCallback(i=>{de(Number(i.toFixed(2))||0)},[]),Y=a.useMemo(()=>{switch(o){case l.PENDING:case l.SYM:return"sym";case l.RUNE_ASYM:return"baseAsset";case l.ASSET_ASYM:return"asset"}},[o]),v=a.useMemo(()=>{if([l.ASSET_ASYM,l.RUNE_ASYM].includes(o))return Y;switch(n){case t.SYMMETRICAL:return"sym";case t.RUNE:return"baseAsset";case t.ASSET:return"asset"}},[o,Y,n]),fe=a.useCallback(async()=>{var N;if(D(!1),!m)return;const i=T.fromChainOrSignature(_.THORChain,M.getValue("string")),E=s.add(b),B=v==="asset"?s.chain:_.THORChain,F=(v==="sym"?[i,E]:v==="baseAsset"?[i]:[E]).map(h=>`${h.toSignificant(6)} ${h.ticker}`).join(" & "),I=Le();u(Ue({id:I,type:Ye.TC_LP_WITHDRAW,inChain:B,label:F}));const{thorchain:k}=await(await ke(()=>import("./CRWIkueS.js"),__vite__mapDeps([0,1,2]))).getSwapKitClient();try{if(!k)throw new Error("THORChain Provider not found");const h=await k.withdraw({assetValue:s,percent:new y({value:x,decimal:2}).getValue("number"),from:Y,to:v});u(Pe({id:I,txid:h}))}catch(h){qe(h);const ye=((N=h==null?void 0:h.data)==null?void 0:N.originMessage)||h;$e(r("notification.submitFail"),ye,void 0,h),u(De({id:I,status:"error"}))}},[m,M,s,b,v,u,x,Y]),Ae=a.useCallback(()=>{m?D(!0):Oe(r("notification.walletNotFound"),r("notification.connectWallet"))},[m]),Se=a.useMemo(()=>`${r("common.withdraw")} ${s.ticker} ${r("common.liquidity")}`,[s]),we=a.useMemo(()=>o===l.PENDING?[t.SYMMETRICAL]:o===l.RUNE_ASYM?[t.RUNE]:o===l.ASSET_ASYM?[t.ASSET]:[t.ASSET,t.SYMMETRICAL,t.RUNE],[o]),Z=a.useMemo(()=>{const i=[];return(n===t.SYMMETRICAL||n===t.RUNE)&&i.push({asset:T.from({chain:_.THORChain}),value:`${M.toSignificant(6)} RUNE ($${((Q||0)*M.getValue("number")).toFixed(2)})`}),(n===t.SYMMETRICAL||n===t.ASSET)&&i.push({asset:s,value:`${b.toSignificant(6)} ${s.ticker} ($${((X||0)*b.getValue("number")).toFixed(2)})`}),i},[n,M,Q,s,b,X]),W=a.useMemo(()=>!!c.pending&&Object.keys(c).length>1,[c]),V=a.useMemo(()=>Z.map(i=>({label:`${r("common.withdraw")} ${i.asset.ticker} (${i.asset.type})`,value:e.jsxs(w,{alignCenter:!0,justify:"between",children:[e.jsx(C,{className:"mx-2",fontWeight:"semibold",children:i.value}),e.jsx(ee,{asset:i.asset,size:24})]})})).concat([{label:r("common.transactionFee"),value:e.jsx(We,{tooltip:r("views.liquidity.gasFeeTooltip"),value:K})}]),[K,Z]),ge=a.useMemo(()=>V.concat(W?[{label:"",value:e.jsx(Ve,{alignSelf:"center",justify:"center",p:"4",children:e.jsx(C,{color:"yellow.400",children:r("pendingLiquidity.withdrawWarning")})})}]:[]),[V,W]);return e.jsxs(re,{header:e.jsx(oe,{withBack:!0,actionsComponent:e.jsx(ne,{}),title:Se}),title:r("views.liquidity.withdrawLiquidity"),children:[e.jsx(Ge,{onChange:U,options:we,poolAsset:s,selected:n,title:`${r("views.liquidity.withdraw")}:`}),e.jsx(ze,{onChange:he,options:Object.keys(c),poolAsset:s,selected:o,title:`${r("views.liquidity.from")}:`}),e.jsx(G,{assetAmount:b,liquidityType:n,onPercentChange:pe,percent:new y(x),poolAsset:s,runeAmount:M}),c.pending&&e.jsx(ae,{onClick:()=>f(ie(s)),title:r("pendingLiquidity.content",{asset:`${s.ticker} or RUNE`}),type:"warn"}),W&&e.jsx(ae,{onClick:()=>f(ie(s)),title:r("pendingLiquidity.withdrawWarning"),type:"warn"}),e.jsx(w,{className:"w-full pt-4",children:e.jsx(le,{horizontalInset:!0,items:V})}),e.jsx(w,{className:"self-stretch gap-4 pt-5",children:j?e.jsx(H,{stretch:!0,size:"lg",variant:"secondary",children:r("views.liquidity.withdrawNotAvailable")}):me?e.jsx(H,{stretch:!0,onClick:Ae,size:"lg",variant:"secondary",children:r("common.withdraw")}):e.jsx(H,{stretch:!0,onClick:()=>g(!0),size:"lg",variant:"fancy",children:r("common.connectWallet")})}),e.jsx(Je,{inputAssets:[n===t.ASSET?s:T.from({chain:_.THORChain})],isOpened:ue,onClose:()=>D(!1),onConfirm:fe,children:e.jsx(le,{items:ge})})]})},ce=()=>{const{walletAddresses:s,isWalletLoading:c}=se(),{assetParam:f=T.from({chain:_.Bitcoin}).toString()}=Be(),{data:u,isLoading:g}=Fe(s,{skip:!s.length||c}),[m,d]=a.useMemo(()=>{if(g||!u)return[];const p=u.filter(o=>o.pool===f.toUpperCase());if(!p)return[];const[{pool:j}]=p;return[T.fromStringSync(j),p]},[f,u,g]),R=a.useMemo(()=>{const p=d==null?void 0:d.find(({assetPending:S,runePending:n})=>Number(S)>0||Number(n)>0),j=!p&&(d==null?void 0:d.find(({runeAddress:S,assetAddress:n})=>S&&n)),o=d==null?void 0:d.find(({runeAddress:S,assetAddress:n})=>S&&!n),L=d==null?void 0:d.find(({runeAddress:S,assetAddress:n})=>!S&&n),A={};return p&&(A[l.PENDING]=p),j&&(A[l.SYM]=j),o&&(A[l.RUNE_ASYM]=o),L&&(A[l.ASSET_ASYM]=L),A},[d]);return m&&Object.values(R).length?e.jsx(J,{poolAsset:m,shares:R}):e.jsx(re,{header:e.jsx(oe,{withBack:!0,actionsComponent:e.jsx(ne,{}),title:r("views.liquidity.withdrawLiquidity")}),title:r("views.liquidity.withdrawLiquidity"),children:e.jsx(C,{children:r("views.liquidity.noLiquidityToWithdraw")})})}});export{Ze as __tla,ce as default};
