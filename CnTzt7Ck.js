function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["DzP8eMH-.js","assets/index-CyIKZwcA.js","assets/index-C3LuW5Z2.css","CRWIkueS.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{u as Ot,r as s,a as dn,m as ya,c as ja,f as Ye,b as pn,o as mn,d as hn,j as e,e as Qe,F as N,I as oe,T as p,t as x,M as Mt,B as Te,g as Et,h as xn,i as It,n as Rt,k as gn,l as Aa,p as ve,q as f,s as fe,v as Ca,w as ke,A as be,x as ka,y as rt,$ as de,z as J,C as Ft,H as Na,D as je,E as fn,G as Ta,L as _t,J as ot,R as Sn,K as wn,N as Pa,O as vn,P as Pe,Q as bn,S as yn,U as jn,V as An,W as Cn,X as kn,Y as lt,Z as Oa,_ as ct,a0 as Ut,a1 as Nn,a2 as we,a3 as Tn,a4 as Ma,a5 as Pn,a6 as On,a7 as Dt,a8 as Mn,a9 as Xe,aa as Vt,ab as ut,ac as En,ad as In,ae as $t,af as dt,ag as Rn,ah as Fn,ai as _n,aj as Un,ak as pt,al as Wt,am as Ge,an as me,ao as ce,ap as Ea,aq as Ia,ar as Ra,as as De,at as Fa,au as Dn,av as mt,aw as _a,ax as Vn,ay as $n,az as Wn,aA as qe,aB as Hn,aC as Bn,aD as Ln,aE as zn,aF as Yn,aG as Qn,aH as Xn,aI as Ua,aJ as Gn,aK as qn,aL as ht,aM as Ke,aN as Kn,__tla as Jn}from"./assets/index-CyIKZwcA.js";import{C as Da}from"./Caa2RfUU.js";import{P as Zn}from"./GQQXxAVl.js";import{u as Je}from"./C20jg5MW.js";import{l as ei,u as ti,__tla as ai}from"./BQokClGM.js";import{I as Va}from"./nkxDqpDa.js";import{u as si,c as $a,v as Wa,a as ni,p as ii,r as ri,g as oi,b as li,d as Ht,e as Ve,f as Bt,o as ci,h as ui,i as di,j as Lt,S as Ha,k as pi,l as mi,m as hi,n as xi,A as gi}from"./CBlIVkVu.js";import{A as Ba,u as fi,P as zt}from"./nBoaRR4P.js";import{u as La}from"./CWmyRVe8.js";import{u as Si}from"./BhLnMwi7.js";import{u as za}from"./CbB86d3W.js";import{C as wi,__tla as vi}from"./VQNeEiYk.js";import{C as Ya}from"./Cguvfe_P.js";import{u as bi,C as yi}from"./B7ad4Bv7.js";import{G as ji}from"./Cse5bgR0.js";import{V as Ai}from"./DA3rLf5F.js";import{S as Ci}from"./CYxzY4q6.js";import{c as ki,__tla as Ni}from"./CJ_Ik3qV.js";import"./mMiU1HvE.js";import"./BDCxTHDM.js";import"./DYrZbK8R.js";import"./C2yJ0wdw.js";import"./l25LWlPl.js";import"./BGeRo-1L.js";import"./CkVRNEhN.js";import"./CzdZMSiN.js";import"./rzhudTEk.js";import"./B3Cf38Ih.js";import"./Cm6z4UIW.js";import"./Bfr6H5f3.js";import"./CRWIkueS.js";import{__tla as Ti}from"./Cx7gR159.js";let Qa,Pi=Promise.all([(()=>{try{return Jn}catch{}})(),(()=>{try{return ai}catch{}})(),(()=>{try{return vi}catch{}})(),(()=>{try{return Ni}catch{}})(),(()=>{try{return Ti}catch{}})()]).then(async()=>{(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[a]="e5394caf-8697-4314-8c36-b5eaac164868",t._sentryDebugIdIdentifier="sentry-dbid-e5394caf-8697-4314-8c36-b5eaac164868")}catch{}})();function Xa(t){const{min:a=0,max:n=100,onChange:i,value:r,defaultValue:l,isReversed:c,direction:o="ltr",orientation:g="horizontal",id:d,isDisabled:h,isReadOnly:v,onChangeStart:S,onChangeEnd:b,step:w=1,getAriaValueText:u,"aria-valuetext":m,"aria-label":y,"aria-labelledby":T,name:P,focusThumbOnChange:D=!0,minStepsBetweenThumbs:B=0,...I}=t,k=Ot(S),z=Ot(b),H=Ot(u),L=ui({isReversed:c,direction:o,orientation:g}),[ee,X]=si({value:r,defaultValue:l??[25,75],onChange:i});if(!Array.isArray(ee))throw new TypeError(`[range-slider] You passed an invalid value for \`value\` or \`defaultValue\`, expected \`Array\` but got \`${typeof ee}\``);const[pe,ue]=s.useState(!1),[ie,F]=s.useState(!1),[O,ne]=s.useState(-1),W=!(h||v),Se=s.useRef(ee),R=ee.map(j=>$a(j,a,n)),Z=B*w,A=Ga(R,a,n,Z),_=s.useRef({eventSource:null,value:[],valueBounds:[]});_.current.value=R,_.current.valueBounds=A;const M=R.map(j=>n-j+a),G=(L?M:R).map(j=>Wa(j,a,n)),K=g==="vertical",le=s.useRef(null),re=s.useRef(null),se=ni({getNodes(){const j=re.current,E=j==null?void 0:j.querySelectorAll("[role=slider]");return E?Array.from(E):[]}}),he=s.useId(),te=di(d??he),Me=s.useCallback(j=>{var E,$;if(!le.current)return;_.current.eventSource="pointer";const V=le.current.getBoundingClientRect(),{clientX:q,clientY:ge}=($=(E=j.touches)==null?void 0:E[0])!=null?$:j,U=K?V.bottom-ge:q-V.left,Le=K?V.height:V.width;let ze=U/Le;return L&&(ze=1-ze),ii(ze,a,n)},[K,L,n,a]),Ee=(n-a)/10,Ie=w||(n-a)/100,xe=s.useMemo(()=>({setValueAtIndex(j,E){if(!W)return;const $=_.current.valueBounds[j];E=parseFloat(ri(E,$.min,Ie)),E=$a(E,$.min,$.max);const V=[..._.current.value];V[j]=E,X(V)},setActiveIndex:ne,stepUp(j,E=Ie){const $=_.current.value[j],V=L?$-E:$+E;xe.setValueAtIndex(j,V)},stepDown(j,E=Ie){const $=_.current.value[j],V=L?$+E:$-E;xe.setValueAtIndex(j,V)},reset(){X(Se.current)}}),[Ie,L,X,W]),Ce=s.useCallback(j=>{const E=j.key,$={ArrowRight:()=>xe.stepUp(O),ArrowUp:()=>xe.stepUp(O),ArrowLeft:()=>xe.stepDown(O),ArrowDown:()=>xe.stepDown(O),PageUp:()=>xe.stepUp(O,Ee),PageDown:()=>xe.stepDown(O,Ee),Home:()=>{const{min:V}=A[O];xe.setValueAtIndex(O,V)},End:()=>{const{max:V}=A[O];xe.setValueAtIndex(O,V)}}[E];$&&(j.preventDefault(),j.stopPropagation(),$(j),_.current.eventSource="keyboard")},[xe,O,Ee,A]),{getThumbStyle:We,rootStyle:tt,trackStyle:He,innerTrackStyle:Y}=s.useMemo(()=>oi({isReversed:L,orientation:g,thumbRects:se,thumbPercents:G}),[L,g,G,se]),at=s.useCallback(j=>{var E;const $=j??O;if($!==-1&&D){const V=te.getThumb($),q=(E=re.current)==null?void 0:E.ownerDocument.getElementById(V);q&&setTimeout(()=>q.focus())}},[D,O,te]);dn(()=>{_.current.eventSource==="keyboard"&&(z==null||z(_.current.value))},[R,z]);const At=j=>{const E=Me(j)||0,$=_.current.value.map(U=>Math.abs(U-E)),V=Math.min(...$);let q=$.indexOf(V);const ge=$.filter(U=>U===V);ge.length>1&&E>_.current.value[q]&&(q=q+ge.length-1),ne(q),xe.setValueAtIndex(q,E),at(q)},Ct=j=>{if(O==-1)return;const E=Me(j)||0;ne(O),xe.setValueAtIndex(O,E),at(O)};li(re,{onPanSessionStart(j){W&&(ue(!0),At(j),k==null||k(_.current.value))},onPanSessionEnd(){W&&(ue(!1),z==null||z(_.current.value))},onPan(j){W&&Ct(j)}});const Be=s.useCallback((j={},E=null)=>({...j,...I,id:te.root,ref:ya(E,re),tabIndex:-1,"aria-disabled":Ht(h),"data-focused":Ve(ie),style:{...j.style,...tt}}),[I,h,ie,tt,te]),Re=s.useCallback((j={},E=null)=>({...j,ref:ya(E,le),id:te.track,"data-disabled":Ve(h),style:{...j.style,...He}}),[h,He,te]),Ne=s.useCallback((j={},E=null)=>({...j,ref:E,id:te.innerTrack,style:{...j.style,...Y}}),[Y,te]),kt=s.useCallback((j,E=null)=>{var $;const{index:V,...q}=j,ge=R[V];if(ge==null)throw new TypeError(`[range-slider > thumb] Cannot find value at index \`${V}\`. The \`value\` or \`defaultValue\` length is : ${R.length}`);const U=A[V];return{...q,ref:E,role:"slider",tabIndex:W?0:void 0,id:te.getThumb(V),"data-active":Ve(pe&&O===V),"aria-valuetext":($=H==null?void 0:H(ge))!=null?$:m==null?void 0:m[V],"aria-valuemin":U.min,"aria-valuemax":U.max,"aria-valuenow":ge,"aria-orientation":g,"aria-disabled":Ht(h),"aria-readonly":Ht(v),"aria-label":y==null?void 0:y[V],"aria-labelledby":y!=null&&y[V]||T==null?void 0:T[V],style:{...j.style,...We(V)},onKeyDown:Bt(j.onKeyDown,Ce),onFocus:Bt(j.onFocus,()=>{F(!0),ne(V)}),onBlur:Bt(j.onBlur,()=>{F(!1),ne(-1)})}},[te,R,A,W,pe,O,H,m,g,h,v,y,T,We,Ce,F]),Fe=s.useCallback((j={},E=null)=>({...j,ref:E,id:te.output,htmlFor:R.map(($,V)=>te.getThumb(V)).join(" "),"aria-live":"off"}),[te,R]),ye=s.useCallback((j,E=null)=>{const{value:$,...V}=j,q=!($<a||$>n),ge=$>=R[0]&&$<=R[R.length-1];let U=Wa($,a,n);U=L?100-U:U;const Le={position:"absolute",pointerEvents:"none",...ci({orientation:g,vertical:{bottom:`${U}%`},horizontal:{left:`${U}%`}})};return{...V,ref:E,id:te.getMarker(j.value),role:"presentation","aria-hidden":!0,"data-disabled":Ve(h),"data-invalid":Ve(!q),"data-highlighted":Ve(ge),style:{...j.style,...Le}}},[h,L,n,a,g,R,te]),_e=s.useCallback((j,E=null)=>{const{index:$,...V}=j;return{...V,ref:E,id:te.getInput($),type:"hidden",value:R[$],name:Array.isArray(P)?P[$]:`${P}-${$}`}},[P,R,te]);return{state:{value:R,isFocused:ie,isDragging:pe,getThumbPercent:j=>G[j],getThumbMinValue:j=>A[j].min,getThumbMaxValue:j=>A[j].max},actions:xe,getRootProps:Be,getTrackProps:Re,getInnerTrackProps:Ne,getThumbProps:kt,getMarkerProps:ye,getInputProps:_e,getOutputProps:Fe}}function Ga(t,a,n,i){return t.map((r,l)=>{const c=l===0?a:t[l-1]+i,o=l===t.length-1?n:t[l+1]-i;return{min:c,max:o}})}var[qa,Ze]=ja({name:"SliderContext",errorMessage:"useSliderContext: `context` is undefined. Seems you forgot to wrap all slider components within <RangeSlider />"}),[Ka,et]=ja({name:"RangeSliderStylesContext",errorMessage:`useRangeSliderStyles returned is 'undefined'. Seems you forgot to wrap the components in "<RangeSlider />" `}),Yt=Ye(function(t,a){const n={orientation:"horizontal",...t},i=pn("Slider",n),r=mn(n),{direction:l}=hn();r.direction=l;const{getRootProps:c,...o}=Xa(r),g=s.useMemo(()=>({...o,name:n.name}),[o,n.name]);return e.jsx(qa,{value:g,children:e.jsx(Ka,{value:i,children:e.jsx(Qe.div,{...c({},a),className:"chakra-slider",__css:i.container,children:n.children})})})});Yt.displayName="RangeSlider";var xt=Ye(function(t,a){const{getThumbProps:n,getInputProps:i,name:r}=Ze(),l=et(),c=n(t,a);return e.jsxs(Qe.div,{...c,className:Lt("chakra-slider__thumb",t.className),__css:l.thumb,children:[c.children,r&&e.jsx("input",{...i({index:t.index})})]})});xt.displayName="RangeSliderThumb";var Qt=Ye(function(t,a){const{getTrackProps:n}=Ze(),i=et(),r=n(t,a);return e.jsx(Qe.div,{...r,className:Lt("chakra-slider__track",t.className),__css:i.track,"data-testid":"chakra-range-slider-track"})});Qt.displayName="RangeSliderTrack";var Xt=Ye(function(t,a){const{getInnerTrackProps:n}=Ze(),i=et(),r=n(t,a);return e.jsx(Qe.div,{...r,className:"chakra-slider__filled-track",__css:i.filledTrack})});Xt.displayName="RangeSliderFilledTrack";var Ja=Ye(function(t,a){const{getMarkerProps:n}=Ze(),i=et(),r=n(t,a);return e.jsx(Qe.div,{...r,className:Lt("chakra-slider__marker",t.className),__css:i.mark})});Ja.displayName="RangeSliderMark";const Gt=({chain:t})=>e.jsxs(N,{align:"center",direction:"column",gap:4,h:"full",justify:"center",w:"full",children:[e.jsx(oe,{color:"primary",name:"chart",size:48}),e.jsx(p,{textAlign:"center",children:x("views.swap.gasHistoryNotSupported",{chain:t})})]}),Za=({title:t,isOpened:a,setIsOpened:n,historyData:i,unitName:r,chain:l,hoveredIndex:c,setHoveredIndex:o,isLoading:g,gasState:d,resetChartValue:h})=>{const v=()=>{n(!1)};return e.jsx(Mt,{isOpened:a,onClose:v,title:t||"",children:g?e.jsx(N,{align:"center",minH:"230px",children:e.jsx(oe,{spin:!0,name:"loader",size:24})}):i?e.jsxs(Te,{w:"full",children:[e.jsxs(Te,{pb:2,pl:3,children:[e.jsx(p,{children:x("components.gasHistory.chartTitle",{chain:l})}),e.jsxs(N,{children:[e.jsx(p,{fontSize:"11px",children:x("views.swap.currentGasRate")}),"\xA0",e.jsx(p,{color:`brand.${d==null?void 0:d.color}`,fontSize:"11px",children:`${d==null?void 0:d.state} (${i.values[i.values.length-1]} ${r})`})]})]}),e.jsxs(N,{bg:"borderPrimary",borderRadius:"md",direction:"column",pt:2,px:1,w:"full",children:[e.jsxs(N,{direction:"column",ml:3,children:[e.jsxs(N,{children:[e.jsx(p,{color:"brand.navy",children:c&&i.values[c]}),"\xA0",e.jsx(p,{children:r})]}),e.jsx(p,{children:c&&i.labels[c]})]}),e.jsx(Te,{ml:"-13px",onMouseLeave:h,width:"calc(100% + 26px)",children:e.jsx(Da,{hideAxisLines:!0,hideLabel:!0,hideTooltip:!0,hoveredIndex:c,labels:i==null?void 0:i.labels,onHover:o,values:i==null?void 0:i.values})})]})]}):e.jsx(N,{align:"center",minH:"230px",children:e.jsx(Gt,{chain:l})})})},es=({sx:t,historyData:a,unitName:n,chain:i,hoveredIndex:r,setHoveredIndex:l,isLoading:c,gasState:o,resetChartValue:g})=>e.jsx(N,{_dark:{bgColor:"bgSecondary",border:"none"},align:"center",bgColor:"white",border:"1px solid",borderColor:"borderPrimary",borderRadius:24,boxShadow:"md",boxSizing:"border-box",direction:"column",justify:a?"start":"center",maxWidth:"480px",minH:"500px",mt:{base:0,lg:"64px"},mx:"auto",p:4,sx:t,top:0,transition:Et,width:{lg:"280px"},children:c?e.jsx(oe,{spin:!0,name:"loader",size:24}):a?e.jsxs(Te,{w:"full",children:[e.jsxs(Te,{pb:2,pl:2,children:[e.jsx(p,{children:x("components.gasHistory.chartTitle",{chain:i})}),e.jsxs(N,{children:[e.jsx(p,{fontSize:"11px",children:x("views.swap.currentGasRate")}),"\xA0",e.jsx(p,{color:`brand.${o==null?void 0:o.color}`,fontSize:"11px",children:`${o==null?void 0:o.state} (${a.values[a.values.length-1]} ${n})`})]})]}),e.jsxs(N,{bg:"borderPrimary",borderRadius:"xl",direction:"column",pt:2,w:"full",children:[e.jsxs(N,{direction:"column",display:"flex",ml:3,children:[e.jsxs(N,{children:[e.jsx(p,{color:"brand.navy",children:r&&a.values[r]}),"\xA0",e.jsx(p,{children:n})]}),e.jsx(p,{color:"textSecondary",fontWeight:"normal",textStyle:"captiongit",children:r&&a.labels[r]})]}),e.jsx(Te,{ml:"-9px",onMouseLeave:g,width:"calc(100% + 18px)",children:e.jsx(Da,{hideAxisLines:!0,hideLabel:!0,hideTooltip:!0,hoveredIndex:r,labels:a==null?void 0:a.labels,onHover:l,values:a==null?void 0:a.values})})]})]}):e.jsx(Gt,{chain:i})}),ts=t=>t?t.reduce((a,n)=>a+n,0)/t.length:void 0,gt=(t,a)=>{const n=a||ts(t);if(!(n&&t))return;const i=t[(t==null?void 0:t.length)-1];return i<n*.85?{color:"green",state:x("views.swap.low")}:i>n*1.15?{color:"red",state:x("views.swap.high")}:{color:"yellow",state:x("views.swap.average")}},as=({analyticsVisible:t,toggleAnalytics:a,inputAssetChain:n})=>{const{isLgActive:i}=xn(),{data:r,isLoading:l}=It(),c=s.useMemo(()=>{if(r)return r.find(b=>b&&b.chainId===Rt[n])},[r,n]),o=s.useMemo(()=>{if(!c)return;const b=(c==null?void 0:c.history.map(y=>y.value))??[],w=(c==null?void 0:c.history.map(y=>gn(y.timestamp).format("DD MMM YYYY, HH:mm")))??[],u=b.reduce((y,T,P)=>(T===null&&y.push(P),y),[]),m=w.filter((y,T)=>!u.includes(T));return{values:b.filter(Boolean),labels:m,average24h:c.average24h,average7d:c.average7d}},[c]),[g,d]=s.useState(o==null?void 0:o.values.length);s.useEffect(()=>{o!=null&&o.values&&d((o==null?void 0:o.values.length)-1)},[o]);const h=Aa(n),v=gt(o==null?void 0:o.values,(o==null?void 0:o.average7d)||(o==null?void 0:o.average24h)),S=()=>{o&&setTimeout(()=>{d((o==null?void 0:o.values.length)-1)},100)};return i?e.jsx(Te,{position:{base:"static",xl:"absolute"},right:2,transform:{base:`translateY(${t?"0%":"100%"})`,lg:`translateX(${t?"0%":"100%"})`},transition:Et,children:t&&e.jsx(es,{chain:h,gasState:v,historyData:o,hoveredIndex:g,isLoading:l,resetChartValue:S,setHoveredIndex:d,unitName:c==null?void 0:c.unitName})}):e.jsx(Za,{chain:h,gasState:v,historyData:o,hoveredIndex:g,isLoading:l,isOpened:t,resetChartValue:S,setHoveredIndex:d,setIsOpened:a,title:"Analysis",unitName:c==null?void 0:c.unitName})},qt=t=>s.useMemo(()=>{var c;const a={outOfPocketFee:0,firstNetworkFee:0,affiliateFee:0,networkFee:0,totalFee:0},n=Object.values(t||{}).flat();if(n.length===0)return a;const{outOfPocketFee:i,networkFee:r,affiliateFee:l}=n.reduce((o,{affiliateFeeUSD:g,networkFeeUSD:d,isOutOfPocket:h})=>(o.affiliateFee+=g,o.networkFee+=d,o.outOfPocketFee+=h?d:0,o),a);return{firstNetworkFee:((c=n==null?void 0:n[0])==null?void 0:c.networkFeeUSD)||0,affiliateFee:l,networkFee:r,outOfPocketFee:i,totalFee:l+r}},[t]),Kt=s.memo(({fees:t,size:a="md"})=>{const{networkFee:n}=qt(t),i=s.useMemo(()=>a==="md"?14:10,[a]);return n?e.jsx(ve,{children:e.jsxs(f,{center:!0,children:[e.jsx(p,{color:"brand.yellow",textStyle:"caption-xs",variant:"secondaryBtn",children:`$${new fe({value:n,decimal:2}).toFixed(2)}`}),e.jsx(oe,{className:"pl-0.5",color:"yellow",name:"gas",size:i})]})}):null}),ss=24*60*60*1e3,Jt=({streamingSwapParams:t,timeEstimates:a,streamSwap:n,useMaxTime:i})=>{const r=s.useMemo(()=>{if(!a)return null;const l=(a.inbound?a.inbound*1e3:a.inboundMs)||0,c=(a.swap?a.swap*1e3:a.swapMs)||0,o=(a.outbound?a.outbound*1e3:a.outboundMs)||0,g=(a.streaming?a.streaming*1e3:a.streamingMs)||0,d=(t?t.interval*t.subswaps*6e3:g)||0,h=l+c+o,v=l+c+Math.max(d,o);return n?v:h},[t,a,n]);return i?ss:r},Zt=({timeEstimates:t,streamSwap:a})=>{const n=Jt({timeEstimates:t,streamSwap:a}),i=s.useMemo(()=>{if(n){if(n>54e6)return"red";if(n>288e5)return"orange"}return""},[n]);return e.jsx("div",{children:e.jsxs(f,{className:"gap-1 items-center",children:[e.jsx(p,{textStyle:"caption",color:i,children:n?Ca(n):"n/a"}),e.jsx(ve,{content:x("txManager.estimatedTxDuration"),children:e.jsx(oe,{name:"timer",size:14})})]})})},ft={MAYACHAIN:"MAYAChain",MAYACHAIN_STREAMING:"MAYAChain Streaming",THORCHAIN:"THORChain",THORCHAIN_STREAMING:"THORChain Streaming",CHAINFLIP:"Chainflip",ONEINCH:"1inch",UNISWAP:"UniswapV1",UNISWAP_V1:"UniswapV1",UNISWAPV2:"UniswapV2",Uniswap_V2:"UniswapV2",KYBERSWAP:"KyberSwap",KYBERSWAPV2:"KyberSwapV2",KYBERSWAP_V2:"KyberSwapV2",TRADERJOE:"TraderJoe",PLATYPUS:"Platypus",PANGOLIN_V1:"Pangolin",BALANCERV2:"Balancer",UNISWAPV3:"UniswapV3",Uniswap_V3:"UniswapV3",ZEROX:"0x",CURVEV2:"CurveV2",Curve_V2:"CurveV2",CURVE:"Curve",SUSHISWAP:"SushiSwap",SUSHISWAP_V2:"SushiSwap",SUSHI:"SushiSwap",SYNTHETIXATOMIC:"Syntetix",SYNTHETIX_ATOMIC_SIP288:"Syntetix",KYBERSWAPELASTIC:"KyberSwap",SYNAPSE:"Synapse",TRADERJOE_V2:"TraderJoe",AVALANCHE_TRADERJOE_V2:"TraderJoe","WOOFI-AVAX":"WOOFI"},ea=s.memo(({className:t,size:a=24,providers:n})=>{const i=s.useMemo(()=>n.map(r=>r.split("-")[0]),[n]);return e.jsx(N,{className:"px-1 max-w-[100px]",flex:1,flexDirection:"row-reverse",justify:"between",children:i.map((r,l)=>{const c=ft[r]||r,o=l===0;return e.jsx(f,{className:ke(t,{"z-10":o,"-z-0 -ml-2":!o}),children:e.jsx(ve,{content:c,children:e.jsx(be,{logoURI:ka(r),size:a,secondaryIcon:[rt.MAYACHAIN_STREAMING,rt.THORCHAIN_STREAMING].includes(r)?"dollarOutlined":void 0})})},r)})})}),ns=s.memo(({providerLogoURL:t,provider:a,percentage:n})=>e.jsxs(f,{align:"end",className:"w-full gap-2 p-1.5",children:[t&&e.jsx(be,{logoURI:t,size:24}),e.jsxs(p,{className:"text-[11px]",textStyle:"caption",children:[ft[a.replace("_","")]||a,` - ${n}%`]})]})),is=s.memo(({fromAsset:t,toAsset:a,swapParts:n})=>e.jsxs(f,{col:!0,className:"w-full",children:[e.jsxs(f,{center:!0,row:!0,className:"gap-2 py-2",children:[e.jsx(be,{logoURI:t.logoURL,size:24}),e.jsx(p,{className:"text-[18px]",children:"\u2192"}),e.jsx(be,{logoURI:a.logoURL,size:24})]}),e.jsx(f,{col:!0,className:"border border-solid rounded-xl border-light-border-primary dark:border-dark-border-primary",children:n.map(i=>e.jsx(ns,{...i},`${i.provider}-${i.percentage}`))})]})),ta=({address:t,identifier:a})=>({identifier:a,logoURL:Ft({address:t,identifier:a})}),rs=s.memo(({isOpened:t,onClose:a,swaps:n})=>{const i=s.useMemo(()=>Object.entries(n).reduce((r,[l,c])=>{const o=Aa(l,!0),g=de.fromChainOrSignature(l==="THORCHAIN"?J.THORChain:l),d=c.map(h=>h.map(({from:v,to:S,parts:b,fromTokenAddress:w,toTokenAddress:u})=>({fromAsset:ta({address:w,identifier:v}),toAsset:ta({address:u,identifier:S}),swapParts:b.concat().sort((m,y)=>y.percentage-m.percentage).map(({percentage:m,provider:y})=>({percentage:m,providerLogoURL:y?ka(y):"",provider:ft[y]||y}))})));return r.push({name:o,chainSwaps:d,logoURL:Ft({identifier:`${g.chain}.${g.ticker}`})}),r},[]),[n]);return e.jsx(Mt,{isOpened:t,onClose:a,title:x("common.swapPath"),children:e.jsx(f,{className:"gap-x-4 max-h-[80vh] max-w-[80vw]",children:i.map(({name:r,logoURL:l,chainSwaps:c},o)=>e.jsx("div",{children:e.jsxs(f,{center:!0,children:[e.jsxs(f,{col:!0,children:[e.jsxs(f,{alignCenter:!0,className:"gap-2 pb-2",children:[l&&e.jsx(be,{logoURI:l,size:28}),e.jsx(p,{textStyle:"subtitle2",children:r})]}),e.jsx(f,{alignCenter:!0,col:!0,flex:1,children:c.map(g=>e.jsx(f,{alignCenter:!0,row:!0,className:"gap-6",children:g.map((d,h)=>e.jsxs(s.Fragment,{children:[e.jsx(is,{...d}),h!==g.length-1&&e.jsx(p,{className:"text-[24px]",children:"\u2192"})]},`${d.fromAsset.identifier}-${d.toAsset.identifier}`))},`${g[0].fromAsset.identifier}-${g[0].toAsset.identifier}`))})]}),o!==i.length-1&&e.jsx(p,{className:"text-[34px]",children:"\u2192"})]})},r))})})}),os=s.memo(({expectedOutput:t,streamingSwap:a,swaps:n,outputAssetDecimal:i,unitPrice:r,path:l,providers:c,isApproved:o,assetTicker:g,fees:d,streamSwap:h,timeEstimates:v})=>{const[S,b]=s.useState(!1),w=Je(),u=s.useMemo(()=>Number.parseFloat(h&&(a==null?void 0:a.expectedOutput)||t),[t,h,a==null?void 0:a.expectedOutput]),m=s.useMemo(()=>w(new fe({value:u,decimal:i})),[w,i,u]),y=s.useMemo(()=>w(r*u),[u,w,r]),T=s.useCallback(D=>{D.stopPropagation(),b(!0)},[]),P=s.useMemo(()=>{var z;const D=(z=l.split(" -> "))==null?void 0:z.map(H=>{var L;return(L=H.split("-"))==null?void 0:L[0]}),[B,I,...k]=D;return k.length>1?`${B} \u2192 ${I} ... ${k[k.length-1]}`:D.join(" \u2192 ")},[l]);return e.jsxs(f,{col:!0,className:"relative",flex:1,children:[e.jsxs(f,{col:!0,className:"pl-4 py-1",children:[e.jsxs(f,{justify:"between",children:[e.jsxs(f,{className:"pt-3",children:[e.jsx(ea,{className:"pb-3",providers:c,size:30}),o&&e.jsx(Na,{iconName:"approved",size:22})]}),e.jsxs(f,{col:!0,className:"pr-2",justify:"end",children:[e.jsxs(f,{className:"gap-x-1",justify:"end",children:[e.jsx(p,{children:new fe(m).toSignificant(6)}),e.jsx(p,{children:g})]}),e.jsxs(f,{alignCenter:!0,className:"gap-x-1",children:[e.jsx(Kt,{fees:d}),e.jsx(p,{variant:"secondary",children:y})]})]})]}),e.jsxs(f,{justify:"between",children:[e.jsx(je,{className:"h-6 px-3 w-fit",onClick:T,tooltip:x("views.swap.swapPath"),variant:"tint",children:e.jsxs(p,{textStyle:"caption-xs",variant:"secondary",children:[x("common.path"),": ",P]})}),e.jsx(f,{className:"mr-2",children:e.jsx(Zt,{streamSwap:typeof h=="boolean"?h:!!a,timeEstimates:v})})]})]}),n&&e.jsx(rs,{isOpened:S,onClose:()=>b(!1),swaps:n})]})}),ls=s.memo(({expectedOutput:t,streamingSwap:a,onClick:n,isApproved:i,outputAsset:r,unitPrice:l,path:c,providers:o,selected:g,fees:d,streamSwap:h,timeEstimates:v})=>{const S=Je(),[,b]=r.symbol.split("-"),w=s.useMemo(()=>Number.parseFloat(h&&(a==null?void 0:a.expectedOutput)||t),[t,h,a==null?void 0:a.expectedOutput]),u=s.useMemo(()=>new fe({value:w,decimal:r.decimal}),[w,r.decimal]),m=Ft({address:b,identifier:`${r.chain}.${r.ticker}`}),y=s.useMemo(()=>{var D;const P=(D=c.split(" -> "))==null?void 0:D.map(B=>{var I;return(I=B.split("-"))==null?void 0:I[0]});return`${P[0]} \u2192 ${P[P.length-1]}`},[c]),T=s.useMemo(()=>S(l*w),[w,S,l]);return e.jsxs(fn,{className:"!px-3 !py-1.5 !gap-0",isFocused:g,onClick:n,children:[e.jsxs(f,{justify:"between",children:[e.jsxs(f,{alignCenter:!0,className:"py-2",children:[e.jsx(ea,{providers:o.toReversed()}),i&&e.jsx(Na,{iconName:"approved",size:18,tooltip:x("views.swap.routeContractApproved")})]}),e.jsx(f,{align:"end",justify:"between",children:e.jsx(f,{center:!0,className:"gap-x-1.5",children:e.jsxs(f,{col:!0,children:[e.jsxs(f,{className:"gap-x-1",justify:"end",children:[e.jsx(p,{fontWeight:"bold",children:u.toSignificant(6)}),e.jsx(p,{children:r.ticker}),e.jsx(be,{asset:r,hasChainIcon:!1,logoURI:m,size:18})]}),e.jsxs(f,{alignCenter:!0,className:"gap-x-1",justify:"end",children:[e.jsx(Kt,{fees:d,size:"sm"}),e.jsx(p,{className:"text-right",variant:"secondary",children:T})]})]})})})]}),e.jsxs(f,{className:"pl-1 pt-0.5",justify:"between",children:[e.jsx(p,{className:"!text-[9px]",textStyle:"caption-xs",variant:"secondary",children:y}),e.jsx(Zt,{streamSwap:typeof h=="boolean"?h:!!a,timeEstimates:v})]})]})}),cs=s.memo(({setSwapRoute:t,selectedRoute:a,outputUnitPrice:n,outputAsset:i,routes:r,streamSwap:l})=>a?e.jsx(f,{className:"self-stretch transition-max-height duration-300",children:e.jsx(Ta,{className:"flex-1 self-stretch !bg-light-bg-primary dark:!bg-dark-gray-light !rounded-2xl flex-col overflow-hidden",shadow:!1,title:e.jsx(os,{...a,providers:a.providers.toReversed(),assetTicker:i.ticker,outputAssetDecimal:i.decimal||8,streamSwap:l,unitPrice:n}),titleClassName:"!pl-0 pr-1 !pt-0",children:e.jsx(f,{col:!0,className:"gap-1 pt-2",children:r.map(c=>s.createElement(ls,{...c,key:`${c.path}-${c.providers.join(",")}`,onClick:()=>t(c),outputAsset:i,selected:c===a,streamSwap:!!c.streamingSwap,unitPrice:n}))})})}):null),us=s.memo(({totalFee:t,fees:a,isOpened:n,onClose:i})=>{const r=Je(2,""),l=s.useMemo(()=>{if(!a)return[];const{affiliateFee:c,...o}=Object.entries(a).reduce((g,d)=>{const[h,v]=d;if(v){for(const S of v)g.affiliateFee+=S.affiliateFeeUSD;g[h]=v}return g},{affiliateFee:0});return[...Object.entries(o).reduce((g,[d,h])=>h?[...h.map(({type:v,networkFee:S,networkFeeUSD:b,asset:w})=>{const u=de.fromChainOrSignature(d),m=de.fromStringSync(w);return{label:e.jsxs(f,{center:!0,className:"gap-x-1",children:[e.jsxs(p,{textStyle:"caption",children:[`${x("common.network")} `,v?x(`common.${v}`):""]}),e.jsx(be,{asset:u,size:20})]}),value:e.jsxs(f,{center:!0,className:"gap-x-1",children:[m&&e.jsxs(e.Fragment,{children:[e.jsx(p,{textStyle:"caption-xs",variant:"secondary",children:"("}),e.jsx(be,{asset:m,size:14}),e.jsxs(p,{textStyle:"caption-xs",variant:"secondary",children:[r(S),")"]})]}),e.jsx(p,{children:r(b)})]})}}),...g]:g,[]),{label:e.jsxs(f,{center:!0,className:"gap-x-1",children:[e.jsx(p,{textStyle:"caption",children:x("views.swap.exchangeFee")}),e.jsx(be,{asset:de.fromChainOrSignature("ETH.THOR"),hasChainIcon:!1,size:20})]}),value:c>0?r(c):e.jsx(p,{variant:"green",children:"FREE"})},{label:e.jsx(f,{center:!0,children:e.jsx(p,{textStyle:"caption",children:x("views.wallet.totalFee")})}),value:e.jsx(p,{children:t})}]},[a,r,t]);return s.useEffect(()=>{!a&&n&&i()},[a,n,i]),a?e.jsx(Mt,{isOpened:n,onClose:i,title:x("views.swap.feeExplanation"),children:e.jsx(f,{className:"w-80",flex:1,children:e.jsx(Va,{items:l})})}):null}),ds=({inputAsset:t})=>e.jsxs(e.Fragment,{children:[e.jsxs(p,{textStyle:"caption",variant:"yellow",children:["Are you looking for native token ",e.jsx(_t,{className:"text-twitter-blue",to:ot(t,Sn),children:"$RUNE?"})]}),e.jsx(p,{textStyle:"caption-xs",children:"\xA0"}),e.jsx(p,{textStyle:"caption",variant:"yellow",children:"You have selected $RUNE token ticker on Ethereum chain. RUNE token on Ethereum chain is a deprecated token. Please make sure you are swapping the correct token."})]}),St=6,ps=5,$e=15,Oe=10,aa=.5,ms=({route:t,outputAsset:a,outputAmount:n,slippagePercent:i,setSlippagePercent:r})=>{var w;const[l,c]=s.useState(0),[o,g]=s.useState(!1),[d,h]=s.useState(!1),v=s.useMemo(()=>{var B;const u=new fe({value:((B=t==null?void 0:t.streamingSwap)==null?void 0:B.expectedOutput)||0,decimal:a.decimal});if(u.lte(0))return 100;const m=n.div(u),y=$e+Oe*St,T=m.getValue("number")*100,P=100-Number(T),D=hs(y,P);return T<100?D:100},[n,a.decimal,(w=t==null?void 0:t.streamingSwap)==null?void 0:w.expectedOutput]);s.useEffect(()=>{const u=$e+(Oe-i)*St;c(i>0?u:0)},[i]);const S=i>0?"brand.btnPrimary":"brand.orange",b=s.useCallback(u=>{if(u[0]<$e/2){r(0);return}const m=Oe-(u[0]-$e)/St;if(m<=aa){r(aa);return}if(m>=Oe){r(Oe);return}r(Math.min(m,Oe))},[r]);return e.jsxs(N,{animateOpacity:!0,in:!0,as:wn,w:"100%",children:[e.jsxs(N,{children:[e.jsx(p,{color:"textSecondary",fontWeight:"semibold",ml:2,textStyle:"caption",children:x("common.slippageSettings")}),e.jsx(ve,{content:x("common.slippageTooltip"),place:"bottom",children:e.jsx(oe,{className:"ml-1",color:"secondary",name:"infoCircle",size:18})})]}),e.jsx(N,{flex:1,gap:1,onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),px:3,py:2,children:e.jsx(N,{direction:"column",w:"100%",children:e.jsx(N,{gap:2.5,children:e.jsxs(Yt,{onChange:u=>b(u),onChangeEnd:()=>h(!1),onChangeStart:()=>h(!0),size:"lg",step:3,value:[l,v],children:[e.jsx(Qt,{bg:"textSecondary",boxSize:2,children:e.jsx(Xt,{bg:S,boxSize:2,width:"50%"})}),e.jsx(Pa,{hasArrow:!0,bg:"bgPrimary",isOpen:o||d,label:e.jsx(Ha,{p:1,children:i===0?e.jsx(p,{color:"brand.orange",textStyle:"caption-xs",children:x("views.swap.noPriceProtection")}):e.jsxs(N,{children:[e.jsx(p,{textStyle:"caption-xs",variant:"secondary",children:"Slippage: \xA0"}),e.jsxs(p,{color:i===10?"brand.yellow":"textPrimary",textStyle:"caption-xs",children:[i,"%"]})]})}),placement:"top",children:e.jsx(xt,{boxSize:4,index:0})}),e.jsx(xt,{bgColor:S,boxSize:3,index:1,sx:{pointerEvents:"none"}}),e.jsx(N,{onClick:()=>r(0),sx:{w:4,h:4,borderRadius:"50%",bg:"textSecondary",position:"absolute",top:"50%",transform:"translateY(-50%)",left:"-8px"}}),e.jsx(N,{onClick:()=>r(1),sx:{w:4,h:4,borderRadius:"50%",bg:i>0?"textSecondary":S,position:"absolute",top:"50%",transform:"translateY(-50%)",left:`calc(${$e}% - 7px)`}})]})})})})]})};function hs(t,a){let n=ps,i=100-a*n;for(;n>0&&t>i;)n-=1,i=100-a*n;return i}const xs=({route:t,onSettingsChange:a,setIsChainflipBoostEnable:n,outputAmount:i,outputAsset:r,minReceive:l,defaultInterval:c,canStreamSwap:o,streamingSwapParams:g,streamSwap:d,isChainflip:h,isChainflipBoostEnable:v=!1,noSlipProtection:S})=>{var R,Z,A;const{isActive:b,contentRef:w,toggle:u,maxHeightStyle:m}=vn({}),{slippageTolerance:y,setSlippage:T}=Pe(),P=((R=t==null?void 0:t.streamingSwap)==null?void 0:R.maxQuantity)||0,D=((Z=t==null?void 0:t.streamingSwap)==null?void 0:Z.maxIntervalForMaxQuantity)||10,B=s.useMemo(()=>sa({maxQuantity:P}),[P]),I=s.useMemo(()=>sa({minQuantity:c,maxQuantity:D,maxSteps:5}),[c,D]),[k,z]=s.useState(50),[H,L]=s.useState(!1),[ee,X]=s.useState(!1),pe=Jt({streamingSwapParams:g,timeEstimates:t==null?void 0:t.timeEstimates,streamSwap:d,useMaxTime:k===100}),ue=((A=t==null?void 0:t.meta)==null?void 0:A.recommendedSlippage)||0,ie=s.useMemo(()=>{const _=B.map((G,K)=>({label:null,subswaps:G,interval:c,value:Math.floor(50/B.length*(K+1))}));_.unshift({label:"Streaming swap turned off",subswaps:0,interval:0,value:0});const M=I.map((G,K)=>({label:null,subswaps:P,interval:G,value:Math.floor(50+50/I.length*(K+1))}));return[..._,...M]},[I,B,c,P]),F=ie.map(_=>_.value),O=s.useMemo(()=>ie.find(_=>k===_.value),[ie,k]),ne=s.useCallback(_=>{T(_)},[T]),W=s.useCallback(_=>{n==null||n(_)},[n]),Se=_=>{const M=F.reduce((G,K)=>Math.abs(K-_)<Math.abs(G-_)?K:G,0);z(M)};return s.useEffect(()=>{z(50)},[o,t==null?void 0:t.path]),s.useEffect(()=>{O&&(a==null||a({interval:O.interval,subswaps:O.subswaps}))},[a,O]),e.jsx(N,{w:"100%",children:e.jsxs(bn,{gap:1,p:3,sx:{w:"full",borderRadius:16},variant:"filledContainerTertiary",children:[e.jsxs(N,{className:"justify-between",ml:2,mt:1,onClick:u,sx:{cursor:"pointer"},children:[e.jsxs(N,{alignItems:"center",direction:"row",gap:2,children:[e.jsx(oe,{color:"secondary",name:"settings",size:18}),e.jsx(p,{color:"textSecondary",fontWeight:"semibold",textStyle:"caption",children:x("views.swap.swapSettings")})]}),e.jsxs(N,{alignItems:"center",gap:1,children:[S&&!h?e.jsx(p,{color:"textSecondary",fontWeight:"semibold",ml:2,textStyle:"caption",children:x("views.swap.noPriceProtection")}):e.jsx(e.Fragment,{children:h?e.jsxs(N,{alignItems:"center",direction:"row",children:[e.jsx(oe,{name:"chainflipBoost"}),e.jsx(p,{color:"textSecondary",fontWeight:"semibold",textStyle:"caption",children:"Boost Available"}),e.jsx(ve,{content:x("views.swap.chainflipBoost"),place:"bottom",children:e.jsx(_t,{to:yn,children:e.jsx(oe,{className:"ml-1",color:"secondary",name:"infoCircle",size:18})})})]}):e.jsx(p,{color:"textSecondary",fontWeight:"semibold",ml:2,textStyle:"caption",children:`${y}% Price Protection`})}),e.jsx(oe,{className:ke("transform duration-300 ease -mr-2",{"-rotate-180":b}),color:"secondary",name:"chevronDown"})]})]}),e.jsx("div",{className:ke("w-full",jn),style:m,children:e.jsx(N,{direction:"column",ref:w,children:e.jsxs(N,{direction:"column",mt:2,children:[o&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{pb:1,children:[e.jsx(p,{color:"textSecondary",fontWeight:"semibold",ml:2,textStyle:"caption",children:x("views.swap.streamingSettings")}),e.jsx(ve,{content:x("views.swap.priceOptimizationInfo"),onClick:()=>An(kn),place:"bottom",children:e.jsx(oe,{className:"ml-1",color:"secondary",name:"infoCircle",size:18})})]}),e.jsx(N,{flex:1,gap:1,mt:1,onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1),children:e.jsxs(N,{direction:"column",w:"100%",children:[e.jsx(N,{gap:2.5,mx:4,children:e.jsxs(pi,{onChange:_=>Se(_),onChangeEnd:()=>X(!1),onChangeStart:()=>X(!0),size:"lg",value:k,children:[e.jsx(mi,{bg:"textSecondary",boxSize:2,children:e.jsx(hi,{bg:k>50?"brand.yellow":"brand.btnSecondary",boxSize:2,width:"50%"})}),e.jsx(Pa,{hasArrow:!0,bg:"bgPrimary",isOpen:H||ee,label:e.jsx(Ha,{p:1,children:O!=null&&O.label?e.jsx(p,{textStyle:"caption-xs",children:O==null?void 0:O.label}):e.jsxs(e.Fragment,{children:[e.jsxs(N,{children:[e.jsx(p,{textStyle:"caption-xs",variant:"secondary",children:"Number of subswaps: \xA0"}),e.jsx(p,{textStyle:"caption-xs",children:O==null?void 0:O.subswaps})]}),e.jsxs(N,{children:[e.jsx(p,{textStyle:"caption-xs",variant:"secondary",children:"Interval: \xA0"}),e.jsxs(p,{textStyle:"caption-xs",children:[O==null?void 0:O.interval," blocks"]})]})]})}),placement:"top",children:e.jsx(xi,{boxSize:4})}),e.jsx(N,{sx:{w:3,h:3,borderRadius:"50%",bg:k>50?"brand.yellow":"brand.btnSecondary",position:"absolute",top:"50%",transform:"translateY(-50%)",left:"-8px"}}),e.jsx(N,{sx:{w:4,h:4,borderRadius:"50%",bg:k>50?"brand.yellow":"textSecondary",position:"absolute",top:"50%",transform:"translateY(-50%)",left:"calc(50% - 7px)"}}),e.jsx(N,{sx:{w:3,h:3,borderRadius:"50%",backgroundColor:"textSecondary",position:"absolute",top:"50%",transform:"translateY(-50%)",right:"-8px"}})]})}),e.jsxs(N,{flex:1,justify:"space-between",mt:1,children:[e.jsx(N,{children:e.jsx(je,{onClick:()=>Se(0),size:"xs",sx:{px:2},variant:"borderlessPrimary",children:x("views.swap.fastest")})}),e.jsx(N,{children:e.jsx(je,{onClick:()=>Se(50),size:"xs",variant:"borderlessPrimary",children:x("views.swap.optimal")})}),e.jsx(N,{children:e.jsx(je,{onClick:()=>Se(100),size:"xs",sx:{px:2},variant:"borderlessPrimary",children:x("views.swap.slowest")})})]})]})})]}),h||S?e.jsxs(N,{direction:"column",children:[e.jsxs(N,{flex:1,flexWrap:"wrap",mb:2,ml:2,children:[e.jsx(p,{color:"textSecondary",fontWeight:"semibold",textStyle:"caption",children:h?x("common.slippageSettingsChainflip"):x("views.swap.noPriceProtection")}),e.jsx(ve,{content:h?x("common.slippageTooltipChainflip"):x("views.swap.noPriceProtectionTooltip"),place:"bottom",children:e.jsx(oe,{className:"ml-1",color:"secondary",name:"infoCircle",size:18})})]}),h&&e.jsxs(N,{justifyContent:"space-between",className:"gap-x-2 w-full rounded-2xl",mb:2,px:2,children:[e.jsxs(N,{alignItems:"center",direction:"row",children:[e.jsx(oe,{name:"chainflipBoost"}),e.jsx(p,{color:"textSecondary",fontWeight:"semibold",textStyle:"caption",children:"Activate Boost"})]}),e.jsx(Cn,{size:"md",checked:v,onChange:W,variant:"secondary"})]})]}):e.jsx(ms,{outputAmount:i,outputAsset:r,route:t,setSlippagePercent:ne,slippagePercent:y}),e.jsxs(N,{flex:1,flexWrap:"wrap",ml:2,children:[e.jsxs(N,{direction:"column",flex:1,children:[e.jsx(p,{color:"textSecondary",fontWeight:"semibold",textStyle:"caption-xs",children:"Receive at least:"}),e.jsx(p,{color:y===0||S&&!h||ue>0&&ue<y?"brand.yellow":"textPrimary",textStyle:"caption-xs",children:y===0||S&&!h?x("views.swap.noProtection"):`${l.toCurrency("")} ${(r==null?void 0:r.ticker)||""}`})]}),e.jsxs(N,{flex:1,flexDirection:"column",children:[e.jsx(p,{color:"textSecondary",fontWeight:"semibold",textStyle:"caption-xs",children:"Estimated:"}),e.jsx(N,{children:e.jsxs(p,{color:k<50?"brand.yellow":k>50?"brand.green":"textPrimary",textStyle:"caption-xs",children:[i.toCurrency("")," ",(r==null?void 0:r.ticker)||""]})})]}),e.jsxs(N,{flex:1,flexDirection:"column",children:[e.jsx(p,{color:"textSecondary",fontWeight:"semibold",textStyle:"caption-xs",children:"Time:"}),e.jsx(N,{children:e.jsx(p,{color:k>50?"brand.yellow":"textPrimary",textStyle:"caption-xs",children:pe?Ca(pe):"n/a"})})]})]}),k>50&&y>0&&e.jsxs(f,{row:!0,className:"w-full my-3 px-2",children:[e.jsx(oe,{color:"yellow",name:"infoCircle",size:26})," ",e.jsx(p,{className:"ml-2",color:"brand.yellow",fontWeight:"medium",textStyle:"caption",children:x("views.swap.slippageMarketRateWarning")})]})]})})})]})})};function sa({minQuantity:t=0,maxQuantity:a,maxSteps:n=5}){const i=Math.min(a-t,n),r=Math.floor((a-t)/i),l=Array.from({length:i-1},(c,o)=>o*r+(t?r:1));return l.push(a),l}const gs=({inputAsset:t})=>e.jsxs(e.Fragment,{children:[e.jsxs(p,{textStyle:"caption",variant:"yellow",children:["Are you looking for THORSwap's protocol token ",e.jsx(_t,{className:"text-twitter-blue",to:ot(t,de.fromChainOrSignature("ETH.THOR")),children:"$THOR (Ethereum ERC-20)?"})]}),e.jsx(p,{textStyle:"caption-xs",children:"\xA0"}),e.jsx(p,{textStyle:"caption",variant:"yellow",children:"You have selected $THOR token ticker on Avalanche C-Chain. Thor Financial is a different unaffiliated project based on the Avalanche network. "})]}),fs=({selectedRoute:t,noPriceProtection:a,inputAmount:n,outputAsset:i,isChainflip:r,noSlipProtection:l})=>{var k,z,H,L,ee,X,pe,ue,ie;const c=s.useMemo(()=>{var F;return(F=t==null?void 0:t.calldata)!=null&&F.memo?t.calldata.memo.split(":").length>=8:!1},[(k=t==null?void 0:t.calldata)==null?void 0:k.memo]),[o,g]=s.useState(!1),[d,h]=s.useState(null),v=((z=t==null?void 0:t.streamingSwap)==null?void 0:z.maxQuantity)&&((H=t==null?void 0:t.streamingSwap)==null?void 0:H.maxIntervalForMaxQuantity),S=((L=t==null?void 0:t.calldata)==null?void 0:L.memoStreamingSwap)||((ee=t==null?void 0:t.streamingSwap)==null?void 0:ee.memo)||"",{setSlippage:b,slippageTolerance:w}=Pe(),u=s.useMemo(()=>!a&&!!S,[S,a]),m=s.useCallback(F=>g(F&&!!u),[u]),y=s.useMemo(()=>{const F=Ss(S,3);return F&&Number(F.split("/")[1])||3},[S]),T=s.useMemo(()=>{var R,Z,A,_;const F=new fe({value:((R=t==null?void 0:t.streamingSwap)==null?void 0:R.expectedOutput)||0,decimal:i.decimal});if(!d)return F;if(d.subswaps===0||!o)return new fe({value:0,decimal:i.decimal});const O=(Z=t==null?void 0:t.streamingSwap)!=null&&Z.maxQuantity?d.subswaps/((A=t==null?void 0:t.streamingSwap)==null?void 0:A.maxQuantity):1,ne=new fe({value:((_=t==null?void 0:t.streamingSwap)==null?void 0:_.savingsInAsset)||0,decimal:i.decimal}),W=ne.mul(O),Se=ne.sub(W);return F.sub(Se)},[i.decimal,(X=t==null?void 0:t.streamingSwap)==null?void 0:X.expectedOutput,(pe=t==null?void 0:t.streamingSwap)==null?void 0:pe.maxQuantity,(ue=t==null?void 0:t.streamingSwap)==null?void 0:ue.savingsInAsset,o,d]),P=s.useMemo(()=>{const F=new fe({value:(t==null?void 0:t.expectedOutput)||0,decimal:i.decimal});return!t||n.getValue("number")===0?new fe({value:0,decimal:i.decimal}):o&&T.gt(0)?T:F},[t,i.decimal,n,o,T]),D=s.useMemo(()=>P.mul(1-(r?5:w)/100),[P,w,r]),B=s.useMemo(()=>{var F;return o&&((F=t==null?void 0:t.streamingSwap)!=null&&F.fees)?t!=null&&t.fees?{...t.fees,...t.streamingSwap.fees}:t.streamingSwap.fees:t==null?void 0:t.fees},[t==null?void 0:t.fees,(ie=t==null?void 0:t.streamingSwap)==null?void 0:ie.fees,o]);s.useEffect(()=>{d&&m(!!d.subswaps)},[d,m]);const I=s.useMemo(()=>{if(!t||c)return t;const F=w?fe.shiftDecimals({value:D,from:i.decimal||lt.THOR,to:lt.THOR}).getValue("bigint").toString():"0",O=na(S,{minAmount:F,interval:d==null?void 0:d.interval,subswaps:d==null?void 0:d.subswaps}),ne=na(S||t.memo,{minAmount:l?"":F}),W=o?{...t==null?void 0:t.calldata,memoStreamingSwap:O}:{...t==null?void 0:t.calldata,memo:ne};return{...t,memo:ne,calldata:W}},[t,c,w,D,i.decimal,S,d==null?void 0:d.interval,d==null?void 0:d.subswaps,l,o]);return{streamSwap:o,toggleStreamSwap:m,canStreamSwap:u,minReceive:D,outputAmount:P,fees:B,streamingSwapParams:d,setStreamingSwapParams:h,route:I,hasStreamingSettings:v,slippagePercent:w,setSlippagePercent:b,defaultInterval:y}};function na(t,{minAmount:a,interval:n,subswaps:i}){const r=t==null?void 0:t.split(":"),l=3;if(!r||(r==null?void 0:r.length)<l+1)return t;const c=r[l].includes("/"),o=r[l];if(c){const g=a||o.split("/")[0],d=n||o.split("/")[1],h=i||o.split("/")[2];r[l]=`${g||"0"}/${d||"0"}/${h||"0"}`}else r[l]=a||"0";return r.join(":")}function Ss(t,a){return t&&a?t.split(":")[a]:null}const ws=({children:t,condition:a})=>we&&a?e.jsx(ve,{className:"mb-5",content:x("components.assetSelect.ledgerLiveSwitchNotSupported"),children:t}):t,vs=({inputAsset:t,outputAsset:a,onInputAssetChange:n,onOutputAssetChange:i,onInputAmountChange:r,onSwitchPair:l,tokens:c,tradingPairs:o})=>{var D,B,I;const[g,d]=s.useState(!1),h=Si("tokens"),v=s.useMemo(()=>Oa(a.asset),[a]),S=s.useCallback(()=>{l(),d(k=>!k)},[l]),b=za(c),w=za((o==null?void 0:o.tokens)||c),{assetInputProps:u,assets:m}=La(b),{assetInputProps:y,assets:T}=La(w),P=s.useMemo(()=>!(h!=null&&h.length)||t.asset.chain===J.Ethereum&&a.asset.chain===J.Ethereum||t.asset.chain===J.Avalanche&&a.asset.chain===J.Avalanche||t.asset.chain===J.BinanceSmartChain&&a.asset.chain===J.BinanceSmartChain||t.asset.isGasAsset?T:T.filter(({asset:k})=>{var z;return ct(k)||Ut(k)||Nn(k)||![J.Ethereum,J.Avalanche,J.BinanceSmartChain].includes(k==null?void 0:k.chain)||h.includes((z=k.symbol.split("-")[1])==null?void 0:z.toLowerCase())}),[T,(D=t.asset)==null?void 0:D.chain,(B=t.asset)==null?void 0:B.isGasAsset,(I=a.asset)==null?void 0:I.chain,h]);return e.jsxs("div",{className:"relative self-stretch md:w-full",children:[e.jsx(f,{center:!0,className:ke("absolute mt-2.5 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"),children:e.jsx(ws,{condition:!v,children:e.jsx(f,{center:!0,className:ke(v?"cursor-pointer hover:brightness-125":"cursor-not-allowed brightness-75 hover:brightness-100","absolute -mt-0.5 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","p-1 md:p-2 rounded-xl md:rounded-[18px]","border-10 border-solid bg-blue dark:border-dark-border-primary border-transparent transition"),onClick:v?S:void 0,children:e.jsx(oe,{className:ke("p-1 transition-all",{"-scale-x-100":g}),color:"white",name:"arrowDown",size:20})})})}),e.jsx(Ba,{...u,hideZeroPrice:!0,assets:m.filter(k=>Oa(k.asset)),className:"!mb-1 flex-1 h-[100px]",onAssetChange:n,onValueChange:r,selectedAsset:t}),e.jsx(Ba,{...y,hideMaxButton:!0,hideZeroPrice:!0,assets:we?P.filter(k=>Tn(k.asset)):P,className:"h-[90px]",onAssetChange:i,selectedAsset:a})]})},bs=s.memo(vs);var ia=typeof window<"u"?s.useLayoutEffect:s.useEffect;function ra(t,a,n,i){const r=s.useRef(a);ia(()=>{r.current=a},[a]),s.useEffect(()=>{const l=(n==null?void 0:n.current)??window;if(!(l&&l.addEventListener))return;const c=o=>{r.current(o)};return l.addEventListener(t,c,i),()=>{l.removeEventListener(t,c,i)}},[t,n,i])}function oa(t){const a=s.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return ia(()=>{a.current=t},[t]),s.useCallback((...n)=>{var i;return(i=a.current)==null?void 0:i.call(a,...n)},[a])}var wt=typeof window>"u";function ys(t,a,n={}){const{initializeWithValue:i=!0}=n,r=s.useCallback(S=>n.serializer?n.serializer(S):JSON.stringify(S),[n]),l=s.useCallback(S=>{if(n.deserializer)return n.deserializer(S);if(S==="undefined")return;const b=a instanceof Function?a():a;let w;try{w=JSON.parse(S)}catch(u){return console.error("Error parsing JSON:",u),b}return w},[n,a]),c=s.useCallback(()=>{const S=a instanceof Function?a():a;if(wt)return S;try{const b=window.localStorage.getItem(t);return b?l(b):S}catch(b){return console.warn(`Error reading localStorage key \u201C${t}\u201D:`,b),S}},[a,t,l]),[o,g]=s.useState(()=>i?c():a instanceof Function?a():a),d=oa(S=>{wt&&console.warn(`Tried setting localStorage key \u201C${t}\u201D even though environment is not a client`);try{const b=S instanceof Function?S(c()):S;window.localStorage.setItem(t,r(b)),g(b),window.dispatchEvent(new StorageEvent("local-storage",{key:t}))}catch(b){console.warn(`Error setting localStorage key \u201C${t}\u201D:`,b)}}),h=oa(()=>{wt&&console.warn(`Tried removing localStorage key \u201C${t}\u201D even though environment is not a client`);const S=a instanceof Function?a():a;window.localStorage.removeItem(t),g(S),window.dispatchEvent(new StorageEvent("local-storage",{key:t}))});s.useEffect(()=>{g(c())},[t]);const v=s.useCallback(S=>{S.key&&S.key!==t||g(c())},[t,c]);return ra("storage",v),ra("local-storage",v),[o,d,h]}const js=({onConfirmChange:t})=>{const[a,n]=ys("chainflipSlippageConfirmed",!1);return s.useEffect(()=>{t(a)},[a,t]),e.jsx(Ma,{className:"pt-4 pb-2",label:e.jsx(f,{alignCenter:!0,children:e.jsx(p,{textStyle:"caption-xs",children:x("views.swap.chainflipSlippageWarning")})}),onValueChange:n,value:a})},As=s.memo(({setConfirmedSlippage:t,slipHigherThanTolerance:a,confirmedSlippage:n,inputAsset:i,outputAsset:r,recipient:l,estimatedTime:c,slippagePercent:o,minReceive:g,totalFee:d,streamSwap:h,affiliateFee:v,feeAssets:S,swapMemo:b,isChainflip:w})=>{var m,y;const u=s.useMemo(()=>Pn(On(b)),[b]);return e.jsxs(e.Fragment,{children:[h&&e.jsx(N,{_groupHover:{bgColor:"transparent"},align:"center",bgColor:"brand.btnSecondary",borderRadius:"xl",h:4,justify:"center",position:"absolute",px:4,right:-3,top:8,transform:"rotate(48deg)",w:24,children:e.jsx(p,{_groupHover:{color:"white"},fontSize:"12px",fontWeight:500,lineHeight:"16px",children:"Beta"})}),e.jsxs(f,{col:!0,children:[e.jsxs(f,{alignCenter:!0,row:!0,justify:"between",children:[e.jsxs(f,{center:!0,col:!0,className:"flex-1 p-4 rounded-2xl",children:[e.jsx(be,{asset:i.asset}),e.jsx(f,{center:!0,className:"pt-2",children:e.jsx(Ya,{asset:i.asset})}),e.jsx(f,{center:!0,className:"w-full",children:e.jsxs(p,{fontWeight:"medium",textStyle:"caption",children:[(m=i.value)==null?void 0:m.toSignificant(6)," ",i.asset.ticker]})})]}),e.jsx(oe,{className:"mx-2 -rotate-90",name:"arrowDown"}),e.jsxs(f,{center:!0,col:!0,className:"flex-1 p-4 rounded-2xl",children:[e.jsx(be,{asset:r.asset}),e.jsx(f,{center:!0,className:"pt-2",children:e.jsx(Ya,{asset:r.asset})}),e.jsx(f,{center:!0,className:"w-full",children:e.jsxs(p,{fontWeight:"medium",textStyle:"caption",children:[(y=r.value)==null?void 0:y.toSignificant(6)," ",r.asset.ticker]})})]})]}),e.jsxs(f,{col:!0,className:"w-full py-4 border border-solid rounded-2xl border-light-border-primary dark:border-dark-border-primary",children:[e.jsxs(f,{row:!0,className:"w-full",children:[e.jsxs(f,{center:!0,col:!0,className:"flex-1 gap-y-2",children:[e.jsx(p,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:x("common.estimateTime")}),e.jsx(p,{textStyle:"caption",children:c})]}),e.jsxs(f,{center:!0,col:!0,className:"flex-1 gap-y-2",children:[e.jsx(p,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:x("common.fee")}),e.jsx(p,{textStyle:"caption",children:d})]}),e.jsxs(f,{center:!0,col:!0,className:"flex-1 gap-y-2",children:[e.jsx(p,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:x("common.maxSlippage")}),e.jsxs(p,{color:a?"red":"",textStyle:"caption",children:[(Math.round(o*100)/100).toFixed(2),"%"]})]})]}),e.jsx(f,{className:"px-4",children:e.jsx(f,{className:"w-full h-[1px] bg-light-border-primary dark:bg-dark-border-primary my-2"})}),e.jsxs(f,{row:!0,className:"w-full py-2",children:[e.jsxs(f,{center:!0,col:!0,className:"flex-1 gap-y-2",children:[e.jsx(p,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:x("views.swap.exchangeFee")}),e.jsx(p,{className:ke({"line-through":v==="$0.00"}),textStyle:"caption",children:v==="$0.00"||v==="0"?"FREE":v})]}),e.jsxs(f,{center:!0,col:!0,className:"flex-1 gap-y-2",children:[e.jsx(p,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:x("common.recipient")}),e.jsx(p,{textStyle:"caption",children:Dt(l)})]}),e.jsxs(f,{center:!0,col:!0,className:"flex-1 gap-y-2",children:[e.jsx(p,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:x("views.swap.txAssetsFee")}),e.jsx(p,{textStyle:"caption",children:S})]})]}),(b==null?void 0:b.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"px-4",children:e.jsx(f,{className:"w-full h-[1px] bg-light-border-primary dark:bg-dark-border-primary my-2"})}),e.jsx(f,{row:!0,className:"w-full",children:e.jsxs(f,{center:!0,col:!0,className:"flex-1 gap-y-2 px-4 w-[100%]",children:[e.jsx(p,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:x("common.memo")}),e.jsx(ve,{content:b,children:e.jsx(p,{maxWidth:"full",textStyle:"caption",children:Dt(b,20)})})]})}),e.jsx(f,{className:"px-4",children:e.jsx(f,{className:"w-full h-[1px] bg-light-border-primary dark:bg-dark-border-primary my-2"})}),e.jsx(f,{row:!0,className:"w-full",children:e.jsxs(f,{center:!0,col:!0,className:"flex-1 gap-y-2 px-4 w-[100%]",children:[e.jsx(p,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:x("common.memoHex")}),e.jsx(ve,{content:u,children:e.jsx(p,{maxWidth:"100%",textStyle:"caption",children:Dt(u,20)})})]})})]}),!h&&e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"px-4",children:e.jsx(f,{className:"w-full h-[1px] bg-light-border-primary dark:bg-dark-border-primary my-2"})}),e.jsx(f,{row:!0,className:"w-full",children:e.jsxs(f,{center:!0,col:!0,className:"flex-1 gap-y-2",children:[e.jsx(p,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:x("common.minReceived")}),o===0?e.jsx(p,{color:"brand.yellow",textStyle:"caption",children:x("views.swap.noProtection")}):e.jsx(p,{textStyle:"caption",children:g})]})})]})]}),a&&!w&&e.jsx(Ma,{className:"pt-4 pb-2",label:e.jsx(f,{alignCenter:!0,children:e.jsx(p,{children:x("views.swap.slippageConfirmationWarning")})}),onValueChange:t,value:n}),w&&e.jsx(js,{onConfirmChange:t})]})]})}),Cs=s.memo(({affiliateFee:t,estimatedTime:a,feeAssets:n,handleSwap:i,inputAssetProps:r,minReceive:l,outputAssetProps:c,recipient:o,setVisible:g,slippagePercent:d,totalFee:h,visible:v,streamSwap:S,selectedRoute:b,isChainflip:w})=>{const[u]=Mn(),{getWalletAddress:m}=Xe(),[y,T]=s.useState(!0),P=Vt(({app:F})=>F.slippageTolerance),D=s.useMemo(()=>d>P,[d,P]),[B,I]=s.useState(!1),{asset:k}=r,{asset:z}=c,[H,L]=s.useState(!1);s.useEffect(()=>{v||L(!1)},[v]);const ee=s.useMemo(()=>m(k.chain),[m,k.chain]),X=s.useMemo(()=>[ee,o],[ee,o]),pe=s.useMemo(()=>{if(!b)return"";const{memoStreamingSwap:F,memo:O,tcMemo:ne}=b.calldata;return(S&&F?F:O||ne)||""},[b,S]),ue=s.useCallback(async()=>{L(!0);const{data:F}=await u({addresses:X,chains:[k.chain,z.chain]}),{list:O}=await ut(()=>import("./DzP8eMH-.js"),__vite__mapDeps([0,1,2]));F!=null&&F.confirm&&!X.some(ne=>O.includes(ne))?(g(!1),i()):T(!1)},[g,i,X,u,k.chain,z.chain]),ie=s.useMemo(()=>{const F=a&&typeof a=="object"&&"total"in a?a.total:a;return F?F<60?`<${F}s`:`<${Math.ceil(F/60)}m`:"<5s"},[a]);return e.jsx(wi,{buttonDisabled:!y||D&&!B||H,inputAssets:[k],isOpened:v,onClose:()=>g(!1),onConfirm:ue,children:e.jsx(As,{affiliateFee:t,confirmedSlippage:B,estimatedTime:ie,feeAssets:n,inputAsset:r,isChainflip:w,minReceive:l,outputAsset:c,recipient:o,setConfirmedSlippage:I,slipHigherThanTolerance:D,slippagePercent:d,streamSwap:S,swapMemo:pe,totalFee:h})})}),ks=s.memo(({className:t,size:a=24,duration:n=10,refresh:i})=>{const{themeType:r}=Pe(),{refetch:l}=It(),c=s.useRef(!1),o=s.useRef(setTimeout(()=>{},0)),g=r===En.Light,d=g?"#E6E9F5":"#273855",h=g?"#7C859F":"#75849D",v=a/2,S=a*Math.PI,[b,w]=s.useState(n),u=S-b*1e3/(n*1e3)*S,m=s.useCallback(()=>{c.current||(c.current=!0,clearInterval(o.current),o.current=setInterval(()=>{w(D=>D>1?D-1:(i==null||i(),l(),n))},1e3))},[n,i,l]),y=s.useCallback(()=>{i==null||i(),l(),w(n)},[n,i,l]);s.useEffect(()=>{w(n),c.current=!i,i?m():clearInterval(o.current)},[m,n,i]);const T=s.useMemo(()=>({height:a,width:a}),[a]),P="left-1.5 top-1.5 absolute w-full h-full overflow-visible";return e.jsx(ve,{content:x("common.refresh"),place:"top",children:e.jsxs(f,{center:!0,className:ke("m-auto relative -rotate-90 box-content",In,t),onClick:y,style:T,children:[e.jsx(p,{className:"rotate-90",textStyle:"caption-xs",children:b.toFixed()}),e.jsx("svg",{className:P,children:e.jsx("circle",{cx:v,cy:v,fill:"none",r:v,stroke:d,strokeWidth:2})}),e.jsx("svg",{className:P,children:e.jsx("circle",{cx:v,cy:v,fill:"none",r:v,stroke:h,strokeDasharray:S,strokeDashoffset:u,strokeLinecap:"round",strokeWidth:2})})]})})}),Ns=({isSidebarVisible:t,inputAssetChain:a,toggleSidebar:n})=>{var g,d,h,v,S,b;const{data:i}=It(),r=a,l=s.useMemo(()=>{var m;if(!i)return;const w=(m=i.find(y=>y&&y.chainId===Rt[r]))==null?void 0:m.history.map(y=>y.value).filter(Boolean),u=i.find(y=>y&&y.chainId===Rt[r]);return{values:w,historyData:u}},[i,r]),c=(h=gt(l==null?void 0:l.values,((g=l==null?void 0:l.historyData)==null?void 0:g.average7d)||((d=l==null?void 0:l.historyData)==null?void 0:d.average24h)))==null?void 0:h.state,o=(b=gt(l==null?void 0:l.values,((v=l==null?void 0:l.historyData)==null?void 0:v.average7d)||((S=l==null?void 0:l.historyData)==null?void 0:S.average24h)))==null?void 0:b.color;return e.jsx(e.Fragment,{children:e.jsx(je,{className:"group",leftIcon:e.jsx(oe,{className:"group-hover:!text-light-typo-primary dark:group-hover:!text-dark-typo-primary",color:o,name:t?"gasStationOff":"gasStation"}),onClick:n,px:"2!",tooltip:t?x("views.swap.hideGasHistory"):x("views.swap.gasTooltip",{chain:r,state:c}),tooltipClasses:"text-center",tooltipPlacement:"top",variant:"borderlessTint"})})},Ts=s.memo(({refetchData:t,toggleSidebar:a,isSidebarVisible:n,inputAssetChain:i})=>e.jsx(Ai,{actionsComponent:e.jsxs(f,{center:!0,row:!0,className:"space-x-2",children:[t&&e.jsx(ks,{duration:60,refresh:t}),e.jsx(Ns,{inputAssetChain:i,isSidebarVisible:n,toggleSidebar:a}),e.jsx(ji,{noSlippage:!0,transactionMode:!0})]}),title:x("common.swap")})),Ps=t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase(),vt=[$t.Average,$t.Fast,$t.Fastest],Os=({affiliateBasisPoints:t,assets:[a,n],expectedOutput:i,affiliateFee:r,networkFee:l,isLoading:c,streamSwap:o,minReceive:g,minReceiveSlippage:d,setFeeModalOpened:h,showTransactionFeeSelect:v,whaleDiscount:S,vTHORDiscount:b,inputUnitPrice:w,outputUnitPrice:u})=>{const{feeOptionType:m,setFeeOptionType:y}=Pe(),T=Je(),[P,D]=s.useState(!1),B=s.useCallback(ee=>{D(X=>!X),ee.stopPropagation()},[]),{rateDesc:I,ratePrice:k}=s.useMemo(()=>{const[ee,X]=[w,u].sort(()=>P?1:-1),[pe,ue]=[a,n].sort(()=>P?1:-1),ie=ee/X,F=ie>1e3?4:ie>1?5:8,O=P?u:w;return{rateDesc:ie>0?`1 ${pe} = ${ie.toFixed(F)} ${ue}`:"-",ratePrice:`(${T(O)})`}},[T,a,w,n,u,P]),z=s.useCallback(()=>{l+r<=0||h(!0)},[l,r,h]),H=s.useMemo(()=>S&&b?"vTHOR + \u{1F433} Whale 50% Off":S?"\u{1F433} Whale 50% Off":b?"vTHOR":"",[b,S]),L=s.useMemo(()=>[{label:x("views.wallet.expectedOutput"),value:e.jsx(dt,{tooltip:x("views.wallet.expectedOutputTooltip"),value:i})},o?null:{label:x("views.swap.minReceivedAfterSlip",{slippage:d>0?`${d}%`:"-"}),value:e.jsx(dt,{tooltip:x("views.wallet.minReceivedTooltip"),value:d===0?e.jsx(p,{color:"brand.yellow",fontWeight:"semibold",textStyle:"caption",children:x("views.swap.noProtection")}):g})},v?{key:"keystoreFee",label:x("common.transactionFee"),value:e.jsx(Ci,{activeIndex:vt.indexOf(m),dropdownPlacement:"bottom-end",onChange:ee=>y(vt[ee]),options:vt.map(Ps),size:"sm"})}:null,{label:e.jsxs(f,{center:!0,className:"gap-2 group",children:[e.jsx(p,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:x("views.wallet.networkFee")}),!we&&e.jsxs(f,{center:!0,children:[e.jsx(p,{className:"italic underline",fontWeight:"normal",textStyle:"caption-xs",variant:"secondary",children:"details"}),e.jsx(oe,{className:"mx-1",color:"secondary",name:"eye",size:16})]})]}),onClick:z,value:e.jsx(dt,{tooltip:x("views.swap.networkFeeTooltip"),value:e.jsx(f,{center:!0,children:e.jsx(p,{textStyle:"caption",children:T(l)})})})},{label:x("views.swap.exchangeFee"),value:e.jsx(dt,{tooltip:t?x("views.swap.affiliateFee",{percent:`${(t/100).toFixed(2)}%`}):"",value:e.jsxs(f,{center:!0,row:!0,className:"gap-1",children:[H&&e.jsxs(f,{row:!0,className:"gap-1",children:[e.jsx(p,{fontWeight:"bold",textStyle:"caption-xs",variant:"green",children:H}),e.jsx(p,{textStyle:"caption-xs",variant:"secondary",children:x("views.swap.discountApplied")})]}),r?e.jsx(p,{textStyle:"caption",children:T(r)}):e.jsx(p,{fontWeight:"bold",textStyle:"caption",variant:"green",children:"FREE"})]})})}].filter(Boolean),[t,r,H,i,m,T,g,d,l,z,y,v,o]);return e.jsx(Ta,{className:"self-stretch mt-5 !bg-light-bg-primary dark:!bg-dark-gray-light !rounded-2xl flex-col",shadow:!1,title:e.jsxs(f,{alignCenter:!0,className:"gap-1 flex-1",justify:"between",children:[e.jsx(je,{className:"!p-1 !h-auto",leftIcon:e.jsx(oe,{name:"switch",size:16}),onClick:B,tooltip:x("views.swap.swapAssets"),variant:"outlinePrimary"}),c?e.jsx(f,{alignCenter:!0,className:"px-2",flex:1,justify:"start",children:e.jsx(oe,{spin:!0,name:"loader",size:14})}):e.jsxs(f,{alignCenter:!0,className:"gap-x-1 flex-wrap flex-1 pl-1",children:[e.jsx(f,{center:!0,className:"gap-1.5",children:e.jsx(p,{fontWeight:"normal",textStyle:"caption",variant:"primary",children:I})}),e.jsx(p,{fontWeight:"normal",textStyle:"caption",variant:"secondary",children:k})]}),e.jsx(f,{className:"pr-1",children:e.jsx(je,{className:"h-[30px] px-2",leftIcon:e.jsx(oe,{color:"secondary",name:"fees",size:18}),tooltip:x("views.swap.totalFeeTooltip"),variant:"tint",children:e.jsx(p,{children:T(l+r)})})})]}),titleClassName:"pr-1",children:e.jsx(f,{col:!0,className:"w-full",children:e.jsx(Va,{items:L})})})},Ms=({hasQuote:t,quoteError:a,invalidSwap:n,inputAmount:i,inputAsset:r,isApproved:l,isInputWalletConnected:c,isLoading:o,outputAsset:g,recipient:d,setVisibleApproveModal:h,setVisibleConfirmModal:v})=>{const{setIsConnectModalOpen:S}=Rn(),{getWallet:b}=Xe(),{connectLedgerLiveWallet:w}=Fn(),{getChainTradingPaused:u}=_n(),{numberOfPendingApprovals:m}=Un(),y=s.useMemo(()=>u(r.chain)||u(g.chain),[u,r.chain,g.chain]),T=s.useMemo(()=>!!b(r.chain),[b,r.chain]),P=s.useCallback(async()=>{try{if(!d)return!0;const{validateAddress:L}=await(await ut(()=>import("./CRWIkueS.js"),__vite__mapDeps([3,1,2]))).getSwapKitClient(),ee=L({chain:g.chain,address:d});return typeof ee>"u"?!0:ee}catch(L){return pt(L),!1}},[g,d]),D=s.useCallback(async()=>{T?t?await P()?v(!0):Ge(x("notification.invalidRecipientAddy"),x("notification.invalidRecipientAddyDesc")):Wt(x("notification.noValidQuote")):Wt(x("notification.walletNotFound"),x("notification.connectWallet"))},[T,t,P,v]),B=s.useCallback(()=>{c?h(!0):Wt(x("notification.walletNotFound"),x("notification.connectWallet"))},[c,h]),I=s.useMemo(()=>!(n||y)&&t&&i.gt(0),[t,i,n,y]),k=s.useMemo(()=>y?x("notification.swapNotAvailable"):a||!t&&i.gt(0)?x("views.swap.noValidQuote"):r.isSynthetic&&g.isSynthetic||I?x("common.swap"):r.isSynthetic?x("txManager.redeem"):g.isSynthetic?x("txManager.mint"):x("common.swap"),[y,a,r.isSynthetic,g.isSynthetic,I,t,i]),z=s.useMemo(()=>t&&c&&l===!1,[t,c,l]),H=s.useMemo(()=>!(c&&d),[c,d]);return e.jsx(f,{className:"w-full pt-5 gap-x-2",children:H&&(t||!d||i.eqValue(0))?e.jsx(je,{stretch:!0,onClick:()=>we?w(c?[g.chain]:void 0):S(!0),size:"lg",variant:"fancy",children:c&&!we?x("views.swap.connectOrFillRecipient"):x("common.connectWallet")}):z&&!a&&t?e.jsx(je,{stretch:!0,loading:!!m||o,onClick:B,size:"lg",variant:"fancy",children:x("txManager.approve")}):e.jsx(je,{stretch:!0,disabled:!I,error:!I,loading:o,onClick:D,size:"lg",variant:"fancy",children:k})})},Es="No utxos to send",Is="Please wait a bit until 3 UTXO confirmations and Try again.",Rs=t=>t.includes(Es)?Is:t,Fs={[me.AVAX_TO_AVAX]:ce.SWAP_AVAX_TO_AVAX,[me.AVAX_TO_BSC]:ce.SWAP_AVAX_TO_TC,[me.AVAX_TO_ETH]:ce.SWAP_AVAX_TO_TC,[me.AVAX_TO_TC_SUPPORTED]:ce.SWAP_AVAX_TO_TC,[me.BSC_TO_AVAX]:ce.BSC_TRANSFER_TO_TC,[me.BSC_TO_BSC]:ce.SWAP_BSC_TO_BSC,[me.BSC_TO_ETH]:ce.SWAP_BSC_TO_ETH,[me.BSC_TO_TC_SUPPORTED]:ce.SWAP_BSC_TO_TC,[me.ETH_TO_AVAX]:ce.SWAP_ETH_TO_AVAX,[me.ETH_TO_BSC]:ce.SWAP_ETH_TO_TC,[me.ETH_TO_ETH]:ce.SWAP_ETH_TO_ETH,[me.ETH_TO_TC_SUPPORTED]:ce.SWAP_ETH_TO_TC,[me.TC_SUPPORTED_TO_AVAX]:ce.SWAP_TC_TO_AVAX,[me.TC_SUPPORTED_TO_BSC]:ce.SWAP_TC_TO_BSC,[me.TC_SUPPORTED_TO_ETH]:ce.SWAP_TC_TO_ETH,[me.TC_SUPPORTED_TO_TC_SUPPORTED]:ce.SWAP_TC_TO_TC},_s=({recipient:t="",inputAsset:a,outputAsset:n,route:i,quoteId:r,streamSwap:l,isChainflipBoostEnable:c})=>{const o=Ea(),{feeOptionType:g}=Pe(),{wallet:d}=Xe();return s.useCallback(async()=>{var v,S,b;const h=Ia();try{const w=(v=d==null?void 0:d[a.chain])==null?void 0:v.address,u=(S=i==null?void 0:i.providers)==null?void 0:S.includes(rt.CHAINFLIP);if(i){if(!w)throw new Error("No address found");const m=`${a.toSignificant(6)} ${a.isSynthetic?"Synth ":""}${a.ticker} \u2192 ${n.toSignificant(6)} ${n.isSynthetic?"Synth ":""}${n.ticker}`,y=u?x("txManager.preparingTransaction"):m,{swap:T,validateAddress:P}=await(await ut(()=>import("./CRWIkueS.js"),__vite__mapDeps([3,1,2]))).getSwapKitClient(),D=P({chain:n.chain,address:t});if(typeof D=="boolean"&&!D)throw new Error("Invalid recipient address");const B=we?ei:T;o(Ra({id:h,label:y,from:w,inChain:a.chain,type:Fs[((b=i.meta)==null?void 0:b.quoteMode)||me.TC_SUPPORTED_TO_TC_SUPPORTED],quoteId:r,sellAmount:a.toSignificant(),sellAmountNormalized:a.toSignificant(6),recipient:t||w,streamingSwap:l}));try{const I=await B({feeOptionKey:g,recipient:t,route:i,...c&&u?{maxBoostFeeBps:10}:{},streamSwap:l,wallet:d});De("swap",{quoteId:r,expectedVolume:i.expectedOutputUSD,minVolume:i.expectedOutputMaxSlippageUSD,input:a.toString(),output:n.toString()}),typeof I=="string"?o(Fa({label:m,id:h,txid:I,quoteId:r,route:i,timestamp:new Date,advancedTracker:Dn(i.providers)})):(o(mt({id:h,status:"error"})),Ge(x("notification.submitFail"),JSON.stringify(I)))}catch(I){pt(I),o(mt({id:h,status:"error"}));const k=(I==null?void 0:I.code)===4001||(I==null?void 0:I.toString().includes("4001"));k||De("swap_failed",{error:I,input:a.toString(),output:n.toString()}),Ge(x("notification.submitFail"),k?x("notification.cancelledByUser"):I==null?void 0:I.toString(),void 0,I)}}}catch(w){De("swap_failed",{error:w,input:a.toString(),output:n.toString()}),pt(w);const u=Rs(w==null?void 0:w.toString());o(mt({id:h,status:"error"})),Ge(x("notification.submitFail"),u.includes("Object")?"":u,void 0,w)}},[d,a,i,n,t,o,r,l,g,c])},Us=({inputAsset:t,contract:a})=>{const n=Ea(),{getWalletAddress:i}=Xe();return s.useCallback(async r=>{const l=i(t.chain);if(l){const c=Ia(),o=t.chain,g=o===J.Ethereum?ce.ETH_APPROVAL:o===J.Avalanche?ce.AVAX_APPROVAL:ce.BSC_APPROVAL;n(Ra({id:c,from:l,inChain:o,type:g,label:`${x("txManager.approve")} ${t.ticker}`}));const{approveAssetValue:d}=await(await ut(()=>import("./CRWIkueS.js"),__vite__mapDeps([3,1,2]))).getSwapKitClient();try{const h=await d(t.set(r||0),a||"thorchain");De("swap_approve",{approveAmount:r,asset:t.toString()}),typeof h=="string"&&n(Fa({id:c,txid:h}))}catch(h){De("swap_approve_failed",{error:h,approveAmount:r,asset:t.toString()}),pt(h),n(mt({id:c,status:"error"})),Ge(x("notification.approveFailed"),void 0,void 0,h)}}},[i,t,n,a])},Ds=t=>t.reduce((a,n)=>{if(n.providers[0].includes("_STREAMING"))return a;const i=t.find(r=>r.providers[0]===`${n.providers[0]}_STREAMING`);return a.push(Vs({route:n,streamingSwapRoute:i})),a},[]),Vs=({route:t,streamingSwapRoute:a})=>{const n={...t};if(!a)return n;const{maxQuantity:i,maxIntervalForMaxQuantity:r}=$s(a.memo),{savingsInAsset:l,savingsInUSD:c}=Ws({route:t,streamingSwapRoute:a}),o={expectedOutput:a.expectedOutput,expectedOutputMaxSlippage:a.expectedOutputMaxSlippage,expectedOutputUSD:a.expectedOutputUSD,expectedOutputMaxSlippageUSD:a.expectedOutputMaxSlippageUSD,estimatedTime:a.estimatedTime,fees:a.fees,memo:a.memo,maxQuantity:i,maxIntervalForMaxQuantity:r,savingsInAsset:l,savingsInUSD:c,warnings:a.warnings};return{...n,streamingSwap:o}};function $s(t){const a=t==null?void 0:t.split(":"),n=3;if(!a||(a==null?void 0:a.length)<n+1)return{maxQuantity:0,maxIntervalForMaxQuantity:0};const i=a[n],[,,r]=i.split("/"),l=24*60*60,c=Math.round(l/(Number(r)*6));return{maxQuantity:Number(r)||0,maxIntervalForMaxQuantity:Number(c)||0}}function Ws({route:t,streamingSwapRoute:a}){return{savingsInAsset:`${Number(a.expectedOutput)-Number(t.expectedOutput)}`,savingsInUSD:"0"}}let la,bt,yt,jt,ca;la=({ethAddress:t,inputAsset:a,inputAmount:n,outputAsset:i,recipientAddress:r,senderAddress:l,inputUSDPrice:c})=>{var O,ne;const o=s.useRef(!1),{slippageTolerance:g}=Pe(),d=Vt(({app:W})=>W.iframeData),[h,v]=s.useState(!1),[S,b]=s.useState([]),[w,u]=s.useState([]),m=_a(g,1e3),y=_a(n.getValue("string"),400),T=bi(t);s.useEffect(()=>{b([])},[n]);const P=W=>{b(W.providers||W.provider)},D=s.useMemo(()=>{if(d!=null&&d.fee)return`${Math.floor(d.fee)}`;let W=50;return T.gte(1e3)&&(W=42),T.gte(1e4)&&(W=25),T.gte(1e5)&&(W=17),T.gte(5e5)&&(W=0),we&&(W=50),(Hn||Bn)&&(W=0),`${Math.floor(W)}`},[T,d==null?void 0:d.fee,c]),B=s.useMemo(()=>({affiliateBasisPoints:D,affiliateAddress:(d==null?void 0:d.address)||(we?Vn:$n),sellAsset:a.toString(),buyAsset:i.toString(),sellAmount:y,senderAddress:l,recipientAddress:r,...m&&{slippage:m.toString()}}),[D,m,y,d==null?void 0:d.address,a,i,r,l]),{refetch:I,error:k,isLoading:z,currentData:H,isFetching:L,isUninitialized:ee}=Wn({...B,sellAsset:a.toString({includeSynthProtocol:!0}),buyAsset:i.toString({includeSynthProtocol:!0})},{skip:B.sellAmount==="0"||n.lte(0)}),X=s.useMemo(()=>k,[k]),pe=s.useMemo(()=>()=>{u([]),ee||I()},[ee,I]),ue=s.useCallback(async W=>{try{const Se=W.map(async Z=>{const A=l&&!Z.providers.includes(rt.CHAINFLIP)?await ki({assetValue:a.set(n),contract:Z.meta.approvalAddress||Z.approvalTarget||Z.allowanceTarget||Z.targetAddress||Z.providers[0].toLowerCase()}):!0;return{...Z,isApproved:A}}),R=(await Promise.all(Se)).filter(Boolean).concat().sort((Z,A)=>{var M,G;const _=Number(A.isApproved)-Number(Z.isApproved);return _!==0?_:Number(((M=A.streamingSwap)==null?void 0:M.expectedOutput)||A.expectedOutput)-Number(((G=Z.streamingSwap)==null?void 0:G.expectedOutput)||Z.expectedOutput)});u(R)}finally{v(!1)}},[a,l,n]),ie=s.useMemo(()=>n.lte(0),[n]);s.useEffect(()=>{if(L&&w.length)return;const W=((H==null?void 0:H.routes)||[]).filter(R=>{const Z=R.providers.find(M=>/.*_STREAMING/.test(M));if(!Z)return!0;const A=Z.replace("_STREAMING",""),_=H==null?void 0:H.routes.find(M=>M.providers.includes(A));return!(_&&R.expectedBuyAmount===_.expectedBuyAmount)}).map(R=>{var _;const Z=R.meta,A=(_=R==null?void 0:R.fees)==null?void 0:_.reduce((M,G)=>{var le,re;const K=((re=(le=Z.assets)==null?void 0:le.find(se=>se.asset.toLowerCase()===G.asset.toLowerCase()))==null?void 0:re.price)||0;if(G.type===qe.INBOUND){const se=de.from({asset:G.asset,value:G.amount}).add(M.inbound.networkFee),he=se.mul(K);return M.inbound={...M.inbound,networkFee:se.getValue("number"),networkFeeUSD:he.getValue("number")},M.total={totalFeeUSD:he.add(M.total.totalFeeUSD).getValue("number")},M}if(G.type===qe.AFFILIATE){const se=a.set(G.amount),he=se.mul(K);return M.inbound={...M.inbound,affiliateFee:se.getValue("number"),affiliateFeeUSD:he.getValue("number")},M.total={totalFeeUSD:he.add(M.total.totalFeeUSD).getValue("number")},M}if(G.type===qe.OUTBOUND){const se=de.from({asset:G.asset,value:G.amount}).add(M.outbound.networkFee),he=se.mul(K);return M.outbound={...M.outbound,networkFee:se.getValue("number"),networkFeeUSD:he.getValue("number")},M.total={totalFeeUSD:he.add(M.total.totalFeeUSD).getValue("number")},M}if(G.type===qe.NETWORK){const se=de.from({asset:G.asset,value:G.amount}).add(M.slippage.slipFee);return M.slippage={...M.slippage,slipFee:se.getValue("number"),slipFeeUSD:se.getValue("number")},M.total={totalFeeUSD:se.add(M.total.totalFeeUSD).getValue("number")},M}if(G.type===qe.LIQUIDITY){const se=de.from({asset:G.asset,value:G.amount}).add(M.slippage.slipFee),he=se.mul(K);return M.slippage={...M.slippage,slipFee:se.getValue("number"),slipFeeUSD:he.getValue("number")},M.total={totalFeeUSD:he.add(M.total.totalFeeUSD).getValue("number")},M}return M},{inbound:{networkFee:0,networkFeeUSD:0,affiliateFee:0,affiliateFeeUSD:0},outbound:{networkFee:0,networkFeeUSD:0,affiliateFee:0,affiliateFeeUSD:0},slippage:{slipFee:0,slipFeeUSD:0},total:{totalFeeUSD:0}});return{...R,timeEstimates:R.estimatedTime,path:`${R.sellAsset} -> ${R.buyAsset}`,expectedOutput:R.expectedBuyAmount,isApproved:!0,fees:{[R==null?void 0:R.providers[0]]:[{type:"inbound",asset:R.sellAsset,networkFee:A==null?void 0:A.inbound.networkFee,networkFeeUSD:A==null?void 0:A.inbound.networkFeeUSD,affiliateFee:A==null?void 0:A.inbound.affiliateFee,affiliateFeeUSD:A==null?void 0:A.inbound.affiliateFeeUSD,totalFee:A==null?void 0:A.inbound.networkFee,totalFeeUSD:A==null?void 0:A.inbound.networkFeeUSD,isOutOfPocket:!0},{type:"outbound",asset:R.buyAsset,networkFee:A==null?void 0:A.outbound.networkFee,networkFeeUSD:A==null?void 0:A.outbound.networkFeeUSD,affiliateFee:0,affiliateFeeUSD:0,slipFee:A==null?void 0:A.slippage.slipFee,slipFeeUSD:A==null?void 0:A.slippage.slipFeeUSD,totalFee:0,totalFeeUSD:A==null?void 0:A.total.totalFeeUSD,isOutOfPocket:!1}]}}});if(!(H!=null&&H.routes||W)||ie)return u([]);const Se=Ds(W);ue(Se),v(!0)},[H,a,L,ie,w==null?void 0:w.length,ue,n,D]);const F=s.useMemo(()=>X||z||n.getValue("number")===0?void 0:w.find(W=>W.providers.join()===S.join())||w[0],[X,n,z,w,S]);return s.useEffect(()=>{(a||n||i)&&u([])},[n,a,i]),s.useEffect(()=>{var W;(W=X==null?void 0:X.data)!=null&&W.message&&!o.current&&(o.current=!0,setTimeout(()=>{o.current=!1},3e3))},[(O=X==null?void 0:X.data)==null?void 0:O.message]),{refetch:pe,affiliateBasisPoints:D,vTHORDiscount:!we&&T.gte(1e3),error:X,estimatedTime:(ne=F||w[0])==null?void 0:ne.estimatedTime,isFetching:(h||(z||L)&&w.length===0)&&!X,routes:w,selectedRoute:F||w[0],setSwapRoute:P,quoteId:H==null?void 0:H.quoteId}},bt=de.from({chain:we?J.Bitcoin:J.Ethereum}),yt=de.from({chain:we?J.Ethereum:J.Bitcoin}),jt=[J.THORChain,J.Maya],ca=()=>{var wa,va,ba;const[t]=Ln(),a=zn(),n=Yn(),{getMaxBalance:i}=ti(),{keystore:r}=Qn(),{getWallet:l,getWalletAddress:c}=Xe(),o=s.useMemo(()=>n.pathname.split("/").includes("okx"),[n.pathname]),{analyticsVisible:g,toggleAnalytics:d}=Pe(),{pair:h}=Xn(),[v,S]=s.useMemo(()=>(h||"").split("_"),[h]),b=s.useMemo(()=>{if(!(h&&v))return bt;const[C,Q,ae]=v.split("."),Ae=jt.includes(C)&&ae?`${C}.${Q}/${ae}`:v;return de.from({asset:Ae})||bt},[v,h]),w=s.useMemo(()=>{if(!(h&&S))return yt;const[C,Q,ae]=S.split("."),Ae=jt.includes(C)&&ae?`${C}.${Q}/${ae}`:S;return de.from({asset:Ae})||yt},[S,h]),u=s.useMemo(()=>b,[b]),m=s.useMemo(()=>w,[w]);s.useEffect(()=>{De("swap_pair",{sell:u.toString(),buy:m.toString()})},[u,m]);const[y,T]=s.useState(Ua),[P,D]=s.useState(b.set(0)),[B,I]=s.useState(""),[k,z]=s.useState(!0),[H,L]=s.useState(""),[ee,X]=s.useState(""),[pe,ue]=s.useState(!1),[ie,F]=s.useState(!1),[O,ne]=s.useState(!1),[W,Se]=s.useState("0"),R=Je(),[Z,A]=s.useState(!1),_=s.useMemo(()=>c(J.Ethereum),[c]),{tokens:M,tradingPairs:G}=fi(!0),[K,le]=s.useMemo(()=>[M.find(({chain:C,ticker:Q,address:ae})=>`${C}.${Q}${ae?`-${ae}`:""}`.toUpperCase()===`${u.chain}.${u.symbol}`.toUpperCase()),M.find(({chain:C,ticker:Q,address:ae})=>`${C}.${Q}${ae?`-${ae}`:""}`.toUpperCase()===`${m.chain}.${m.symbol}`.toUpperCase())],[u.chain,u.symbol,m.chain,m.symbol,M]),re=s.useMemo(()=>new fe({value:t.get("sellAmount")||"0",decimal:u.decimal}),[u.decimal,t]),se=s.useCallback(C=>{const Q=C.getValue("string"),ae=n.pathname.split("?")[0];a(`${ae}?sellAmount=${Q}`)},[n.pathname,a]);s.useEffect(()=>{if(we){I(c(m.chain)),X(c(u.chain));return}const C=c(m.chain);I(C||""),L(C||""),X(c(u.chain)||"")},[c,u.chain,m]),s.useEffect(()=>{const C=ct(u)||Ut(u)?lt.ETH:K==null?void 0:K.decimals,Q=ct(m)||Ut(m)?lt.ETH:le==null?void 0:le.decimals;M.length&&(u.decimal=C,m.decimal=Q)},[u,K==null?void 0:K.decimals,m,le==null?void 0:le.decimals,M]);const{refetch:he,isLoading:te,inputUnitPrice:Me,outputUnitPrice:Ee}=Gn([u,m]),{affiliateBasisPoints:Ie,estimatedTime:xe,isFetching:Ce,refetch:We,routes:tt,error:He,selectedRoute:Y,setSwapRoute:at,quoteId:At,vTHORDiscount:Ct}=la({ethAddress:_,inputAmount:re,inputAsset:u,inputUSDPrice:Me,outputAsset:m,recipientAddress:B||H,senderAddress:ee}),Be=s.useMemo(()=>{var C,Q,ae;return((ae=(Q=(C=Y==null?void 0:Y.meta)==null?void 0:C.assets)==null?void 0:Q.find(Ae=>Ae.asset.toUpperCase()===u.toString().toUpperCase()))==null?void 0:ae.price)||Me},[Y,Me]),Re=s.useMemo(()=>{var C,Q,ae;return((ae=(Q=(C=Y==null?void 0:Y.meta)==null?void 0:C.assets)==null?void 0:Q.find(Ae=>Ae.asset.toUpperCase()===m.toString().toUpperCase()))==null?void 0:ae.price)||Ee},[Y,Ee]),Ne=s.useMemo(()=>{var C;return(C=Y==null?void 0:Y.providers)==null?void 0:C.includes("CHAINFLIP")},[Y==null?void 0:Y.providers]),kt=s.useMemo(()=>{var C;return(C=Y==null?void 0:Y.providers)==null?void 0:C.includes("MAYACHAIN")},[Y==null?void 0:Y.providers]),Fe=s.useMemo(()=>{var C;return[J.Litecoin,J.Dogecoin,J.BitcoinCash,J.Dash].includes(u.chain)&&((C=l(u.chain))==null?void 0:C.walletType)===qn.LEDGER},[l,u.chain]),ye=s.useMemo(()=>re.mul(Be).getValue("number"),[re,Be]),_e=s.useMemo(()=>Y&&new fe({value:ye||Y.expectedOutputUSD||Y.expectedBuyAmountUSD||0}).lte(500),[Y,ye]),j=s.useMemo(()=>{if(!(Y!=null&&Y.calldata&&ye))return!1;const C=new fe(Y.expectedOutputUSD),Q=C.div(ye).sub(1).mul(100);return Se(Q.toFixed(2)),C&&Q.lt("-5")},[Y,ye]),{streamSwap:E,canStreamSwap:$,minReceive:V,outputAmount:q,fees:ge,route:U,streamingSwapParams:Le,setStreamingSwapParams:ze,slippagePercent:ua,defaultInterval:Hs}=fs({selectedRoute:Y,inputAmount:re,noPriceProtection:Fe,outputAsset:m,isChainflip:Ne,noSlipProtection:_e}),da=s.useMemo(()=>q.mul(Re).getValue("number"),[Re,q]),Ue=s.useMemo(()=>!!l(u.chain),[l,u.chain]),pa=s.useMemo(()=>Ue?P:void 0,[Ue,P]),ma=s.useMemo(()=>({asset:u,logoURI:K==null?void 0:K.logoURI,value:re,balance:pa,usdPrice:ye,priceLoading:te}),[u,K==null?void 0:K.logoURI,re,pa,ye,te]),ha=s.useMemo(()=>({asset:m,logoURI:le==null?void 0:le.logoURI,value:q,usdPrice:da,loading:Ce,priceLoading:te||Ce}),[m,le==null?void 0:le.logoURI,q,da,Ce,te]),{approvalTarget:Bs,allowanceTarget:Ls,targetAddress:zs,meta:Nt}=U||{},Ys=s.useMemo(()=>{var C;return((C=U==null?void 0:U.meta)==null?void 0:C.quoteMode)||""},[(wa=U==null?void 0:U.meta)==null?void 0:wa.quoteMode]),{firstNetworkFee:Qs,affiliateFee:xa,networkFee:Xs,totalFee:ga}=qt(ge),Gs=Us({contract:(Nt==null?void 0:Nt.approvalAddress)||Bs||Ls||zs||((va=U==null?void 0:U.providers)==null?void 0:va[0]),inputAsset:u}),qs=s.useMemo(()=>{const C=Object.values(ge||{}).flat().map(({asset:Q})=>new de({identifier:Q,decimal:2,value:0}).ticker);return Array.from(new Set(C)).join(", ")},[ge]),st=s.useCallback(C=>async Q=>{const ae=C==="input",Ae=ae?Q:Q.eqAsset(u)?m:u,cn=ae?Q.eqAsset(m)?u:m:Q;if(ae){const Pt=await i(Q)||Ua;se(re.gt(Pt)?new fe({value:Pt.getValue("string"),decimal:Pt.decimal}):re)}const un=ot(Ae,cn,o?ht.Okx:ht.Swap);a(`${un}?sellAmount=${re.getValue("string")}`)},[i,re,u,o,a,m,se]),Ks=s.useCallback(C=>{T(q.gt(y)?y:q);const Q=ct(m)?de.fromChainOrSignature(we?J.Bitcoin:"ETH.THOR"):de.from({chain:J.Ethereum}),ae=ot(m,C?Q:u,o?ht.Okx:ht.Swap);a(`${ae}?sellAmount=${q.getValue("string")}`)},[q,y,m,u,o,a]),Js=s.useCallback(()=>{he(),We()},[he,We]),Zs=_s({inputAsset:de.from({asset:u.toString({includeSynthProtocol:!0}),value:re.getValue("string")}),outputAsset:de.from({asset:m.toString({includeSynthProtocol:!0}),value:q.getValue("string")}),quoteMode:Ys,recipient:B,route:U,quoteId:At,streamSwap:E,isChainflipBoostEnable:Z});s.useEffect(()=>{D(void 0),i(u).then(C=>D(C))},[u,i]);const fa=s.useMemo(()=>V.gte(0)?`${V.toSignificant(6)} ${m.ticker.toUpperCase()}`:"-",[V,m.ticker]),en=s.useMemo(()=>!!l(m.chain),[l,m.chain]),tn=s.useMemo(()=>Ue&&u.chain===J.Ethereum&&!!r,[u.chain,Ue,r]),nt=s.useMemo(()=>m.ticker.includes("THOR")&&m.chain===J.Avalanche,[m]),it=s.useMemo(()=>m.ticker==="RUNE"&&m.chain===J.Ethereum,[m]),an=s.useMemo(()=>nt||it,[nt,it]),sn=s.useMemo(()=>nt?e.jsx(gs,{inputAsset:u}):it?e.jsx(ds,{inputAsset:u}):null,[u,nt,it]),nn=s.useMemo(()=>P?re.gt(P):!1,[re,P]),rn=s.useMemo(()=>[u.ticker,m.ticker],[u.ticker,m.ticker]),on=s.useCallback(()=>st("input"),[st]),ln=s.useCallback(()=>st("output"),[st]),Sa=Vt(({app:C})=>{var Q;return(Q=C.iframeData)==null?void 0:Q.isWidget}),Tt=E?(ba=U==null?void 0:U.streamingSwap)==null?void 0:ba.warnings:U==null?void 0:U.warnings;return e.jsxs(N,{alignSelf:"center",gap:3,w:"full",children:[e.jsx(N,{flex:1,justify:"center",transition:Et,children:e.jsxs(Zn,{description:x("views.swap.description",{inputAsset:u.ticker.toUpperCase(),outputAsset:m.ticker.toUpperCase()}),header:Sa?null:e.jsx(Ts,{inputAssetChain:u.chain,isSidebarVisible:g,refetchData:!U||Ce||te?void 0:Js,toggleSidebar:()=>d(!g)}),keywords:`${u.ticker}, ${m.ticker}, SWAP, THORSwap, THORChain, DEX, DeFi`,title:`${x("common.swap")} ${u.ticker} to ${m.ticker}`,children:[e.jsx(bs,{inputAsset:ma,onInputAmountChange:se,onInputAssetChange:on(),onOutputAssetChange:ln(),onSwitchPair:Ks,outputAsset:ha,tokens:M,tradingPairs:G.get(u.toString().toLowerCase())||{tokens:M,providers:[zt.V1_PROVIDERS,zt.CHAINFLIP,zt.MAYACHAIN]}}),!we&&Ue&&e.jsx(yi,{isOutputWalletConnected:en,outputAssetChain:m.chain,recipient:B||H,setIsValidRecipient:z,setRecipient:I}),e.jsx(Os,{affiliateBasisPoints:Number(kt?0:Ie),affiliateFee:xa,assets:rn,expectedOutput:`${q==null?void 0:q.toSignificant(6)} ${m.ticker.toUpperCase()}`,inputUnitPrice:Be,isLoading:te,minReceive:fa,minReceiveSlippage:ua,networkFee:Xs,outputUnitPrice:Re,setFeeModalOpened:ne,showTransactionFeeSelect:tn,streamSwap:E,vTHORDiscount:Ct,whaleDiscount:ye>=1e6}),an&&e.jsx(Ke,{className:"!mt-2",content:sn,type:"warn"}),Fe&&e.jsx(Ke,{className:"!mt-2",content:x("views.swap.priceProtectionUnavailableDesc",{chain:u.chain}),title:x("views.swap.priceProtectionUnavailable"),type:"warn"}),e.jsx(cs,{outputAsset:m,outputUnitPrice:Re,routes:tt,selectedRoute:U,setSwapRoute:at,streamSwap:E}),(!Sa||!!U)&&e.jsx(xs,{canStreamSwap:$,defaultInterval:Hs,isChainflip:Ne,isChainflipBoostEnable:Z,setIsChainflipBoostEnable:A,minReceive:V,noSlipProtection:_e||Fe,onSettingsChange:ze,outputAmount:q,outputAsset:m,route:U,streamSwap:E,streamingSwapParams:Le}),Tt==null?void 0:Tt.map(C=>e.jsx(Ke,{className:"!mt-2",title:C.code==="highPriceImpact"?e.jsxs(f,{row:!0,className:"pl-4 self-stretch w-[100%]",justify:"between",children:[e.jsx(p,{children:x(`views.swap.warning.${C.code}`)})," ",e.jsx(p,{color:"red",children:C.display})]}):x(`views.swap.warning.${C.code}`),tooltip:C.tooltip,type:"warn"},C.code)),j&&!E&&!(U!=null&&U.providers.some(C=>Kn.includes(C)))&&e.jsx(Ke,{className:"!mt-2",title:e.jsxs(f,{row:!0,className:"pl-4 self-stretch w-[100%]",justify:"between",children:[e.jsx(p,{children:x("views.swap.warning.highPriceImpact")})," ",e.jsx(p,{color:"red",children:`${W}%`})]}),tooltip:x("views.swap.warning.highPriceImpactTooltip"),type:"warn"},"highValueImpact-v1"),_e&&!Ne&&e.jsx(Ke,{className:"!mt-2",title:x("views.swap.priceProtectionUnavailable"),type:"warn"},"amountTooLowForLimit"),e.jsx(Ms,{hasQuote:!!U,inputAmount:re,inputAsset:u,invalidSwap:nn,isApproved:!!(U!=null&&U.isApproved),isInputWalletConnected:Ue,isLoading:(Ce||te)&&!He,outputAsset:m,quoteError:!!He,recipient:k?B||H:null,setVisibleApproveModal:F,setVisibleConfirmModal:ue}),e.jsx(Cs,{affiliateFee:R(xa),estimatedTime:xe,feeAssets:qs,handleSwap:Zs,inputAssetProps:ma,isChainflip:Ne,minReceive:fa,outputAssetProps:ha,recipient:B,selectedRoute:U,setVisible:ue,slippagePercent:Ne?5:_e||Fe?0:ua,streamSwap:E,totalFee:R(ga),visible:pe}),e.jsx(gi,{balance:P,handleApprove:Gs,inputAsset:u,setVisible:F,totalFee:R(Qs),visible:ie}),e.jsx(us,{fees:ge,isOpened:O,onClose:()=>ne(!1),totalFee:R(ga)})]})}),e.jsx(as,{analyticsVisible:g,inputAssetChain:u.chain,toggleAnalytics:d})]})},Qa=ca});export{Pi as __tla,Qa as default};
