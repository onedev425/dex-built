function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["CRWIkueS.js","assets/index-CyIKZwcA.js","assets/index-C3LuW5Z2.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as a,$ as b,s as r,cn as be,j as e,F as C,T as g,a9 as ee,z as D,be as ye,bj as je,c$ as te,Y as c,k as Re,d0 as Ie,h as Ne,ag as _e,ap as Be,t as o,d1 as Te,d2 as Ce,ab as He,aq as Ae,ar as Oe,R as y,ao as se,av as ae,ak as Ee,aJ as ke,af as $,aI as Pe,q as d,bi as k,I as M,aM as le,L as Se,E as Ue,A as ie,w as re,D as ne,bc as De,__tla as $e}from"./assets/index-CyIKZwcA.js";import{A as Me}from"./nBoaRR4P.js";import{I as W}from"./nkxDqpDa.js";import{C as We,__tla as ze}from"./VQNeEiYk.js";import{P as Ve}from"./xyTk0RBf.js";import{T as Le}from"./CkVRNEhN.js";import{b as Fe}from"./DVVdR7oe.js";import{u as qe,__tla as Ke}from"./BQokClGM.js";import"./BGeRo-1L.js";import"./C20jg5MW.js";import"./CzdZMSiN.js";import"./DYrZbK8R.js";import"./C2yJ0wdw.js";let oe,Je=Promise.all([(()=>{try{return $e}catch{}})(),(()=>{try{return ze}catch{}})(),(()=>{try{return Ke}catch{}})()]).then(async()=>{(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l=new Error().stack;l&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[l]="e65ce329-532d-4722-89fe-e8923a79b244",t._sentryDebugIdIdentifier="sentry-dbid-e65ce329-532d-4722-89fe-e8923a79b244")}catch{}})();const ce=(t,l)=>{const m=a.useRef(()=>{});a.useEffect(()=>{m.current=t}),a.useEffect(()=>{if(l!==null){const n=setInterval(()=>m.current(),l||0);return()=>clearInterval(n)}},[l])},z=async()=>{const t=await te.getRunePoolInfo();return{pol:{runeDeposited:r.fromBigInt(BigInt(t.pol.rune_deposited),c.THOR),runeWithdrawn:r.fromBigInt(BigInt(t.pol.rune_withdrawn),c.THOR),value:r.fromBigInt(BigInt(t.pol.value),c.THOR),pnl:r.fromBigInt(BigInt(t.pol.pnl),c.THOR),currentDeposit:r.fromBigInt(BigInt(t.pol.current_deposit),c.THOR)},providers:{units:r.fromBigInt(BigInt(t.providers.units),c.THOR),pendingUnits:t.providers.pending_units,pendingRune:t.providers.pending_rune,value:r.fromBigInt(BigInt(t.providers.value),c.THOR),pnl:r.fromBigInt(BigInt(t.providers.pnl),c.THOR),currentDeposit:r.fromBigInt(BigInt(t.providers.current_deposit),c.THOR)},reserve:{units:r.fromBigInt(BigInt(t.reserve.units),c.THOR),value:r.fromBigInt(BigInt(t.reserve.value),c.THOR),pnl:r.fromBigInt(BigInt(t.reserve.pnl),c.THOR),currentDeposit:r.fromBigInt(BigInt(t.reserve.current_deposit),c.THOR)}}},de=async t=>{const l=await te.getRunePoolProviderInfo({thorAddress:t});return{address:t,asset:b.from({asset:"THOR.RUNE"}),units:r.fromBigInt(BigInt(l.units),c.THOR),value:r.fromBigInt(BigInt(l.value),c.THOR),pnl:r.fromBigInt(BigInt(l.pnl),c.THOR),depositAmount:r.fromBigInt(BigInt(l.deposit_amount),c.THOR),withdrawAmount:r.fromBigInt(BigInt(l.withdraw_amount),c.THOR),lastDepositHeight:l.last_deposit_height,lastWithdrawHeight:l.last_withdraw_height}},V={asset:b.from({asset:"THOR.RUNE"}),address:"",units:new r({value:0,decimal:8}),value:new r({value:0,decimal:8}),pnl:new r({value:0,decimal:8}),depositAmount:new r({value:0,decimal:8}),withdrawAmount:new r({value:0,decimal:8}),lastDepositHeight:0,lastWithdrawHeight:0},ue=()=>{const[t,l]=a.useState([]),m=a.useCallback(async()=>{const n=await(await be(async()=>await z(),1e3,{leading:!0,trailing:!1}))(),p=[{label:"Users",value:`${n.providers.value.toCurrency("")} RUNE`}],f=[{label:"Users",value:`${n.providers.pnl.toCurrency("")} RUNE`}],R=[{label:"Total Rune in Pool",value:n?`${b.from({asset:"THOR.RUNE",value:n.providers.value}).toCurrency("")} RUNE`:"-",tooltip:e.jsxs(C,{className:"flex flex-col",children:[e.jsx(g,{fontSize:"10px",variant:"primary",children:"Breakdown of Rune in Pool by source."}),e.jsx(W,{items:p})]})},{label:"Total RUNEPool PnL",value:n?`${b.from({asset:"THOR.RUNE",value:n.providers.pnl}).toCurrency("")} RUNE`:"-",tooltip:e.jsxs(C,{className:"flex flex-col",children:[e.jsx(g,{fontSize:"10px",variant:"primary",children:"Breakdown of RUNEPool PnL by source."}),e.jsx(W,{items:f})]})}];l(R)},[]);return{stats:t,refreshStats:m}},L=()=>{const{wallet:t,isWalletLoading:l}=ee(),[m,n]=a.useState(V);return a.useEffect(()=>{if(l)return;const p=t[D.THORChain];if(!p){n(V);return}de(p.address).then(n)},[t,l]),{position:m}},me=()=>{const{runePoolDepositMaturityBlocks:t,runePoolMaxReserveBackstop:l,isRunePoolHalted:m,polMaxNetworkDeposit:n}=ye(),{data:p}=je(),{position:f}=L(),[R,H]=a.useState({depositAvailability:!1,withdrawalAvailability:!1}),T=a.useMemo(()=>{var v;return(v=p==null?void 0:p[0])==null?void 0:v.thorchain},[p]),A=a.useCallback(async()=>{const v=await z(),I=!0;let N=!0;if(m){H({depositAvailability:!1,withdrawalAvailability:!1});return}N=((f==null?void 0:f.lastDepositHeight)??0)+t<=T,v.reserve.value.gte(l.add(n))&&(N=!1),H({depositAvailability:I,withdrawalAvailability:N})},[m,T,n,f==null?void 0:f.lastDepositHeight,t,l]);return{availability:R,refreshAvailability:A}};var j=(t=>(t.Deposit="deposit",t.Withdraw="withdraw",t))(j||{});Re.extend(Ie.duration),oe=()=>{var G,Q;const{isLgActive:t}=Ne(),[l,m]=a.useState(j.Deposit),[n,p]=a.useState(new r({decimal:2,value:0})),{getMaxBalance:f}=qe(),{getWalletAddress:R}=ee(),{setIsConnectModalOpen:H}=_e(),{availability:{depositAvailability:T,withdrawalAvailability:A},refreshAvailability:v}=me(),I=Be(),{stats:N,refreshStats:F}=ue(),[u,P]=a.useState(new r({value:0,decimal:8})),{position:s}=L(),[q,K]=a.useState(),[J,S]=a.useState(!1),pe=a.useMemo(()=>[{label:o("common.deposit"),value:j.Deposit},{label:o("common.withdraw"),value:j.Withdraw}],[]),O=a.useMemo(()=>R(D.THORChain),[R]),fe=a.useCallback(i=>{P(u.set(0)),m(i)},[]),he=a.useCallback(i=>{p(i)},[]);a.useEffect(()=>{O?f(b.from({asset:"THOR.RUNE"})).then(i=>K(i)):K(void 0)},[f,O]);const h=a.useMemo(()=>l===j.Deposit,[l]),Y=a.useMemo(()=>h?Te():Ce({basisPoints:n.mul(100).getValue("number"),affiliateAddress:"t",affiliateBasisPoints:200}),[n,h]),ge=a.useCallback(async()=>{const{thorchain:i,getExplorerTxUrl:x}=(await He(()=>import("./CRWIkueS.js"),__vite__mapDeps([0,1,2]))).getSwapKitClient();if(!i)throw new Error("SwapKit client not found");S(!1);const B=Ae();I(Oe({id:B,label:o(h?"txManager.addAmountAsset":"txManager.withdrawAmountAsset",{asset:y.ticker,amount:h?u.getValue("string"):n.mul(s==null?void 0:s.value).div(100).toSignificant(6)}),type:h?se.TC_RUNEPOOL_ADD:se.TC_RUNEPOOL_WITHDRAW,inChain:y.chain}));try{const U={memo:Y,assetValue:h?y.set(u.getValue("string")):y},X=await i.deposit({...U,recipient:""});X&&I(ae({id:B,status:"mined",txUrl:x({chain:D.THORChain,txHash:X})}))}catch(U){Ee(U),I(ae({id:B,status:"error"}))}finally{P(new r({value:0,decimal:8}))}},[u,I,h,Y,n]);ce(()=>{F(),v()},3e4),a.useEffect(()=>{F(),v()},[s.address,O]);const{data:w}=ke([s.asset]),_=a.useCallback(i=>{var x;return`$${(((x=w==null?void 0:w[s.asset.toString()])==null?void 0:x.price_usd)*i.getValue("number")||0*i.getValue("number")).toFixed(2)}`},[w,s.asset]),xe=a.useMemo(()=>{var i,x;return[{label:"Amount Deposited",value:e.jsx($,{icon:"usdCircle",tooltip:_(s.depositAmount),value:`${s.depositAmount.getValue("string")} ${s.asset.ticker}`})},{label:"Amount Redeemable",value:e.jsx($,{icon:"usdCircle",tooltip:_(s.value),value:`${(i=s==null?void 0:s.value)==null?void 0:i.getValue("string")} ${s.asset.ticker}`})},{label:"Total Earned",value:e.jsx($,{icon:"usdCircle",tooltip:_(s.pnl||Pe),value:`${(x=s==null?void 0:s.pnl)==null?void 0:x.getValue("string")} ${s.asset.ticker}`})}]},[_,s]),E=a.useMemo(()=>{var i;return{amount:u,value:u,balance:q,asset:y,usdPrice:(((i=w==null?void 0:w[y.toString()])==null?void 0:i.price_usd)||0)*u.getValue("number")}},[u,q,_]),ve=[{label:o("common.action"),value:o(`common.${h?"deposit":"withdraw"}`)},{label:o("common.asset"),value:s.asset.ticker,icon:s.asset},{label:o("views.wallet.estimatedTime"),value:`${Fe.THOR} seconds`},{label:o("views.wallet.networkFee"),value:`0.02 ${E.asset.ticker}`},{label:o("common.amount"),value:`${u.gt(0)?u.toSignificant(6):(G=s.value)==null?void 0:G.mul(n).div(100).toSignificant(6)} ${E.asset.ticker}`}],we=()=>{(u.gt(0)||n.gt(0))&&S(!0)},Z=a.useMemo(()=>h?!T:!A,[T,A,h]);return e.jsxs(d,{col:!0,className:"w-full max-w-[880px] flex self-center gap-3 mt-2",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:N?N.map(i=>e.jsxs(k,{className:"!rounded-2xl p-4 flex flex-col gap-2",children:[e.jsx(g,{fontSize:"20px",variant:"primary",children:i.label}),e.jsx(C,{className:"flex-row gap-1 my-auto",children:e.jsx(g,{fontSize:"14px",variant:"secondary",children:i.value})})]},i.label)):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"!rounded-2xl p-4 flex flex-col gap-2",children:e.jsx("div",{className:"flex w-full p-6",children:e.jsx(M,{spin:!0,color:"primary",name:"loader",size:16})})},1),e.jsx(k,{className:"!rounded-2xl p-4 flex flex-col gap-2",children:e.jsx("div",{className:"flex w-full p-6",children:e.jsx(M,{spin:!0,color:"primary",name:"loader",size:16})})},1)]})}),e.jsx("div",{className:"w-full my-2 border-0 border-b-2 border-solid !border-opacity-25 dark:border-dark-border-primary"}),e.jsxs(d,{className:"flex flex-col w-full",children:[e.jsx(le,{className:"m-auto !pt-2 !pb-1 !px-2 w-full items-start",content:o("views.runePool.warningContent"),contentClassName:"py-0",title:o("views.runePool.warningTitle"),type:"warn"}),e.jsx(d,{alignCenter:!0,className:"mt-4",children:e.jsxs(g,{className:"ml-3 mr-2",textStyle:"h3",children:[o("common.pool")," RUNE"]})}),e.jsxs(d,{alignCenter:!0,className:"px-3",justify:"start",children:[e.jsx(g,{fontWeight:"medium",textStyle:"caption",variant:"secondary",children:o("views.runePool.description",{asset:"RUNE"})}),e.jsx(Se,{to:"https://docs.thorswap.finance/thorswap/thorswap/runepool",children:e.jsx(M,{className:"ml-1 my-auto",color:"primaryBtn",name:"infoCircle",size:18})})]})]}),e.jsxs(d,{row:!0,className:"w-full grid grid-cols-2 justify-center gap-5 mt-2",children:[e.jsx(d,{col:!0,className:"self-stretch",children:e.jsxs(Ue,{className:"!rounded-2xl pt-2 !pb-0 !gap-0",type:"primary",children:[e.jsx(d,{alignCenter:!0,className:"cursor-pointer",justify:"between",children:e.jsxs(d,{alignCenter:!0,flex:1,justify:"between",children:[e.jsxs(d,{center:!0,children:[e.jsx(d,{col:!0,children:e.jsx(ie,{asset:b.from({asset:"THOR.RUNE"}),size:32})}),e.jsx(g,{className:re("mx-1 md:mx-3 !transition-all"),fontWeight:"semibold",children:s.asset.ticker})]}),e.jsxs(C,{children:[e.jsxs(g,{fontWeight:"bold",children:[(Q=s.value)==null?void 0:Q.toSignificant(8)," ",s.asset.ticker]}),e.jsx(g,{children:"\xA0"}),e.jsx(g,{fontWeight:"light",children:`(${_(s.value)})`})]})]})}),e.jsx(d,{className:"gap-2",children:e.jsx(W,{horizontalInset:!0,className:"my-3",items:xe,size:"sm"})})]})}),e.jsxs(d,{col:!0,className:re("flex h-full",t&&"w-full"),children:[e.jsx(k,{stretch:!0,className:"!rounded-2xl md:!rounded-3xl !p-4 flex-col items-center self-stretch space-y-1 shadow-lg md:w-full md:h-auto",size:"lg",children:e.jsxs(d,{col:!0,className:"self-stretch gap-2",children:[e.jsx(Le,{onChange:i=>fe(i),tabs:pe,value:l}),l===j.Withdraw?e.jsx(Ve,{onChange:he,percent:n,title:o("common.withdrawPercent")}):e.jsx(Me,{noFilters:!0,hideZeroPrice:!0,singleAsset:!0,assets:[{asset:b.from({asset:"THOR.RUNE"})}],className:"flex-1",onAssetChange:()=>!1,onValueChange:P,poolAsset:E,selectedAsset:E}),e.jsx(d,{className:"self-stretch pt-5",children:O?e.jsx(d,{className:"w-full",children:e.jsx(ne,{stretch:!0,disabled:Z,error:Z,onClick:()=>we(),size:"lg",tooltipClasses:"text-center mx-[-2px]",variant:"fancy",children:h?o("common.deposit"):o("common.withdraw")})}):e.jsx(ne,{stretch:!0,onClick:()=>H(!0),size:"lg",variant:"fancy",children:o("common.connectWallet")})})]})}),J&&e.jsx(We,{buttonDisabled:!(u.gt(0)||n.gt(0)),inputAssets:[y],isOpened:J,onClose:()=>S(!1),onConfirm:()=>ge(),children:e.jsxs(d,{col:!0,className:"mb-5 gap-2",children:[e.jsx(C,{className:"flex flex-col",children:ve.map(({label:i,value:x,icon:B})=>e.jsx(De,{label:i,value:e.jsxs(d,{center:!0,className:"gap-1",children:[e.jsx(g,{textStyle:"caption",children:x}),B&&e.jsx(ie,{asset:B,size:22})]})},i))}),e.jsx(le,{className:"m-auto !pt-2 !pb-1 !px-2 w-full",content:o("views.runePool.confirmModalInfoContent"),contentClassName:"py-0",title:o("views.runePool.confirmModalInfoTitle"),type:"warn"})]})})]})]})]})}});export{Je as __tla,oe as default};
