function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["CRWIkueS.js","assets/index-CyIKZwcA.js","assets/index-C3LuW5Z2.css","MzI8SiIl.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r,j as e,q as o,w as b,bO as D,D as f,I as j,t,bt as O,bE as W,ab as C,z,aM as E,T as m,L as le,M as oe,aa as I,am as K,bP as ce,ak as de,p as xe,E as ue,bb as R,ag as me,a9 as ge,bF as he,bQ as pe,aF as ye,aE as be,aL as fe,G as je,__tla as ve}from"./assets/index-CyIKZwcA.js";import{P as we}from"./GQQXxAVl.js";import{u as H,S as P,a as Se,b as Ne}from"./BSwmatAe.js";import{V as ke}from"./DA3rLf5F.js";import{F as Te}from"./C7jX1ZPo.js";import{u as Be}from"./Dk64sxA0.js";import"./Cm6z4UIW.js";let $,_e=Promise.all([(()=>{try{return ve}catch{}})()]).then(async()=>{(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new Error().stack;s&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[s]="9dc70ff0-5181-4a2a-a87e-3bd1263c23ac",a._sentryDebugIdIdentifier="sentry-dbid-9dc70ff0-5181-4a2a-a87e-3bd1263c23ac")}catch{}})();const A=r.memo(()=>e.jsxs("div",{className:"w-[16px] h-[16px] absolute bottom-0 right-0 pointer-events-none !bg-light-bg-primary dark:!bg-dark-gray-light",children:[e.jsx("div",{className:"w-[10px] border-0 border-t border-solid border-light-typo-gray dark:border-dark-typo-gray -rotate-45 rounded absolute top-1/2 left-1/3"}),e.jsx("div",{className:"w-[4px] border-0 border-t border-solid border-light-typo-gray dark:border-dark-typo-gray -rotate-45 ml-[5px] mt-[2px] rounded absolute top-1/2 left-1/3"})]})),J=r.forwardRef(({className:a,hasError:s,...c},n)=>{const x=r.useRef(null),[i,l]=r.useState(!1),d=r.useCallback(()=>{l(!0)},[]),u=r.useCallback(()=>{l(!1)},[]);return e.jsx(o,{col:!0,className:b("px-2 py-2 self-stretch !bg-light-bg-primary dark:!bg-dark-gray-light !rounded-2xl md:!rounded-3xl transition-all duration-300","border border-transparent border-solid hover:border-light-gray-primary dark:hover:border-dark-gray-primary",{[D]:i,"!border-red":s},a),onClick:focus,children:e.jsx(o,{alignCenter:!0,className:"gap-3",children:e.jsxs(o,{className:"flex-1 relative",children:[e.jsx(A,{}),e.jsx("textarea",{className:b("py-2 px-2 md:px-4 font-primary bg-transparent dark:placeholder-dark-typo-gray dark:text-dark-typo-primary placeholder-light-typo-gray text-light-typo-primary transition-colors","border-none font-normal text-[14px] focus:outline-none resize-y",a),onBlur:u,onFocus:d,ref:n||x,...c})]})})})}),L=r.forwardRef(({className:a,error:s,copyMessage:c,value:n,...x},i)=>{const l=()=>{const d=n==null?void 0:n.toString();if(d){O(d);const u=c||t("common.valueCopied");W(u)}};return e.jsxs(o,{col:!0,className:"relative",flex:1,children:[e.jsx(J,{...x,className:b("flex-1 min-h-[100px]",a),ref:i,value:n}),e.jsx(o,{className:"absolute top-2 right-5",children:e.jsx(f,{className:"!px-2 h-[30px]",onClick:l,rightIcon:e.jsx(j,{name:"copy",size:14}),variant:"borderlessTint",children:t("common.copy")})}),x.hasError&&!!s&&e.jsx(Te,{hasError:!0,label:s})]})}),F=({canBroadcast:a,txHash:s,txBodyStr:c})=>{const[n,x]=r.useState(!1),[i,l]=r.useState("");return r.useEffect(()=>{C(()=>import("./CRWIkueS.js"),__vite__mapDeps([0,1,2])).then(({getSwapKitClient:d})=>d()).then(({getExplorerTxUrl:d})=>l(s?d({chain:z.THORChain,txHash:s}):""))},[l,s]),s?e.jsx(E,{className:"self-stretch flex-1",type:"success",children:e.jsx(o,{className:"self-stretch m-2",children:e.jsxs(o,{className:"self-stretch w-full",flex:1,children:[e.jsx(m,{textStyle:"caption",variant:"green",children:t("views.multisig.txBroadcasted")}),e.jsx(le,{to:i,children:e.jsxs(o,{center:!0,children:[e.jsx(m,{className:"underline ml-1.5",fontWeight:"bold",textStyle:"caption",variant:"green",children:t("views.multisig.viewTx")}),e.jsx(j,{color:"green",name:"external",size:14})]})})]})})}):e.jsxs(E,{className:"self-stretch flex-1",type:a?"info":"warn",children:[e.jsxs(o,{alignCenter:!0,className:"self-stretch ml-2.5",justify:"between",children:[a?e.jsxs(m,{textStyle:"caption",variant:"primaryBtn",children:[t("views.multisig.pendingTx")," - ",t("views.multisig.txReadyToBroadcast")]}):e.jsxs(m,{textStyle:"caption",variant:"yellow",children:[t("views.multisig.pendingTx")," - ",t("views.multisig.txMissingSignatures")]}),e.jsx(f,{onClick:()=>x(!0),variant:"borderlessTint",children:t("views.multisig.viewTxData")})]}),e.jsx(oe,{isOpened:n,onClose:()=>x(!1),title:t("views.multisig.transactionData"),children:e.jsx(o,{className:"w-full self-stretch min-w-[330px] md:min-w-[400px]",flex:1,children:e.jsx(L,{disabled:!0,className:"flex-1 h-[50vh] max-h-[60vh]",copyMessage:t("views.multisig.transactionCopied"),value:c})})})]})},V=a=>{const{signTx:s,broadcastTx:c,pubKey:n}=Be(),{members:x,threshold:i}=I(({multisig:g})=>g),l=r.useMemo(()=>(a==null?void 0:a.tx)||null,[a==null?void 0:a.tx]),d=r.useMemo(()=>(a==null?void 0:a.members)||[],[a==null?void 0:a.members]),[u,k]=r.useState((a==null?void 0:a.signatures)||[]),[T,v]=r.useState(""),[w,S]=r.useState(!1),[p,h]=r.useState((a==null?void 0:a.bodyBytes)||[]),X=JSON.stringify(l,null,2)||"",Z=u.length>=i,ee=r.useMemo(()=>n&&u.find(g=>g.pubKey===n)||null,[n,u]),ae=r.useMemo(()=>l?{txBody:l,members:x,threshold:i,signatures:u,bodyBytes:p}:null,[u,l,p,x,i]),B=r.useCallback(g=>{k(y=>{const N=y.findIndex(ne=>ne.pubKey===g.pubKey),_=[...y];return N>-1?_[N]=g:_.push(g),_})},[]),se=r.useCallback(async()=>{if(!n)return K(t("views.multisig.incorrectSigner"));const g=await s(JSON.stringify(l));if(g===void 0)throw Error(`Unable to sign: ${JSON.stringify(l)}`);const{signature:y,bodyBytes:N}=g;B({pubKey:n,signature:y}),h(Array.from(N))},[B,n,s,l]),te=r.useMemo(()=>[{label:t("common.amount"),value:"test amount"},{label:t("common.recipient"),value:"test recipient"}],[]),re=r.useCallback(async()=>{S(!0);const g=await c(JSON.stringify(l),u,i,p);S(!1),g&&v(g)},[c,u,l,i,p]),ie=r.useCallback(g=>!!u.find(y=>y.pubKey===g.pubKey),[u]);return{txBodyStr:X,txInfo:te,signatures:u,addSigner:B,txData:l,canBroadcast:Z,handleBroadcast:re,isBroadcasting:w,broadcastedTxHash:T,requiredSigners:d,hasMemberSignature:ie,connectedSignature:ee,exportTxData:ae,handleSign:se}};function q({canBroadcast:a,handleBroadcast:s,isBroadcasting:c}){const{setStep:n}=H();return r.useEffect(()=>{a&&n(2)},[a,n]),e.jsx(o,{col:!0,className:"self-stretch mx-2",flex:1,children:e.jsxs(o,{col:!0,className:"gap-6",children:[a?e.jsx(m,{fontWeight:"normal",textStyle:"caption",children:t("views.multisig.broadcastTxInfo")}):e.jsx(E,{content:t("views.multisig.broadcastTxInfoBlocked"),type:"warn"}),e.jsx(f,{stretch:!0,disabled:!a,error:!a,loading:c,onClick:s,size:"lg",variant:"fancy",children:t("views.multisig.broadcast")})]})})}const U="thorsafetx",Y=({exportTxData:a,signatures:s})=>{const c=I(({multisig:i})=>i.members),n=r.useMemo(()=>{if(!(s!=null&&s.length))return"unsigned";const i=s.map(l=>{var d;return((d=c.find(u=>u.pubKey===l.pubKey))==null?void 0:d.name)||""});return i.every(Boolean)?`signed-${i.join("_")}`:`signed-${s.length}_members`},[c,s]),x=r.useCallback(async()=>{if(!a){K("Missing tx data to export.");return}try{await ce(`${U}-${n}.json`,JSON.stringify(a))}catch(i){de(i);const l=i.message||t("views.multisig.exportError");K(l,void 0,void 0,i)}},[a,n]);return e.jsxs(o,{col:!0,className:"self-stretch mx-2",flex:1,children:[e.jsxs(o,{col:!0,className:"gap-2 mt-6",children:[e.jsx(m,{fontWeight:"normal",textStyle:"caption",children:t("views.multisig.exportTxInfo")}),e.jsx(f,{stretch:!0,onClick:x,rightIcon:e.jsx(j,{name:"export"}),children:t("views.multisig.export")})]}),e.jsx(P,{})]})},G=({pubKey:a,signature:s})=>{const c=()=>{O(`${a} --> ${s}`),W(t("views.multisig.signatureCopied"))};return e.jsx(xe,{content:t("views.multisig.copyYourSignature"),children:e.jsx(o,{center:!0,className:"cursor-pointer",flex:1,onClick:c,children:e.jsxs(ue,{className:b(R.primary,"!py-2 !px-4 truncate overflow-hidden"),children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(m,{textStyle:"caption",variant:"secondary",children:t("views.multisig.yourSignature")}),e.jsx(j,{className:"px-2",name:"copy",size:16})]}),e.jsx(m,{className:"break-all whitespace-normal",textStyle:"caption",children:s})]})})},s)};function Q({handleSign:a,connectedSignature:s}){const{setIsConnectModalOpen:c}=me(),{getWalletAddress:n}=ge(),{nextStep:x}=H(),i=n(z.THORChain),l=r.useCallback(()=>{if(!i){c(!0);return}a()},[i,c,a]);return r.useEffect(()=>{s&&x()},[s,x]),e.jsxs(o,{col:!0,className:"self-stretch mx-2",flex:1,children:[e.jsxs(o,{col:!0,className:"gap-2",children:[e.jsx(m,{fontWeight:"normal",textStyle:"caption",children:t("views.multisig.addYourSignatureInfo")}),s?e.jsx(G,{pubKey:s.pubKey,signature:s.signature}):e.jsx(f,{stretch:!0,onClick:l,variant:"primary",children:i?t("views.multisig.signTx"):t("common.connectWallet")})]}),e.jsx(P,{backHidden:!0})]})}let M;M=({signer:a,onClick:s,isSelected:c})=>{const[n,x]=r.useState("");return r.useEffect(()=>{(async()=>{const{encodeSecp256k1Pubkey:i}=await C(()=>import("./MzI8SiIl.js").then(d=>d.i),__vite__mapDeps([3,1,2])),{base64:l}=await C(()=>import("./assets/index-CyIKZwcA.js").then(async d=>(await d.__tla,d)).then(d=>d.hl),__vite__mapDeps([1,2]));return(await pe()).pubkeyToAddress(i(l.decode(a.pubKey)),"thor")})().then(x)},[a.pubKey]),e.jsx(o,{center:!0,className:b("gap-2",{"cursor-pointer":!!s}),flex:1,onClick:()=>s==null?void 0:s(a),children:e.jsxs(o,{alignCenter:!0,className:b("truncate overflow-hidden flex-1 rounded-2xl px-4 py-2 gap-2",R.secondary,{[D]:c,[he]:!!s||c}),children:[e.jsx(j,{color:c?"primaryBtn":"secondary",name:c?"checkBoxChecked":"checkBoxBlank",size:20}),e.jsxs(o,{col:!0,className:"gap-1",children:[e.jsx("div",{className:"flex justify-between",children:e.jsxs(m,{textStyle:"caption-xs",variant:"secondary",children:[a.name,e.jsx("br",{}),n]})}),e.jsx(m,{className:"break-all whitespace-normal",textStyle:"caption-xs",children:a.pubKey})]})]})},a.pubKey)},$=()=>{const{state:a}=ye(),s=be(),{txBodyStr:c,signatures:n,handleSign:x,canBroadcast:i,handleBroadcast:l,isBroadcasting:d,broadcastedTxHash:u,requiredSigners:k,hasMemberSignature:T,connectedSignature:v,exportTxData:w}=V(a),{threshold:S}=I(({multisig:h})=>h);r.useEffect(()=>{a||s(fe.TxImport)});const p=r.useMemo(()=>[{id:0,label:t("views.multisig.signTx"),content:e.jsx(Q,{connectedSignature:v,handleSign:x})},{id:1,label:t("views.multisig.exportTxWithSignatures"),content:e.jsx(Y,{exportTxData:w,signatures:n}),tooltip:t("views.multisig.exportTxWithSignaturesTooltip")},{id:2,label:t("views.multisig.broadcastTx"),content:e.jsx(q,{canBroadcast:i,handleBroadcast:l,isBroadcasting:d}),tooltip:t("views.multisig.exportTxWithSignaturesTooltip")}],[i,v,w,l,x,d,n]);return e.jsxs(o,{col:!0,children:[e.jsx(we,{header:e.jsx(ke,{title:t("views.multisig.finalizeTransaction")}),title:t("views.multisig.finalizeTransaction"),children:e.jsxs(o,{col:!0,className:"w-full gap-1",children:[e.jsx(F,{canBroadcast:i,txBodyStr:c,txHash:u}),e.jsx(o,{col:!0,flex:1,children:e.jsx(je,{className:"!bg-light-bg-primary dark:!bg-dark-gray-light ",title:e.jsxs(o,{align:"end",className:"gap-1 my-1.5",children:[e.jsxs(m,{className:"leading-[24px]",textStyle:"body",children:[t("views.multisig.requiredSignatures"),":"]}),e.jsx(m,{textStyle:"subtitle1",variant:"primaryBtn",children:n.length}),e.jsx(m,{className:"leading-[24px]",textStyle:"body",children:"of"}),e.jsx(m,{textStyle:"subtitle1",variant:"primaryBtn",children:S})]}),children:e.jsxs(o,{col:!0,className:"gap-1",children:[e.jsx(m,{className:"mb-2",fontWeight:"normal",textStyle:"caption",variant:"secondary",children:t("views.multisig.txSignaturesInfo")}),k.map(h=>e.jsx(M,{isSelected:T(h),signer:h},h.pubKey))]})})})]})}),e.jsx(o,{col:!0,className:"mt-6 max-w-[480px] self-center w-full",children:e.jsx(Se,{steps:p,children:e.jsx(Ne,{})})})]})}});export{_e as __tla,$ as default};
