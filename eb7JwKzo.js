function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["DKagIk-m.js","assets/index-CyIKZwcA.js","assets/index-C3LuW5Z2.css","Dqpzwe9K.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{ab as Gm,gy as Ms,en as be,gI as Ei,h9 as Ym,dM as Qm,hi as Jm,gz as Xm,gD as Lt,cE as ur,hj as Ct,gP as Ka,__tla as Zm}from"./assets/index-CyIKZwcA.js";import{M as e0}from"./Dqpzwe9K.js";let ks,_i,Ae,za,Si,Ha,dt,zr,Va,jt,t0=Promise.all([(()=>{try{return Zm}catch{}})()]).then(async()=>{(function(){try{var e=typeof window<"u"?window:typeof be<"u"?be:typeof self<"u"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="b8521c59-1aaf-4bc3-8ea3-05ffec91a2b3",e._sentryDebugIdIdentifier="sentry-dbid-b8521c59-1aaf-4bc3-8ea3-05ffec91a2b3")}catch{}})();const qa=Symbol(),Fs=Object.getPrototypeOf,Ii=new WeakMap,$a=e=>e&&(Ii.has(e)?Ii.get(e):Fs(e)===Object.prototype||Fs(e)===Array.prototype),Ba=e=>$a(e)&&e[qa]||null,Ks=(e,t=!0)=>{Ii.set(e,t)};var Hr={VITE_NETWORK:"mainnet",VITE_THORSWAP_API:"https://api.thorswap.net/",VITE_THORSWAP_DEV_API:"https://dev-api.thorswap.net/",VITE_THORSWAP_STATIC_API:"https://static.thorswap.net/",VITE_MAINNET_MIDGARD:"https://midgard-stage-a.thorswap.net/",VITE_MAINNET_THORNODE:"https://thornode.ninerealms.org/",VITE_WALLETCONNECT_PROJECT_ID:"f2ec95d515e61deb4f80ead9b4501212",VITE_ETHERSCAN_API_KEY:"ZCJ7M3BDZXZACJ9EI7NG2RX1Q1HIIGR8WA",VITE_ETHPLORER_API_KEY:"freekey",VITE_COVALENT_API_KEY:"ckey_efd77fcec8314503b97bb7667cb",VITE_BLOCKCHAIR_API_KEY:"C___DSXrweUGKTv3bucm2FbHLCiBfPNO",VITE_DEV_API:"false",VITE_STAGENET:"false",VITE_PROD:"true",VITE_LEDGER_LIVE:"false",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Oi=e=>typeof e=="object"&&e!==null,Nt=new WeakMap,Vr=new WeakSet,Wa=(e=Object.is,t=(c,d)=>new Proxy(c,d),r=c=>Oi(c)&&!Vr.has(c)&&(Array.isArray(c)||!(Symbol.iterator in c))&&!(c instanceof WeakMap)&&!(c instanceof WeakSet)&&!(c instanceof Error)&&!(c instanceof Number)&&!(c instanceof Date)&&!(c instanceof String)&&!(c instanceof RegExp)&&!(c instanceof ArrayBuffer),i=c=>{switch(c.status){case"fulfilled":return c.value;case"rejected":throw c.reason;default:throw c}},s=new WeakMap,n=(c,d,f=i)=>{const g=s.get(c);if((g==null?void 0:g[0])===d)return g[1];const m=Array.isArray(c)?[]:Object.create(Object.getPrototypeOf(c));return Ks(m,!0),s.set(c,[d,m]),Reflect.ownKeys(c).forEach(w=>{if(Object.getOwnPropertyDescriptor(m,w))return;const N=Reflect.get(c,w),R={value:N,enumerable:!0,configurable:!0};if(Vr.has(N))Ks(N,!1);else if(N instanceof Promise)delete R.value,R.get=()=>f(N);else if(Nt.has(N)){const[U,E]=Nt.get(N);R.value=n(U,E(),f)}Object.defineProperty(m,w,R)}),Object.preventExtensions(m)},l=new WeakMap,u=[1,1],h=c=>{if(!Oi(c))throw new Error("object required");const d=l.get(c);if(d)return d;let f=u[0];const g=new Set,m=(p,A=++u[0])=>{f!==A&&(f=A,g.forEach(P=>P(p,A)))};let w=u[1];const N=(p=++u[1])=>(w!==p&&!g.size&&(w=p,U.forEach(([A])=>{const P=A[1](p);P>f&&(f=P)})),f),R=p=>(A,P)=>{const H=[...A];H[1]=[p,...H[1]],m(H,P)},U=new Map,E=(p,A)=>{if((Hr?"production":void 0)!=="production"&&U.has(p))throw new Error("prop listener already exists");if(g.size){const P=A[3](R(p));U.set(p,[A,P])}else U.set(p,[A])},S=p=>{var A;const P=U.get(p);P&&(U.delete(p),(A=P[1])==null||A.call(P))},y=p=>(g.add(p),g.size===1&&U.forEach(([A,P],H)=>{if((Hr?"production":void 0)!=="production"&&P)throw new Error("remove already exists");const B=A[3](R(H));U.set(H,[A,B])}),()=>{g.delete(p),g.size===0&&U.forEach(([A,P],H)=>{P&&(P(),U.set(H,[A]))})}),v=Array.isArray(c)?[]:Object.create(Object.getPrototypeOf(c)),b=t(v,{deleteProperty(p,A){const P=Reflect.get(p,A);S(A);const H=Reflect.deleteProperty(p,A);return H&&m(["delete",[A],P]),H},set(p,A,P,H){const B=Reflect.has(p,A),W=Reflect.get(p,A,H);if(B&&(e(W,P)||l.has(P)&&e(W,l.get(P))))return!0;S(A),Oi(P)&&(P=Ba(P)||P);let T=P;if(P instanceof Promise)P.then(C=>{P.status="fulfilled",P.value=C,m(["resolve",[A],C])}).catch(C=>{P.status="rejected",P.reason=C,m(["reject",[A],C])});else{!Nt.has(P)&&r(P)&&(T=h(P));const C=!Vr.has(T)&&Nt.get(T);C&&E(A,C)}return Reflect.set(p,A,T,H),m(["set",[A],P,W]),!0}});l.set(c,b);const o=[v,N,n,y];return Nt.set(b,o),Reflect.ownKeys(c).forEach(p=>{const A=Object.getOwnPropertyDescriptor(c,p);"value"in A&&(b[p]=c[p],delete A.value,delete A.writable),Object.defineProperty(v,p,A)}),b})=>[h,Nt,Vr,e,t,r,i,s,n,l,u],[Ga]=Wa();function Tt(e={}){return Ga(e)}function Mt(e,t,r){const i=Nt.get(e);(Hr?"production":void 0)!=="production"&&!i&&console.warn("Please use proxy object");let s;const n=[],l=i[3];let u=!1;const h=l(c=>{if(n.push(c),r){t(n.splice(0));return}s||(s=Promise.resolve().then(()=>{s=void 0,u&&t(n.splice(0))}))});return u=!0,()=>{u=!1,h()}}function Ya(e,t){const r=Nt.get(e);(Hr?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");const[i,s,n]=r;return n(i,s(),t)}let Se,zs,Pe,ft,lr;Se=Tt({history:["ConnectWallet"],view:"ConnectWallet",data:void 0}),_i={state:Se,subscribe(e){return Mt(Se,()=>e(Se))},push(e,t){e!==Se.view&&(Se.view=e,t&&(Se.data=t),Se.history.push(e))},reset(e){Se.view=e,Se.history=[e]},replace(e){Se.history.length>1&&(Se.history[Se.history.length-1]=e,Se.view=e)},goBack(){if(Se.history.length>1){Se.history.pop();const[e]=Se.history.slice(-1);Se.view=e}},setData(e){Se.data=e}},Ae={WALLETCONNECT_DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",WCM_VERSION:"WCM_VERSION",RECOMMENDED_WALLET_AMOUNT:9,isMobile(){return typeof window<"u"?!!(window.matchMedia("(pointer:coarse)").matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},isAndroid(){return Ae.isMobile()&&navigator.userAgent.toLowerCase().includes("android")},isIos(){const e=navigator.userAgent.toLowerCase();return Ae.isMobile()&&(e.includes("iphone")||e.includes("ipad"))},isHttpUrl(e){return e.startsWith("http://")||e.startsWith("https://")},isArray(e){return Array.isArray(e)&&e.length>0},formatNativeUrl(e,t,r){if(Ae.isHttpUrl(e))return this.formatUniversalUrl(e,t,r);let i=e;i.includes("://")||(i=e.replaceAll("/","").replaceAll(":",""),i=`${i}://`),i.endsWith("/")||(i=`${i}/`),this.setWalletConnectDeepLink(i,r);const s=encodeURIComponent(t);return`${i}wc?uri=${s}`},formatUniversalUrl(e,t,r){if(!Ae.isHttpUrl(e))return this.formatNativeUrl(e,t,r);let i=e;i.endsWith("/")||(i=`${i}/`),this.setWalletConnectDeepLink(i,r);const s=encodeURIComponent(t);return`${i}wc?uri=${s}`},async wait(e){return new Promise(t=>{setTimeout(t,e)})},openHref(e,t){window.open(e,t,"noreferrer noopener")},setWalletConnectDeepLink(e,t){try{localStorage.setItem(Ae.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},setWalletConnectAndroidDeepLink(e){try{const[t]=e.split("?");localStorage.setItem(Ae.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:t,name:"Android"}))}catch{console.info("Unable to set WalletConnect android deep link")}},removeWalletConnectDeepLink(){try{localStorage.removeItem(Ae.WALLETCONNECT_DEEPLINK_CHOICE)}catch{console.info("Unable to remove WalletConnect deep link")}},setModalVersionInStorage(){try{typeof localStorage<"u"&&localStorage.setItem(Ae.WCM_VERSION,"2.6.2")}catch{console.info("Unable to set Web3Modal version in storage")}},getWalletRouterData(){var e;const t=(e=_i.state.data)==null?void 0:e.Wallet;if(!t)throw new Error('Missing "Wallet" view data');return t}},zs=typeof location<"u"&&(location.hostname.includes("localhost")||location.protocol.includes("https")),Pe=Tt({enabled:zs,userSessionId:"",events:[],connectedWalletId:void 0}),ks={state:Pe,subscribe(e){return Mt(Pe.events,()=>e(Ya(Pe.events[Pe.events.length-1])))},initialize(){Pe.enabled&&typeof(crypto==null?void 0:crypto.randomUUID)<"u"&&(Pe.userSessionId=crypto.randomUUID())},setConnectedWalletId(e){Pe.connectedWalletId=e},click(e){if(Pe.enabled){const t={type:"CLICK",name:e.name,userSessionId:Pe.userSessionId,timestamp:Date.now(),data:e};Pe.events.push(t)}},track(e){if(Pe.enabled){const t={type:"TRACK",name:e.name,userSessionId:Pe.userSessionId,timestamp:Date.now(),data:e};Pe.events.push(t)}},view(e){if(Pe.enabled){const t={type:"VIEW",name:e.name,userSessionId:Pe.userSessionId,timestamp:Date.now(),data:e};Pe.events.push(t)}}},ft=Tt({chains:void 0,walletConnectUri:void 0,isAuth:!1,isCustomDesktop:!1,isCustomMobile:!1,isDataLoaded:!1,isUiLoaded:!1}),dt={state:ft,subscribe(e){return Mt(ft,()=>e(ft))},setChains(e){ft.chains=e},setWalletConnectUri(e){ft.walletConnectUri=e},setIsCustomDesktop(e){ft.isCustomDesktop=e},setIsCustomMobile(e){ft.isCustomMobile=e},setIsDataLoaded(e){ft.isDataLoaded=e},setIsUiLoaded(e){ft.isUiLoaded=e},setIsAuth(e){ft.isAuth=e}},lr=Tt({projectId:"",mobileWallets:void 0,desktopWallets:void 0,walletImages:void 0,chains:void 0,enableAuthMode:!1,enableExplorer:!0,explorerExcludedWalletIds:void 0,explorerRecommendedWalletIds:void 0,termsOfServiceUrl:void 0,privacyPolicyUrl:void 0}),jt={state:lr,subscribe(e){return Mt(lr,()=>e(lr))},setConfig(e){var t,r;ks.initialize(),dt.setChains(e.chains),dt.setIsAuth(!!e.enableAuthMode),dt.setIsCustomMobile(!!((t=e.mobileWallets)!=null&&t.length)),dt.setIsCustomDesktop(!!((r=e.desktopWallets)!=null&&r.length)),Ae.setModalVersionInStorage(),Object.assign(lr,e)}};var Qa=Object.defineProperty,Hs=Object.getOwnPropertySymbols,Ja=Object.prototype.hasOwnProperty,Xa=Object.prototype.propertyIsEnumerable,Vs=(e,t,r)=>t in e?Qa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Za=(e,t)=>{for(var r in t||(t={}))Ja.call(t,r)&&Vs(e,r,t[r]);if(Hs)for(var r of Hs(t))Xa.call(t,r)&&Vs(e,r,t[r]);return e};const Ci="https://explorer-api.walletconnect.com",Ni="wcm",Ti="js-2.6.2";async function qr(e,t){const r=Za({sdkType:Ni,sdkVersion:Ti},t),i=new URL(e,Ci);return i.searchParams.append("projectId",jt.state.projectId),Object.entries(r).forEach(([s,n])=>{n&&i.searchParams.append(s,String(n))}),(await fetch(i)).json()}const kt={async getDesktopListings(e){return qr("/w3m/v1/getDesktopListings",e)},async getMobileListings(e){return qr("/w3m/v1/getMobileListings",e)},async getInjectedListings(e){return qr("/w3m/v1/getInjectedListings",e)},async getAllListings(e){return qr("/w3m/v1/getAllListings",e)},getWalletImageUrl(e){return`${Ci}/w3m/v1/getWalletImage/${e}?projectId=${jt.state.projectId}&sdkType=${Ni}&sdkVersion=${Ti}`},getAssetImageUrl(e){return`${Ci}/w3m/v1/getAssetImage/${e}?projectId=${jt.state.projectId}&sdkType=${Ni}&sdkVersion=${Ti}`}};var ec=Object.defineProperty,qs=Object.getOwnPropertySymbols,tc=Object.prototype.hasOwnProperty,rc=Object.prototype.propertyIsEnumerable,$s=(e,t,r)=>t in e?ec(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ic=(e,t)=>{for(var r in t||(t={}))tc.call(t,r)&&$s(e,r,t[r]);if(qs)for(var r of qs(t))rc.call(t,r)&&$s(e,r,t[r]);return e};let Ai,gt,Ft;Ai=Ae.isMobile(),gt=Tt({wallets:{listings:[],total:0,page:1},search:{listings:[],total:0,page:1},recomendedWallets:[]}),Va={state:gt,async getRecomendedWallets(){const{explorerRecommendedWalletIds:e,explorerExcludedWalletIds:t}=jt.state;if(e==="NONE"||t==="ALL"&&!e)return gt.recomendedWallets;if(Ae.isArray(e)){const r={recommendedIds:e.join(",")},{listings:i}=await kt.getAllListings(r),s=Object.values(i);s.sort((n,l)=>{const u=e.indexOf(n.id),h=e.indexOf(l.id);return u-h}),gt.recomendedWallets=s}else{const{chains:r,isAuth:i}=dt.state,s=r==null?void 0:r.join(","),n=Ae.isArray(t),l={page:1,sdks:i?"auth_v1":void 0,entries:Ae.RECOMMENDED_WALLET_AMOUNT,chains:s,version:2,excludedIds:n?t.join(","):void 0},{listings:u}=Ai?await kt.getMobileListings(l):await kt.getDesktopListings(l);gt.recomendedWallets=Object.values(u)}return gt.recomendedWallets},async getWallets(e){const t=ic({},e),{explorerRecommendedWalletIds:r,explorerExcludedWalletIds:i}=jt.state,{recomendedWallets:s}=gt;if(i==="ALL")return gt.wallets;s.length?t.excludedIds=s.map(f=>f.id).join(","):Ae.isArray(r)&&(t.excludedIds=r.join(",")),Ae.isArray(i)&&(t.excludedIds=[t.excludedIds,i].filter(Boolean).join(",")),dt.state.isAuth&&(t.sdks="auth_v1");const{page:n,search:l}=e,{listings:u,total:h}=Ai?await kt.getMobileListings(t):await kt.getDesktopListings(t),c=Object.values(u),d=l?"search":"wallets";return gt[d]={listings:[...gt[d].listings,...c],total:h,page:n??1},{listings:c,total:h}},getWalletImageUrl(e){return kt.getWalletImageUrl(e)},getAssetImageUrl(e){return kt.getAssetImageUrl(e)},resetSearch(){gt.search={listings:[],total:0,page:1}}},Ft=Tt({open:!1}),zr={state:Ft,subscribe(e){return Mt(Ft,()=>e(Ft))},async open(e){return new Promise(t=>{const{isUiLoaded:r,isDataLoaded:i}=dt.state;if(Ae.removeWalletConnectDeepLink(),dt.setWalletConnectUri(e==null?void 0:e.uri),dt.setChains(e==null?void 0:e.chains),_i.reset("ConnectWallet"),r&&i)Ft.open=!0,t();else{const s=setInterval(()=>{const n=dt.state;n.isUiLoaded&&n.isDataLoaded&&(clearInterval(s),Ft.open=!0,t())},200)}})},close(){Ft.open=!1}};var sc=Object.defineProperty,Bs=Object.getOwnPropertySymbols,nc=Object.prototype.hasOwnProperty,oc=Object.prototype.propertyIsEnumerable,Ws=(e,t,r)=>t in e?sc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ac=(e,t)=>{for(var r in t||(t={}))nc.call(t,r)&&Ws(e,r,t[r]);if(Bs)for(var r of Bs(t))oc.call(t,r)&&Ws(e,r,t[r]);return e};function cc(){return typeof matchMedia<"u"&&matchMedia("(prefers-color-scheme: dark)").matches}let Qt,At;Qt=Tt({themeMode:cc()?"dark":"light"}),Si={state:Qt,subscribe(e){return Mt(Qt,()=>e(Qt))},setThemeConfig(e){const{themeMode:t,themeVariables:r}=e;t&&(Qt.themeMode=t),r&&(Qt.themeVariables=ac({},r))}},At=Tt({open:!1,message:"",variant:"success"}),Ha={state:At,subscribe(e){return Mt(At,()=>e(At))},openToast(e,t){At.open=!0,At.message=e,At.variant=t},closeToast(){At.open=!1}};let uc=class{constructor(e){this.openModal=zr.open,this.closeModal=zr.close,this.subscribeModal=zr.subscribe,this.setTheme=Si.setThemeConfig,Si.setThemeConfig(e),jt.setConfig(e),this.initUi()}async initUi(){if(typeof window<"u"){await Gm(()=>import("./DKagIk-m.js").then(async t=>(await t.__tla,t)),__vite__mapDeps([0,1,2,3]));const e=document.createElement("wcm-modal");document.body.insertAdjacentElement("beforeend",e),dt.setIsUiLoaded(!0)}}};const lc=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,hc=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,dc=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function pc(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){fc(e);return}return t}function fc(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function $r(e,t={}){if(typeof e!="string")return e;const r=e.trim();if(e[0]==='"'&&e.endsWith('"')&&!e.includes("\\"))return r.slice(1,-1);if(r.length<=9){const i=r.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!dc.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(lc.test(e)||hc.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,pc)}return JSON.parse(e)}catch(i){if(t.strict)throw i;return e}}function gc(e){return!e||typeof e.then!="function"?Promise.resolve(e):e}function Oe(e,...t){try{return gc(e(...t))}catch(r){return Promise.reject(r)}}function yc(e){const t=typeof e;return e===null||t!=="object"&&t!=="function"}function mc(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}function Br(e){if(yc(e))return String(e);if(mc(e)||Array.isArray(e))return JSON.stringify(e);if(typeof e.toJSON=="function")return Br(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Gs(){if(typeof Ms===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Pi="base64:";function wc(e){if(typeof e=="string")return e;Gs();const t=Ms.from(e).toString("base64");return Pi+t}function Dc(e){return typeof e!="string"||!e.startsWith(Pi)?e:(Gs(),Ms.from(e.slice(Pi.length),"base64"))}function st(e){return e?e.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function bc(...e){return st(e.join(":"))}function Wr(e){return e=st(e),e?e+":":""}const vc="memory",Ec=()=>{const e=new Map;return{name:vc,options:{},hasItem(t){return e.has(t)},getItem(t){return e.get(t)??null},getItemRaw(t){return e.get(t)??null},setItem(t,r){e.set(t,r)},setItemRaw(t,r){e.set(t,r)},removeItem(t){e.delete(t)},getKeys(){return Array.from(e.keys())},clear(){e.clear()},dispose(){e.clear()}}};function _c(e={}){const t={mounts:{"":e.driver||Ec()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=c=>{for(const d of t.mountpoints)if(c.startsWith(d))return{base:d,relativeKey:c.slice(d.length),driver:t.mounts[d]};return{base:"",relativeKey:c,driver:t.mounts[""]}},i=(c,d)=>t.mountpoints.filter(f=>f.startsWith(c)||d&&c.startsWith(f)).map(f=>({relativeBase:c.length>f.length?c.slice(f.length):void 0,mountpoint:f,driver:t.mounts[f]})),s=(c,d)=>{if(t.watching){d=st(d);for(const f of t.watchListeners)f(c,d)}},n=async()=>{if(!t.watching){t.watching=!0;for(const c in t.mounts)t.unwatch[c]=await Ys(t.mounts[c],s,c)}},l=async()=>{if(t.watching){for(const c in t.unwatch)await t.unwatch[c]();t.unwatch={},t.watching=!1}},u=(c,d,f)=>{const g=new Map,m=w=>{let N=g.get(w.base);return N||(N={driver:w.driver,base:w.base,items:[]},g.set(w.base,N)),N};for(const w of c){const N=typeof w=="string",R=st(N?w:w.key),U=N?void 0:w.value,E=N||!w.options?d:{...d,...w.options},S=r(R);m(S).items.push({key:R,value:U,relativeKey:S.relativeKey,options:E})}return Promise.all([...g.values()].map(w=>f(w))).then(w=>w.flat())},h={hasItem(c,d={}){c=st(c);const{relativeKey:f,driver:g}=r(c);return Oe(g.hasItem,f,d)},getItem(c,d={}){c=st(c);const{relativeKey:f,driver:g}=r(c);return Oe(g.getItem,f,d).then(m=>$r(m))},getItems(c,d){return u(c,d,f=>f.driver.getItems?Oe(f.driver.getItems,f.items.map(g=>({key:g.relativeKey,options:g.options})),d).then(g=>g.map(m=>({key:bc(f.base,m.key),value:$r(m.value)}))):Promise.all(f.items.map(g=>Oe(f.driver.getItem,g.relativeKey,g.options).then(m=>({key:g.key,value:$r(m)})))))},getItemRaw(c,d={}){c=st(c);const{relativeKey:f,driver:g}=r(c);return g.getItemRaw?Oe(g.getItemRaw,f,d):Oe(g.getItem,f,d).then(m=>Dc(m))},async setItem(c,d,f={}){if(d===void 0)return h.removeItem(c);c=st(c);const{relativeKey:g,driver:m}=r(c);m.setItem&&(await Oe(m.setItem,g,Br(d),f),m.watch||s("update",c))},async setItems(c,d){await u(c,d,async f=>{if(f.driver.setItems)return Oe(f.driver.setItems,f.items.map(g=>({key:g.relativeKey,value:Br(g.value),options:g.options})),d);f.driver.setItem&&await Promise.all(f.items.map(g=>Oe(f.driver.setItem,g.relativeKey,Br(g.value),g.options)))})},async setItemRaw(c,d,f={}){if(d===void 0)return h.removeItem(c,f);c=st(c);const{relativeKey:g,driver:m}=r(c);if(m.setItemRaw)await Oe(m.setItemRaw,g,d,f);else if(m.setItem)await Oe(m.setItem,g,wc(d),f);else return;m.watch||s("update",c)},async removeItem(c,d={}){typeof d=="boolean"&&(d={removeMeta:d}),c=st(c);const{relativeKey:f,driver:g}=r(c);g.removeItem&&(await Oe(g.removeItem,f,d),(d.removeMeta||d.removeMata)&&await Oe(g.removeItem,f+"$",d),g.watch||s("remove",c))},async getMeta(c,d={}){typeof d=="boolean"&&(d={nativeOnly:d}),c=st(c);const{relativeKey:f,driver:g}=r(c),m=Object.create(null);if(g.getMeta&&Object.assign(m,await Oe(g.getMeta,f,d)),!d.nativeOnly){const w=await Oe(g.getItem,f+"$",d).then(N=>$r(N));w&&typeof w=="object"&&(typeof w.atime=="string"&&(w.atime=new Date(w.atime)),typeof w.mtime=="string"&&(w.mtime=new Date(w.mtime)),Object.assign(m,w))}return m},setMeta(c,d,f={}){return this.setItem(c+"$",d,f)},removeMeta(c,d={}){return this.removeItem(c+"$",d)},async getKeys(c,d={}){c=Wr(c);const f=i(c,!0);let g=[];const m=[];for(const w of f){const N=(await Oe(w.driver.getKeys,w.relativeBase,d)).map(R=>w.mountpoint+st(R)).filter(R=>!g.some(U=>R.startsWith(U)));m.push(...N),g=[w.mountpoint,...g.filter(R=>!R.startsWith(w.mountpoint))]}return c?m.filter(w=>w.startsWith(c)&&!w.endsWith("$")):m.filter(w=>!w.endsWith("$"))},async clear(c,d={}){c=Wr(c),await Promise.all(i(c,!1).map(async f=>{if(f.driver.clear)return Oe(f.driver.clear,f.relativeBase,d);if(f.driver.removeItem){const g=await f.driver.getKeys(f.relativeBase||"",d);return Promise.all(g.map(m=>f.driver.removeItem(m,d)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(c=>Qs(c)))},async watch(c){return await n(),t.watchListeners.push(c),async()=>{t.watchListeners=t.watchListeners.filter(d=>d!==c),t.watchListeners.length===0&&await l()}},async unwatch(){t.watchListeners=[],await l()},mount(c,d){if(c=Wr(c),c&&t.mounts[c])throw new Error(`already mounted at ${c}`);return c&&(t.mountpoints.push(c),t.mountpoints.sort((f,g)=>g.length-f.length)),t.mounts[c]=d,t.watching&&Promise.resolve(Ys(d,s,c)).then(f=>{t.unwatch[c]=f}).catch(console.error),h},async unmount(c,d=!0){c=Wr(c),!(!c||!t.mounts[c])&&(t.watching&&c in t.unwatch&&(t.unwatch[c](),delete t.unwatch[c]),d&&await Qs(t.mounts[c]),t.mountpoints=t.mountpoints.filter(f=>f!==c),delete t.mounts[c])},getMount(c=""){c=st(c)+":";const d=r(c);return{driver:d.driver,base:d.base}},getMounts(c="",d={}){return c=st(c),i(c,d.parents).map(f=>({driver:f.driver,base:f.mountpoint}))}};return h}function Ys(e,t,r){return e.watch?e.watch((i,s)=>t(i,r+s)):()=>{}}async function Qs(e){typeof e.dispose=="function"&&await Oe(e.dispose)}function Kt(e){return new Promise((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)})}function Js(e,t){const r=indexedDB.open(e);r.onupgradeneeded=()=>r.result.createObjectStore(t);const i=Kt(r);return(s,n)=>i.then(l=>n(l.transaction(t,s).objectStore(t)))}let Ri;function hr(){return Ri||(Ri=Js("keyval-store","keyval")),Ri}function Xs(e,t=hr()){return t("readonly",r=>Kt(r.get(e)))}function Sc(e,t,r=hr()){return r("readwrite",i=>(i.put(t,e),Kt(i.transaction)))}function Ic(e,t=hr()){return t("readwrite",r=>(r.delete(e),Kt(r.transaction)))}function Oc(e=hr()){return e("readwrite",t=>(t.clear(),Kt(t.transaction)))}function Cc(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Kt(e.transaction)}function Nc(e=hr()){return e("readonly",t=>{if(t.getAllKeys)return Kt(t.getAllKeys());const r=[];return Cc(t,i=>r.push(i.key)).then(()=>r)})}const Tc=e=>JSON.stringify(e,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Ac=e=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=e.replace(t,'$1"$2n"$3');return JSON.parse(r,(i,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Gr(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return Ac(e)}catch{return e}}function dr(e){return typeof e=="string"?e:Tc(e)||""}const Pc="idb-keyval";var Rc=(e={})=>{const t=e.base&&e.base.length>0?`${e.base}:`:"",r=s=>t+s;let i;return e.dbName&&e.storeName&&(i=Js(e.dbName,e.storeName)),{name:Pc,options:e,async hasItem(s){return!(typeof await Xs(r(s),i)>"u")},async getItem(s){return await Xs(r(s),i)??null},setItem(s,n){return Sc(r(s),n,i)},removeItem(s){return Ic(r(s),i)},getKeys(){return Nc(i)},clear(){return Oc(i)}}};const xc="WALLET_CONNECT_V2_INDEXED_DB",Uc="keyvaluestorage";let Lc=class{constructor(){this.indexedDb=_c({driver:Rc({dbName:xc,storeName:Uc})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,dr(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var xi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof be<"u"?be:typeof self<"u"?self:{},Yr={exports:{}};(function(){let e;function t(){}e=t,e.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},e.prototype.setItem=function(r,i){this[r]=String(i)},e.prototype.removeItem=function(r){delete this[r]},e.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},e.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof xi<"u"&&xi.localStorage?Yr.exports=xi.localStorage:typeof window<"u"&&window.localStorage?Yr.exports=window.localStorage:Yr.exports=new t})();function jc(e){var t;return[e[0],Gr((t=e[1])!=null?t:"")]}let Mc=class{constructor(){this.localStorage=Yr.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(jc)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Gr(t)}async setItem(e,t){this.localStorage.setItem(e,dr(t))}async removeItem(e){this.localStorage.removeItem(e)}};const kc="wc_storage_version",Zs=1,Fc=async(e,t,r)=>{const i=kc,s=await t.getItem(i);if(s&&s>=Zs){r(t);return}const n=await e.getKeys();if(!n.length){r(t);return}const l=[];for(;n.length;){const u=n.shift();if(!u)continue;const h=u.toLowerCase();if(h.includes("wc@")||h.includes("walletconnect")||h.includes("wc_")||h.includes("wallet_connect")){const c=await e.getItem(u);await t.setItem(u,c),l.push(u)}}await t.setItem(i,Zs),r(t),Kc(e,l)},Kc=async(e,t)=>{t.length&&t.forEach(async r=>{await e.removeItem(r)})};let zc=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new Mc;this.storage=e;try{const t=new Lc;Fc(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var Jt={},Ui=function(e,t){return Ui=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},Ui(e,t)};function Hc(e,t){Ui(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Li=function(){return Li=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Li.apply(this,arguments)};function Vc(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(r[i[s]]=e[i[s]]);return r}function qc(e,t,r,i){var s=arguments.length,n=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,r):i,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(e,t,r,i);else for(var u=e.length-1;u>=0;u--)(l=e[u])&&(n=(s<3?l(n):s>3?l(t,r,n):l(t,r))||n);return s>3&&n&&Object.defineProperty(t,r,n),n}function $c(e,t){return function(r,i){t(r,i,e)}}function Bc(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Wc(e,t,r,i){function s(n){return n instanceof r?n:new r(function(l){l(n)})}return new(r||(r=Promise))(function(n,l){function u(d){try{c(i.next(d))}catch(f){l(f)}}function h(d){try{c(i.throw(d))}catch(f){l(f)}}function c(d){d.done?n(d.value):s(d.value).then(u,h)}c((i=i.apply(e,t||[])).next())})}function Gc(e,t){var r={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,s,n,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(c){return function(d){return h([c,d])}}function h(c){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,s&&(n=c[0]&2?s.return:c[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,c[1])).done)return n;switch(s=0,n&&(c=[c[0]&2,n.value]),c[0]){case 0:case 1:n=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,s=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(n=r.trys,!(n=n.length>0&&n[n.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!n||c[1]>n[0]&&c[1]<n[3])){r.label=c[1];break}if(c[0]===6&&r.label<n[1]){r.label=n[1],n=c;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(c);break}n[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(d){c=[6,d],s=0}finally{i=n=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Yc(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}function Qc(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function ji(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function en(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var i=r.call(e),s,n=[],l;try{for(;(t===void 0||t-- >0)&&!(s=i.next()).done;)n.push(s.value)}catch(u){l={error:u}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(l)throw l.error}}return n}function Jc(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(en(arguments[t]));return e}function Xc(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),s=0,t=0;t<r;t++)for(var n=arguments[t],l=0,u=n.length;l<u;l++,s++)i[s]=n[l];return i}function pr(e){return this instanceof pr?(this.v=e,this):new pr(e)}function Zc(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(e,t||[]),s,n=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(g){i[g]&&(s[g]=function(m){return new Promise(function(w,N){n.push([g,m,w,N])>1||u(g,m)})})}function u(g,m){try{h(i[g](m))}catch(w){f(n[0][3],w)}}function h(g){g.value instanceof pr?Promise.resolve(g.value.v).then(c,d):f(n[0][2],g)}function c(g){u("next",g)}function d(g){u("throw",g)}function f(g,m){g(m),n.shift(),n.length&&u(n[0][0],n[0][1])}}function eu(e){var t,r;return t={},i("next"),i("throw",function(s){throw s}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(s,n){t[s]=e[s]?function(l){return(r=!r)?{value:pr(e[s](l)),done:s==="return"}:n?n(l):l}:n}}function tu(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof ji=="function"?ji(e):e[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(n){r[n]=e[n]&&function(l){return new Promise(function(u,h){l=e[n](l),s(u,h,l.done,l.value)})}}function s(n,l,u,h){Promise.resolve(h).then(function(c){n({value:c,done:u})},l)}}function ru(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function iu(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function su(e){return e&&e.__esModule?e:{default:e}}function nu(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function ou(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}const au=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Li},__asyncDelegator:eu,__asyncGenerator:Zc,__asyncValues:tu,__await:pr,__awaiter:Wc,__classPrivateFieldGet:nu,__classPrivateFieldSet:ou,__createBinding:Yc,__decorate:qc,__exportStar:Qc,__extends:Hc,__generator:Gc,__importDefault:su,__importStar:iu,__makeTemplateObject:ru,__metadata:Bc,__param:$c,__read:en,__rest:Vc,__spread:Jc,__spreadArrays:Xc,__values:ji},Symbol.toStringTag,{value:"Module"})),Qr=Ei(au);var fr={},$={},Mi=function(e,t){return Mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},Mi(e,t)};function cu(e,t){Mi(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ki=function(){return ki=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ki.apply(this,arguments)};function uu(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(r[i[s]]=e[i[s]]);return r}function lu(e,t,r,i){var s=arguments.length,n=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,r):i,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(e,t,r,i);else for(var u=e.length-1;u>=0;u--)(l=e[u])&&(n=(s<3?l(n):s>3?l(t,r,n):l(t,r))||n);return s>3&&n&&Object.defineProperty(t,r,n),n}function hu(e,t){return function(r,i){t(r,i,e)}}function du(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function pu(e,t,r,i){function s(n){return n instanceof r?n:new r(function(l){l(n)})}return new(r||(r=Promise))(function(n,l){function u(d){try{c(i.next(d))}catch(f){l(f)}}function h(d){try{c(i.throw(d))}catch(f){l(f)}}function c(d){d.done?n(d.value):s(d.value).then(u,h)}c((i=i.apply(e,t||[])).next())})}function fu(e,t){var r={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,s,n,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(c){return function(d){return h([c,d])}}function h(c){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,s&&(n=c[0]&2?s.return:c[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,c[1])).done)return n;switch(s=0,n&&(c=[c[0]&2,n.value]),c[0]){case 0:case 1:n=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,s=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(n=r.trys,!(n=n.length>0&&n[n.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!n||c[1]>n[0]&&c[1]<n[3])){r.label=c[1];break}if(c[0]===6&&r.label<n[1]){r.label=n[1],n=c;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(c);break}n[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(d){c=[6,d],s=0}finally{i=n=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function gu(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}function yu(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function Fi(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function tn(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var i=r.call(e),s,n=[],l;try{for(;(t===void 0||t-- >0)&&!(s=i.next()).done;)n.push(s.value)}catch(u){l={error:u}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(l)throw l.error}}return n}function mu(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(tn(arguments[t]));return e}function wu(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),s=0,t=0;t<r;t++)for(var n=arguments[t],l=0,u=n.length;l<u;l++,s++)i[s]=n[l];return i}function gr(e){return this instanceof gr?(this.v=e,this):new gr(e)}function Du(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(e,t||[]),s,n=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(g){i[g]&&(s[g]=function(m){return new Promise(function(w,N){n.push([g,m,w,N])>1||u(g,m)})})}function u(g,m){try{h(i[g](m))}catch(w){f(n[0][3],w)}}function h(g){g.value instanceof gr?Promise.resolve(g.value.v).then(c,d):f(n[0][2],g)}function c(g){u("next",g)}function d(g){u("throw",g)}function f(g,m){g(m),n.shift(),n.length&&u(n[0][0],n[0][1])}}function bu(e){var t,r;return t={},i("next"),i("throw",function(s){throw s}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(s,n){t[s]=e[s]?function(l){return(r=!r)?{value:gr(e[s](l)),done:s==="return"}:n?n(l):l}:n}}function vu(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Fi=="function"?Fi(e):e[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(n){r[n]=e[n]&&function(l){return new Promise(function(u,h){l=e[n](l),s(u,h,l.done,l.value)})}}function s(n,l,u,h){Promise.resolve(h).then(function(c){n({value:c,done:u})},l)}}function Eu(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function _u(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Su(e){return e&&e.__esModule?e:{default:e}}function Iu(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Ou(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}const Cu=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return ki},__asyncDelegator:bu,__asyncGenerator:Du,__asyncValues:vu,__await:gr,__awaiter:pu,__classPrivateFieldGet:Iu,__classPrivateFieldSet:Ou,__createBinding:gu,__decorate:lu,__exportStar:yu,__extends:cu,__generator:fu,__importDefault:Su,__importStar:_u,__makeTemplateObject:Eu,__metadata:du,__param:hu,__read:tn,__rest:uu,__spread:mu,__spreadArrays:wu,__values:Fi},Symbol.toStringTag,{value:"Module"})),Jr=Ei(Cu);var rn={},yr={},sn;function Nu(){if(sn)return yr;sn=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.delay=void 0;function e(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return yr.delay=e,yr}var zt={},nn={},Xt={},on;function Tu(){return on||(on=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.ONE_THOUSAND=Xt.ONE_HUNDRED=void 0,Xt.ONE_HUNDRED=100,Xt.ONE_THOUSAND=1e3),Xt}var an={},cn;function Au(){return cn||(cn=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=e.ONE_MINUTE*5,e.TEN_MINUTES=e.ONE_MINUTE*10,e.THIRTY_MINUTES=e.ONE_MINUTE*30,e.SIXTY_MINUTES=e.ONE_MINUTE*60,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=e.ONE_HOUR*3,e.SIX_HOURS=e.ONE_HOUR*6,e.TWELVE_HOURS=e.ONE_HOUR*12,e.TWENTY_FOUR_HOURS=e.ONE_HOUR*24,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=e.ONE_DAY*3,e.FIVE_DAYS=e.ONE_DAY*5,e.SEVEN_DAYS=e.ONE_DAY*7,e.THIRTY_DAYS=e.ONE_DAY*30,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=e.ONE_WEEK*2,e.THREE_WEEKS=e.ONE_WEEK*3,e.FOUR_WEEKS=e.ONE_WEEK*4,e.ONE_YEAR=e.ONE_DAY*365}(an)),an}var un;function ln(){return un||(un=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Jr;t.__exportStar(Tu(),e),t.__exportStar(Au(),e)}(nn)),nn}var hn;function Pu(){if(hn)return zt;hn=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.fromMiliseconds=zt.toMiliseconds=void 0;const e=ln();function t(i){return i*e.ONE_THOUSAND}zt.toMiliseconds=t;function r(i){return Math.floor(i/e.ONE_THOUSAND)}return zt.fromMiliseconds=r,zt}var dn;function Ru(){return dn||(dn=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Jr;t.__exportStar(Nu(),e),t.__exportStar(Pu(),e)}(rn)),rn}var Zt={},pn;function xu(){if(pn)return Zt;pn=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const s=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:s})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return Zt.Watch=e,Zt.default=e,Zt}var fn={},mr={},gn;function Uu(){if(gn)return mr;gn=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.IWatch=void 0;class e{}return mr.IWatch=e,mr}var yn;function Lu(){return yn||(yn=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Jr.__exportStar(Uu(),e)}(fn)),fn}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Jr;t.__exportStar(Ru(),e),t.__exportStar(xu(),e),t.__exportStar(Lu(),e),t.__exportStar(ln(),e)})($);var mn={},wr={};let Ht=class{};const ju=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Ht},Symbol.toStringTag,{value:"Module"})),Mu=Ei(ju);var wn;function ku(){if(wn)return wr;wn=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.IHeartBeat=void 0;const e=Mu;class t extends e.IEvents{constructor(i){super()}}return wr.IHeartBeat=t,wr}var Dn;function bn(){return Dn||(Dn=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Qr.__exportStar(ku(),e)}(mn)),mn}var vn={},Vt={},En;function Fu(){if(En)return Vt;En=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.HEARTBEAT_EVENTS=Vt.HEARTBEAT_INTERVAL=void 0;const e=$;return Vt.HEARTBEAT_INTERVAL=e.FIVE_SECONDS,Vt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Vt}var _n;function Sn(){return _n||(_n=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Qr.__exportStar(Fu(),e)}(vn)),vn}var In;function Ku(){if(In)return fr;In=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.HeartBeat=void 0;const e=Qr,t=Ym(),r=$,i=bn(),s=Sn();class n extends i.IHeartBeat{constructor(u){super(u),this.events=new t.EventEmitter,this.interval=s.HEARTBEAT_INTERVAL,this.interval=(u==null?void 0:u.interval)||s.HEARTBEAT_INTERVAL}static init(u){return e.__awaiter(this,void 0,void 0,function*(){const h=new n(u);return yield h.init(),h})}init(){return e.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(u,h){this.events.on(u,h)}once(u,h){this.events.once(u,h)}off(u,h){this.events.off(u,h)}removeListener(u,h){this.events.removeListener(u,h)}initialize(){return e.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(s.HEARTBEAT_EVENTS.pulse)}}return fr.HeartBeat=n,fr}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Qr;t.__exportStar(Ku(),e),t.__exportStar(bn(),e),t.__exportStar(Sn(),e)})(Jt);function zu(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var Hu=Vu;function Vu(e,t,r){var i=r&&r.stringify||zu,s=1;if(typeof e=="object"&&e!==null){var n=t.length+s;if(n===1)return e;var l=new Array(n);l[0]=i(e);for(var u=1;u<n;u++)l[u]=i(t[u]);return l.join(" ")}if(typeof e!="string")return e;var h=t.length;if(h===0)return e;for(var c="",d=1-s,f=-1,g=e&&e.length||0,m=0;m<g;){if(e.charCodeAt(m)===37&&m+1<g){switch(f=f>-1?f:0,e.charCodeAt(m+1)){case 100:case 102:if(d>=h||t[d]==null)break;f<m&&(c+=e.slice(f,m)),c+=Number(t[d]),f=m+2,m++;break;case 105:if(d>=h||t[d]==null)break;f<m&&(c+=e.slice(f,m)),c+=Math.floor(Number(t[d])),f=m+2,m++;break;case 79:case 111:case 106:if(d>=h||t[d]===void 0)break;f<m&&(c+=e.slice(f,m));var w=typeof t[d];if(w==="string"){c+="'"+t[d]+"'",f=m+2,m++;break}if(w==="function"){c+=t[d].name||"<anonymous>",f=m+2,m++;break}c+=i(t[d]),f=m+2,m++;break;case 115:if(d>=h)break;f<m&&(c+=e.slice(f,m)),c+=String(t[d]),f=m+2,m++;break;case 37:f<m&&(c+=e.slice(f,m)),c+="%",f=m+2,m++,d--;break}++d}++m}return f===-1?e:(f<g&&(c+=e.slice(f)),c)}const On=Hu;var qu=wt;const Dr=el().console||{},$u={mapHttpRequest:Zr,mapHttpResponse:Zr,wrapRequestSerializer:zi,wrapResponseSerializer:zi,wrapErrorSerializer:zi,req:Zr,res:Zr,err:Qu};function Bu(e,t){return Array.isArray(e)?e.filter(function(r){return r!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function wt(e){e=e||{},e.browser=e.browser||{};const t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=e.browser.write||Dr;e.browser.write&&(e.browser.asObject=!0);const i=e.serializers||{},s=Bu(e.browser.serialize,i);let n=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(n=!1);const l=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),e.enabled===!1&&(e.level="silent");const u=e.level||"info",h=Object.create(r);h.log||(h.log=br),Object.defineProperty(h,"levelVal",{get:d}),Object.defineProperty(h,"level",{get:f,set:g});const c={transmit:t,serialize:s,asObject:e.browser.asObject,levels:l,timestamp:Ju(e)};h.levels=wt.levels,h.level=u,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=br,h.serializers=i,h._serialize=s,h._stdErrSerialize=n,h.child=m,t&&(h._logEvent=Ki());function d(){return this.level==="silent"?1/0:this.levels.values[this.level]}function f(){return this._level}function g(w){if(w!=="silent"&&!this.levels.values[w])throw Error("unknown level "+w);this._level=w,er(c,h,"error","log"),er(c,h,"fatal","error"),er(c,h,"warn","error"),er(c,h,"info","log"),er(c,h,"debug","log"),er(c,h,"trace","log")}function m(w,N){if(!w)throw new Error("missing bindings for child Pino");N=N||{},s&&w.serializers&&(N.serializers=w.serializers);const R=N.serializers;if(s&&R){var U=Object.assign({},i,R),E=e.browser.serialize===!0?Object.keys(U):s;delete w.serializers,Xr([w],E,U,this._stdErrSerialize)}function S(y){this._childLevel=(y._childLevel|0)+1,this.error=tr(y,w,"error"),this.fatal=tr(y,w,"fatal"),this.warn=tr(y,w,"warn"),this.info=tr(y,w,"info"),this.debug=tr(y,w,"debug"),this.trace=tr(y,w,"trace"),U&&(this.serializers=U,this._serialize=E),t&&(this._logEvent=Ki([].concat(y._logEvent.bindings,w)))}return S.prototype=this,new S(this)}return h}wt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},wt.stdSerializers=$u,wt.stdTimeFunctions=Object.assign({},{nullTime:Cn,epochTime:Nn,unixTime:Xu,isoTime:Zu});function er(e,t,r,i){const s=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?br:s[r]?s[r]:Dr[r]||Dr[i]||br,Wu(e,t,r)}function Wu(e,t,r){!e.transmit&&t[r]===br||(t[r]=function(i){return function(){const s=e.timestamp(),n=new Array(arguments.length),l=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Dr?Dr:this;for(var u=0;u<n.length;u++)n[u]=arguments[u];if(e.serialize&&!e.asObject&&Xr(n,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?i.call(l,Gu(this,r,n,s)):i.apply(l,n),e.transmit){const h=e.transmit.level||t.level,c=wt.levels.values[h],d=wt.levels.values[r];if(d<c)return;Yu(this,{ts:s,methodLevel:r,methodValue:d,transmitLevel:h,transmitValue:wt.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},n)}}}(t[r]))}function Gu(e,t,r,i){e._serialize&&Xr(r,e._serialize,e.serializers,e._stdErrSerialize);const s=r.slice();let n=s[0];const l={};i&&(l.time=i),l.level=wt.levels.values[t];let u=(e._childLevel|0)+1;if(u<1&&(u=1),n!==null&&typeof n=="object"){for(;u--&&typeof s[0]=="object";)Object.assign(l,s.shift());n=s.length?On(s.shift(),s):void 0}else typeof n=="string"&&(n=On(s.shift(),s));return n!==void 0&&(l.msg=n),l}function Xr(e,t,r,i){for(const s in e)if(i&&e[s]instanceof Error)e[s]=wt.stdSerializers.err(e[s]);else if(typeof e[s]=="object"&&!Array.isArray(e[s]))for(const n in e[s])t&&t.indexOf(n)>-1&&n in r&&(e[s][n]=r[n](e[s][n]))}function tr(e,t,r){return function(){const i=new Array(1+arguments.length);i[0]=t;for(var s=1;s<i.length;s++)i[s]=arguments[s-1];return e[r].apply(this,i)}}function Yu(e,t,r){const i=t.send,s=t.ts,n=t.methodLevel,l=t.methodValue,u=t.val,h=e._logEvent.bindings;Xr(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=s,e._logEvent.messages=r.filter(function(c){return h.indexOf(c)===-1}),e._logEvent.level.label=n,e._logEvent.level.value=l,i(n,e._logEvent,u),e._logEvent=Ki(h)}function Ki(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function Qu(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)t[r]===void 0&&(t[r]=e[r]);return t}function Ju(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?Cn:Nn}function Zr(){return{}}function zi(e){return e}function br(){}function Cn(){return!1}function Nn(){return Date.now()}function Xu(){return Math.round(Date.now()/1e3)}function Zu(){return new Date(Date.now()).toISOString()}function el(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}const Hi=Qm(qu),tl={level:"info"},vr="custom_context";var rl=Object.defineProperty,il=Object.defineProperties,sl=Object.getOwnPropertyDescriptors,Tn=Object.getOwnPropertySymbols,nl=Object.prototype.hasOwnProperty,ol=Object.prototype.propertyIsEnumerable,An=(e,t,r)=>t in e?rl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,al=(e,t)=>{for(var r in t||(t={}))nl.call(t,r)&&An(e,r,t[r]);if(Tn)for(var r of Tn(t))ol.call(t,r)&&An(e,r,t[r]);return e},cl=(e,t)=>il(e,sl(t));function Vi(e){return cl(al({},e),{level:(e==null?void 0:e.level)||tl.level})}function ul(e,t=vr){return e[t]||""}function ll(e,t,r=vr){return e[r]=t,e}function nt(e,t=vr){let r="";return typeof e.bindings>"u"?r=ul(e,t):r=e.bindings().context||"",r}function hl(e,t,r=vr){const i=nt(e,r);return i.trim()?`${i}/${t}`:t}function ut(e,t,r=vr){const i=hl(e,t,r),s=e.child({context:i});return ll(s,i,r)}let dl=class extends Ht{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}},pl=class extends Ht{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},fl=class{constructor(e,t){this.logger=e,this.core=t}},gl=class extends Ht{constructor(e,t){super(),this.relayer=e,this.logger=t}},yl=class extends Ht{constructor(e){super()}},ml=class{constructor(e,t,r,i){this.core=e,this.logger=t,this.name=r}};class wl extends Ht{constructor(t,r){super(),this.relayer=t,this.logger=r}}let Dl=class extends Ht{constructor(e,t){super(),this.core=e,this.logger=t}},bl=class{constructor(e,t){this.projectId=e,this.logger=t}},vl=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},El=class{constructor(e){this.client=e}};var qi={},rr={},ei={},ti={};Object.defineProperty(ti,"__esModule",{value:!0}),ti.BrowserRandomSource=void 0;const Pn=65536;class _l{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let i=0;i<r.length;i+=Pn)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,Pn)));return r}}ti.BrowserRandomSource=_l;var ri={},lt={};Object.defineProperty(lt,"__esModule",{value:!0});function Sl(e){for(var t=0;t<e.length;t++)e[t]=0;return e}lt.wipe=Sl,Object.defineProperty(ri,"__esModule",{value:!0}),ri.NodeRandomSource=void 0;const Il=lt;class Ol{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Jm<"u"){const t=Xm();t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(t);for(let s=0;s<i.length;s++)i[s]=r[s];return(0,Il.wipe)(r),i}}ri.NodeRandomSource=Ol,Object.defineProperty(ei,"__esModule",{value:!0}),ei.SystemRandomSource=void 0;const Cl=ti,Nl=ri;class Tl{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Cl.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Nl.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}ei.SystemRandomSource=Tl;var Y={},Rn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(u,h){var c=u>>>16&65535,d=u&65535,f=h>>>16&65535,g=h&65535;return d*g+(c*g+d*f<<16>>>0)|0}e.mul=Math.imul||t;function r(u,h){return u+h|0}e.add=r;function i(u,h){return u-h|0}e.sub=i;function s(u,h){return u<<h|u>>>32-h}e.rotl=s;function n(u,h){return u<<32-h|u>>>h}e.rotr=n;function l(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}e.isInteger=Number.isInteger||l,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(u){return e.isInteger(u)&&u>=-e.MAX_SAFE_INTEGER&&u<=e.MAX_SAFE_INTEGER}})(Rn),Object.defineProperty(Y,"__esModule",{value:!0});var xn=Rn;function Al(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}Y.readInt16BE=Al;function Pl(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}Y.readUint16BE=Pl;function Rl(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}Y.readInt16LE=Rl;function xl(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}Y.readUint16LE=xl;function Un(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}Y.writeUint16BE=Un,Y.writeInt16BE=Un;function Ln(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}Y.writeUint16LE=Ln,Y.writeInt16LE=Ln;function $i(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}Y.readInt32BE=$i;function Bi(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}Y.readUint32BE=Bi;function Wi(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}Y.readInt32LE=Wi;function Gi(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}Y.readUint32LE=Gi;function ii(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}Y.writeUint32BE=ii,Y.writeInt32BE=ii;function si(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}Y.writeUint32LE=si,Y.writeInt32LE=si;function Ul(e,t){t===void 0&&(t=0);var r=$i(e,t),i=$i(e,t+4);return r*4294967296+i-(i>>31)*4294967296}Y.readInt64BE=Ul;function Ll(e,t){t===void 0&&(t=0);var r=Bi(e,t),i=Bi(e,t+4);return r*4294967296+i}Y.readUint64BE=Ll;function jl(e,t){t===void 0&&(t=0);var r=Wi(e,t),i=Wi(e,t+4);return i*4294967296+r-(r>>31)*4294967296}Y.readInt64LE=jl;function Ml(e,t){t===void 0&&(t=0);var r=Gi(e,t),i=Gi(e,t+4);return i*4294967296+r}Y.readUint64LE=Ml;function jn(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),ii(e/4294967296>>>0,t,r),ii(e>>>0,t,r+4),t}Y.writeUint64BE=jn,Y.writeInt64BE=jn;function Mn(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),si(e>>>0,t,r),si(e/4294967296>>>0,t,r+4),t}Y.writeUint64LE=Mn,Y.writeInt64LE=Mn;function kl(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,s=1,n=e/8+r-1;n>=r;n--)i+=t[n]*s,s*=256;return i}Y.readUintBE=kl;function Fl(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,s=1,n=r;n<r+e/8;n++)i+=t[n]*s,s*=256;return i}Y.readUintLE=Fl;function Kl(e,t,r,i){if(r===void 0&&(r=new Uint8Array(e/8)),i===void 0&&(i=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!xn.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var s=1,n=e/8+i-1;n>=i;n--)r[n]=t/s&255,s*=256;return r}Y.writeUintBE=Kl;function zl(e,t,r,i){if(r===void 0&&(r=new Uint8Array(e/8)),i===void 0&&(i=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!xn.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var s=1,n=i;n<i+e/8;n++)r[n]=t/s&255,s*=256;return r}Y.writeUintLE=zl;function Hl(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}Y.readFloat32BE=Hl;function Vl(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}Y.readFloat32LE=Vl;function ql(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}Y.readFloat64BE=ql;function $l(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}Y.readFloat64LE=$l;function Bl(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat32(r,e),t}Y.writeFloat32BE=Bl;function Wl(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat32(r,e,!0),t}Y.writeFloat32LE=Wl;function Gl(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat64(r,e),t}Y.writeFloat64BE=Gl;function Yl(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat64(r,e,!0),t}Y.writeFloat64LE=Yl,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const t=ei,r=Y,i=lt;e.defaultRandomSource=new t.SystemRandomSource;function s(c,d=e.defaultRandomSource){return d.randomBytes(c)}e.randomBytes=s;function n(c=e.defaultRandomSource){const d=s(4,c),f=(0,r.readUint32LE)(d);return(0,i.wipe)(d),f}e.randomUint32=n;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(c,d=l,f=e.defaultRandomSource){if(d.length<2)throw new Error("randomString charset is too short");if(d.length>256)throw new Error("randomString charset is too long");let g="";const m=d.length,w=256-256%m;for(;c>0;){const N=s(Math.ceil(c*256/w),f);for(let R=0;R<N.length&&c>0;R++){const U=N[R];U<w&&(g+=d.charAt(U%m),c--)}(0,i.wipe)(N)}return g}e.randomString=u;function h(c,d=l,f=e.defaultRandomSource){const g=Math.ceil(c/(Math.log(d.length)/Math.LN2));return u(g,d,f)}e.randomStringForEntropy=h}(rr);var kn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Y,r=lt;e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var i=function(){function u(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},u.prototype.update=function(h,c){if(c===void 0&&(c=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var d=0;if(this._bytesHashed+=c,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&c>0;)this._buffer[this._bufferLength++]=h[d++],c--;this._bufferLength===this.blockSize&&(n(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(c>=this.blockSize&&(d=n(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,d,c),c%=this.blockSize);c>0;)this._buffer[this._bufferLength++]=h[d++],c--;return this},u.prototype.finish=function(h){if(!this._finished){var c=this._bytesHashed,d=this._bufferLength,f=c/536870912|0,g=c<<3,m=c%128<112?128:256;this._buffer[d]=128;for(var w=d+1;w<m-8;w++)this._buffer[w]=0;t.writeUint32BE(f,this._buffer,m-8),t.writeUint32BE(g,this._buffer,m-4),n(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,m),this._finished=!0}for(var w=0;w<this.digestLength/8;w++)t.writeUint32BE(this._stateHi[w],h,w*8),t.writeUint32BE(this._stateLo[w],h,w*8+4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();e.SHA512=i;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function n(u,h,c,d,f,g,m){for(var w=c[0],N=c[1],R=c[2],U=c[3],E=c[4],S=c[5],y=c[6],v=c[7],b=d[0],o=d[1],p=d[2],A=d[3],P=d[4],H=d[5],B=d[6],W=d[7],T,C,q,M,x,L,j,k;m>=128;){for(var Q=0;Q<16;Q++){var F=8*Q+g;u[Q]=t.readUint32BE(f,F),h[Q]=t.readUint32BE(f,F+4)}for(var Q=0;Q<80;Q++){var G=w,Z=N,re=R,I=U,O=E,_=S,a=y,D=v,K=b,V=o,ne=p,he=A,oe=P,fe=H,Ie=B,_e=W;if(T=v,C=W,x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=(E>>>14|P<<18)^(E>>>18|P<<14)^(P>>>9|E<<23),C=(P>>>14|E<<18)^(P>>>18|E<<14)^(E>>>9|P<<23),x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,T=E&S^~E&y,C=P&H^~P&B,x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,T=s[Q*2],C=s[Q*2+1],x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,T=u[Q%16],C=h[Q%16],x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,q=j&65535|k<<16,M=x&65535|L<<16,T=q,C=M,x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=(w>>>28|b<<4)^(b>>>2|w<<30)^(b>>>7|w<<25),C=(b>>>28|w<<4)^(w>>>2|b<<30)^(w>>>7|b<<25),x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,T=w&N^w&R^N&R,C=b&o^b&p^o&p,x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,D=j&65535|k<<16,_e=x&65535|L<<16,T=I,C=he,x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=q,C=M,x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,I=j&65535|k<<16,he=x&65535|L<<16,N=G,R=Z,U=re,E=I,S=O,y=_,v=a,w=D,o=K,p=V,A=ne,P=he,H=oe,B=fe,W=Ie,b=_e,Q%16===15)for(var F=0;F<16;F++)T=u[F],C=h[F],x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=u[(F+9)%16],C=h[(F+9)%16],x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,q=u[(F+1)%16],M=h[(F+1)%16],T=(q>>>1|M<<31)^(q>>>8|M<<24)^q>>>7,C=(M>>>1|q<<31)^(M>>>8|q<<24)^(M>>>7|q<<25),x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,q=u[(F+14)%16],M=h[(F+14)%16],T=(q>>>19|M<<13)^(M>>>29|q<<3)^q>>>6,C=(M>>>19|q<<13)^(q>>>29|M<<3)^(M>>>6|q<<26),x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,u[F]=j&65535|k<<16,h[F]=x&65535|L<<16}T=w,C=b,x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=c[0],C=d[0],x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,c[0]=w=j&65535|k<<16,d[0]=b=x&65535|L<<16,T=N,C=o,x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=c[1],C=d[1],x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,c[1]=N=j&65535|k<<16,d[1]=o=x&65535|L<<16,T=R,C=p,x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=c[2],C=d[2],x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,c[2]=R=j&65535|k<<16,d[2]=p=x&65535|L<<16,T=U,C=A,x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=c[3],C=d[3],x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,c[3]=U=j&65535|k<<16,d[3]=A=x&65535|L<<16,T=E,C=P,x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=c[4],C=d[4],x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,c[4]=E=j&65535|k<<16,d[4]=P=x&65535|L<<16,T=S,C=H,x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=c[5],C=d[5],x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,c[5]=S=j&65535|k<<16,d[5]=H=x&65535|L<<16,T=y,C=B,x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=c[6],C=d[6],x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,c[6]=y=j&65535|k<<16,d[6]=B=x&65535|L<<16,T=v,C=W,x=C&65535,L=C>>>16,j=T&65535,k=T>>>16,T=c[7],C=d[7],x+=C&65535,L+=C>>>16,j+=T&65535,k+=T>>>16,L+=x>>>16,j+=L>>>16,k+=j>>>16,c[7]=v=j&65535|k<<16,d[7]=W=x&65535|L<<16,g+=128,m-=128}return g}function l(u){var h=new i;h.update(u);var c=h.digest();return h.clean(),c}e.hash=l})(kn),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.convertSecretKeyToX25519=e.convertPublicKeyToX25519=e.verify=e.sign=e.extractPublicKeyFromSecretKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.SEED_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=e.SIGNATURE_LENGTH=void 0;const t=rr,r=kn,i=lt;e.SIGNATURE_LENGTH=64,e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=64,e.SEED_LENGTH=32;function s(I){const O=new Float64Array(16);if(I)for(let _=0;_<I.length;_++)O[_]=I[_];return O}const n=new Uint8Array(32);n[0]=9;const l=s(),u=s([1]),h=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),f=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function m(I,O){for(let _=0;_<16;_++)I[_]=O[_]|0}function w(I){let O=1;for(let _=0;_<16;_++){let a=I[_]+O+65535;O=Math.floor(a/65536),I[_]=a-O*65536}I[0]+=O-1+37*(O-1)}function N(I,O,_){const a=~(_-1);for(let D=0;D<16;D++){const K=a&(I[D]^O[D]);I[D]^=K,O[D]^=K}}function R(I,O){const _=s(),a=s();for(let D=0;D<16;D++)a[D]=O[D];w(a),w(a),w(a);for(let D=0;D<2;D++){_[0]=a[0]-65517;for(let V=1;V<15;V++)_[V]=a[V]-65535-(_[V-1]>>16&1),_[V-1]&=65535;_[15]=a[15]-32767-(_[14]>>16&1);const K=_[15]>>16&1;_[14]&=65535,N(a,_,1-K)}for(let D=0;D<16;D++)I[2*D]=a[D]&255,I[2*D+1]=a[D]>>8}function U(I,O){let _=0;for(let a=0;a<32;a++)_|=I[a]^O[a];return(1&_-1>>>8)-1}function E(I,O){const _=new Uint8Array(32),a=new Uint8Array(32);return R(_,I),R(a,O),U(_,a)}function S(I){const O=new Uint8Array(32);return R(O,I),O[0]&1}function y(I,O){for(let _=0;_<16;_++)I[_]=O[2*_]+(O[2*_+1]<<8);I[15]&=32767}function v(I,O,_){for(let a=0;a<16;a++)I[a]=O[a]+_[a]}function b(I,O,_){for(let a=0;a<16;a++)I[a]=O[a]-_[a]}function o(I,O,_){let a,D,K=0,V=0,ne=0,he=0,oe=0,fe=0,Ie=0,_e=0,ue=0,ae=0,se=0,ie=0,te=0,ee=0,J=0,X=0,ce=0,le=0,de=0,pe=0,ge=0,ye=0,me=0,De=0,Ut=0,Yt=0,cr=0,Kr=0,vi=0,js=0,Fa=0,ke=_[0],Fe=_[1],Ke=_[2],ze=_[3],He=_[4],Ve=_[5],qe=_[6],$e=_[7],Be=_[8],We=_[9],Ge=_[10],Ye=_[11],Qe=_[12],Je=_[13],Xe=_[14],Ze=_[15];a=O[0],K+=a*ke,V+=a*Fe,ne+=a*Ke,he+=a*ze,oe+=a*He,fe+=a*Ve,Ie+=a*qe,_e+=a*$e,ue+=a*Be,ae+=a*We,se+=a*Ge,ie+=a*Ye,te+=a*Qe,ee+=a*Je,J+=a*Xe,X+=a*Ze,a=O[1],V+=a*ke,ne+=a*Fe,he+=a*Ke,oe+=a*ze,fe+=a*He,Ie+=a*Ve,_e+=a*qe,ue+=a*$e,ae+=a*Be,se+=a*We,ie+=a*Ge,te+=a*Ye,ee+=a*Qe,J+=a*Je,X+=a*Xe,ce+=a*Ze,a=O[2],ne+=a*ke,he+=a*Fe,oe+=a*Ke,fe+=a*ze,Ie+=a*He,_e+=a*Ve,ue+=a*qe,ae+=a*$e,se+=a*Be,ie+=a*We,te+=a*Ge,ee+=a*Ye,J+=a*Qe,X+=a*Je,ce+=a*Xe,le+=a*Ze,a=O[3],he+=a*ke,oe+=a*Fe,fe+=a*Ke,Ie+=a*ze,_e+=a*He,ue+=a*Ve,ae+=a*qe,se+=a*$e,ie+=a*Be,te+=a*We,ee+=a*Ge,J+=a*Ye,X+=a*Qe,ce+=a*Je,le+=a*Xe,de+=a*Ze,a=O[4],oe+=a*ke,fe+=a*Fe,Ie+=a*Ke,_e+=a*ze,ue+=a*He,ae+=a*Ve,se+=a*qe,ie+=a*$e,te+=a*Be,ee+=a*We,J+=a*Ge,X+=a*Ye,ce+=a*Qe,le+=a*Je,de+=a*Xe,pe+=a*Ze,a=O[5],fe+=a*ke,Ie+=a*Fe,_e+=a*Ke,ue+=a*ze,ae+=a*He,se+=a*Ve,ie+=a*qe,te+=a*$e,ee+=a*Be,J+=a*We,X+=a*Ge,ce+=a*Ye,le+=a*Qe,de+=a*Je,pe+=a*Xe,ge+=a*Ze,a=O[6],Ie+=a*ke,_e+=a*Fe,ue+=a*Ke,ae+=a*ze,se+=a*He,ie+=a*Ve,te+=a*qe,ee+=a*$e,J+=a*Be,X+=a*We,ce+=a*Ge,le+=a*Ye,de+=a*Qe,pe+=a*Je,ge+=a*Xe,ye+=a*Ze,a=O[7],_e+=a*ke,ue+=a*Fe,ae+=a*Ke,se+=a*ze,ie+=a*He,te+=a*Ve,ee+=a*qe,J+=a*$e,X+=a*Be,ce+=a*We,le+=a*Ge,de+=a*Ye,pe+=a*Qe,ge+=a*Je,ye+=a*Xe,me+=a*Ze,a=O[8],ue+=a*ke,ae+=a*Fe,se+=a*Ke,ie+=a*ze,te+=a*He,ee+=a*Ve,J+=a*qe,X+=a*$e,ce+=a*Be,le+=a*We,de+=a*Ge,pe+=a*Ye,ge+=a*Qe,ye+=a*Je,me+=a*Xe,De+=a*Ze,a=O[9],ae+=a*ke,se+=a*Fe,ie+=a*Ke,te+=a*ze,ee+=a*He,J+=a*Ve,X+=a*qe,ce+=a*$e,le+=a*Be,de+=a*We,pe+=a*Ge,ge+=a*Ye,ye+=a*Qe,me+=a*Je,De+=a*Xe,Ut+=a*Ze,a=O[10],se+=a*ke,ie+=a*Fe,te+=a*Ke,ee+=a*ze,J+=a*He,X+=a*Ve,ce+=a*qe,le+=a*$e,de+=a*Be,pe+=a*We,ge+=a*Ge,ye+=a*Ye,me+=a*Qe,De+=a*Je,Ut+=a*Xe,Yt+=a*Ze,a=O[11],ie+=a*ke,te+=a*Fe,ee+=a*Ke,J+=a*ze,X+=a*He,ce+=a*Ve,le+=a*qe,de+=a*$e,pe+=a*Be,ge+=a*We,ye+=a*Ge,me+=a*Ye,De+=a*Qe,Ut+=a*Je,Yt+=a*Xe,cr+=a*Ze,a=O[12],te+=a*ke,ee+=a*Fe,J+=a*Ke,X+=a*ze,ce+=a*He,le+=a*Ve,de+=a*qe,pe+=a*$e,ge+=a*Be,ye+=a*We,me+=a*Ge,De+=a*Ye,Ut+=a*Qe,Yt+=a*Je,cr+=a*Xe,Kr+=a*Ze,a=O[13],ee+=a*ke,J+=a*Fe,X+=a*Ke,ce+=a*ze,le+=a*He,de+=a*Ve,pe+=a*qe,ge+=a*$e,ye+=a*Be,me+=a*We,De+=a*Ge,Ut+=a*Ye,Yt+=a*Qe,cr+=a*Je,Kr+=a*Xe,vi+=a*Ze,a=O[14],J+=a*ke,X+=a*Fe,ce+=a*Ke,le+=a*ze,de+=a*He,pe+=a*Ve,ge+=a*qe,ye+=a*$e,me+=a*Be,De+=a*We,Ut+=a*Ge,Yt+=a*Ye,cr+=a*Qe,Kr+=a*Je,vi+=a*Xe,js+=a*Ze,a=O[15],X+=a*ke,ce+=a*Fe,le+=a*Ke,de+=a*ze,pe+=a*He,ge+=a*Ve,ye+=a*qe,me+=a*$e,De+=a*Be,Ut+=a*We,Yt+=a*Ge,cr+=a*Ye,Kr+=a*Qe,vi+=a*Je,js+=a*Xe,Fa+=a*Ze,K+=38*ce,V+=38*le,ne+=38*de,he+=38*pe,oe+=38*ge,fe+=38*ye,Ie+=38*me,_e+=38*De,ue+=38*Ut,ae+=38*Yt,se+=38*cr,ie+=38*Kr,te+=38*vi,ee+=38*js,J+=38*Fa,D=1,a=K+D+65535,D=Math.floor(a/65536),K=a-D*65536,a=V+D+65535,D=Math.floor(a/65536),V=a-D*65536,a=ne+D+65535,D=Math.floor(a/65536),ne=a-D*65536,a=he+D+65535,D=Math.floor(a/65536),he=a-D*65536,a=oe+D+65535,D=Math.floor(a/65536),oe=a-D*65536,a=fe+D+65535,D=Math.floor(a/65536),fe=a-D*65536,a=Ie+D+65535,D=Math.floor(a/65536),Ie=a-D*65536,a=_e+D+65535,D=Math.floor(a/65536),_e=a-D*65536,a=ue+D+65535,D=Math.floor(a/65536),ue=a-D*65536,a=ae+D+65535,D=Math.floor(a/65536),ae=a-D*65536,a=se+D+65535,D=Math.floor(a/65536),se=a-D*65536,a=ie+D+65535,D=Math.floor(a/65536),ie=a-D*65536,a=te+D+65535,D=Math.floor(a/65536),te=a-D*65536,a=ee+D+65535,D=Math.floor(a/65536),ee=a-D*65536,a=J+D+65535,D=Math.floor(a/65536),J=a-D*65536,a=X+D+65535,D=Math.floor(a/65536),X=a-D*65536,K+=D-1+37*(D-1),D=1,a=K+D+65535,D=Math.floor(a/65536),K=a-D*65536,a=V+D+65535,D=Math.floor(a/65536),V=a-D*65536,a=ne+D+65535,D=Math.floor(a/65536),ne=a-D*65536,a=he+D+65535,D=Math.floor(a/65536),he=a-D*65536,a=oe+D+65535,D=Math.floor(a/65536),oe=a-D*65536,a=fe+D+65535,D=Math.floor(a/65536),fe=a-D*65536,a=Ie+D+65535,D=Math.floor(a/65536),Ie=a-D*65536,a=_e+D+65535,D=Math.floor(a/65536),_e=a-D*65536,a=ue+D+65535,D=Math.floor(a/65536),ue=a-D*65536,a=ae+D+65535,D=Math.floor(a/65536),ae=a-D*65536,a=se+D+65535,D=Math.floor(a/65536),se=a-D*65536,a=ie+D+65535,D=Math.floor(a/65536),ie=a-D*65536,a=te+D+65535,D=Math.floor(a/65536),te=a-D*65536,a=ee+D+65535,D=Math.floor(a/65536),ee=a-D*65536,a=J+D+65535,D=Math.floor(a/65536),J=a-D*65536,a=X+D+65535,D=Math.floor(a/65536),X=a-D*65536,K+=D-1+37*(D-1),I[0]=K,I[1]=V,I[2]=ne,I[3]=he,I[4]=oe,I[5]=fe,I[6]=Ie,I[7]=_e,I[8]=ue,I[9]=ae,I[10]=se,I[11]=ie,I[12]=te,I[13]=ee,I[14]=J,I[15]=X}function p(I,O){o(I,O,O)}function A(I,O){const _=s();let a;for(a=0;a<16;a++)_[a]=O[a];for(a=253;a>=0;a--)p(_,_),a!==2&&a!==4&&o(_,_,O);for(a=0;a<16;a++)I[a]=_[a]}function P(I,O){const _=s();let a;for(a=0;a<16;a++)_[a]=O[a];for(a=250;a>=0;a--)p(_,_),a!==1&&o(_,_,O);for(a=0;a<16;a++)I[a]=_[a]}function H(I,O){const _=s(),a=s(),D=s(),K=s(),V=s(),ne=s(),he=s(),oe=s(),fe=s();b(_,I[1],I[0]),b(fe,O[1],O[0]),o(_,_,fe),v(a,I[0],I[1]),v(fe,O[0],O[1]),o(a,a,fe),o(D,I[3],O[3]),o(D,D,c),o(K,I[2],O[2]),v(K,K,K),b(V,a,_),b(ne,K,D),v(he,K,D),v(oe,a,_),o(I[0],V,ne),o(I[1],oe,he),o(I[2],he,ne),o(I[3],V,oe)}function B(I,O,_){for(let a=0;a<4;a++)N(I[a],O[a],_)}function W(I,O){const _=s(),a=s(),D=s();A(D,O[2]),o(_,O[0],D),o(a,O[1],D),R(I,a),I[31]^=S(_)<<7}function T(I,O,_){m(I[0],l),m(I[1],u),m(I[2],u),m(I[3],l);for(let a=255;a>=0;--a){const D=_[a/8|0]>>(a&7)&1;B(I,O,D),H(O,I),H(I,I),B(I,O,D)}}function C(I,O){const _=[s(),s(),s(),s()];m(_[0],d),m(_[1],f),m(_[2],u),o(_[3],d,f),T(I,_,O)}function q(I){if(I.length!==e.SEED_LENGTH)throw new Error(`ed25519: seed must be ${e.SEED_LENGTH} bytes`);const O=(0,r.hash)(I);O[0]&=248,O[31]&=127,O[31]|=64;const _=new Uint8Array(32),a=[s(),s(),s(),s()];C(a,O),W(_,a);const D=new Uint8Array(64);return D.set(I),D.set(_,32),{publicKey:_,secretKey:D}}e.generateKeyPairFromSeed=q;function M(I){const O=(0,t.randomBytes)(32,I),_=q(O);return(0,i.wipe)(O),_}e.generateKeyPair=M;function x(I){if(I.length!==e.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${e.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(I.subarray(32))}e.extractPublicKeyFromSecretKey=x;const L=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function j(I,O){let _,a,D,K;for(a=63;a>=32;--a){for(_=0,D=a-32,K=a-12;D<K;++D)O[D]+=_-16*O[a]*L[D-(a-32)],_=Math.floor((O[D]+128)/256),O[D]-=_*256;O[D]+=_,O[a]=0}for(_=0,D=0;D<32;D++)O[D]+=_-(O[31]>>4)*L[D],_=O[D]>>8,O[D]&=255;for(D=0;D<32;D++)O[D]-=_*L[D];for(a=0;a<32;a++)O[a+1]+=O[a]>>8,I[a]=O[a]&255}function k(I){const O=new Float64Array(64);for(let _=0;_<64;_++)O[_]=I[_];for(let _=0;_<64;_++)I[_]=0;j(I,O)}function Q(I,O){const _=new Float64Array(64),a=[s(),s(),s(),s()],D=(0,r.hash)(I.subarray(0,32));D[0]&=248,D[31]&=127,D[31]|=64;const K=new Uint8Array(64);K.set(D.subarray(32),32);const V=new r.SHA512;V.update(K.subarray(32)),V.update(O);const ne=V.digest();V.clean(),k(ne),C(a,ne),W(K,a),V.reset(),V.update(K.subarray(0,32)),V.update(I.subarray(32)),V.update(O);const he=V.digest();k(he);for(let oe=0;oe<32;oe++)_[oe]=ne[oe];for(let oe=0;oe<32;oe++)for(let fe=0;fe<32;fe++)_[oe+fe]+=he[oe]*D[fe];return j(K.subarray(32),_),K}e.sign=Q;function F(I,O){const _=s(),a=s(),D=s(),K=s(),V=s(),ne=s(),he=s();return m(I[2],u),y(I[1],O),p(D,I[1]),o(K,D,h),b(D,D,I[2]),v(K,I[2],K),p(V,K),p(ne,V),o(he,ne,V),o(_,he,D),o(_,_,K),P(_,_),o(_,_,D),o(_,_,K),o(_,_,K),o(I[0],_,K),p(a,I[0]),o(a,a,K),E(a,D)&&o(I[0],I[0],g),p(a,I[0]),o(a,a,K),E(a,D)?-1:(S(I[0])===O[31]>>7&&b(I[0],l,I[0]),o(I[3],I[0],I[1]),0)}function G(I,O,_){const a=new Uint8Array(32),D=[s(),s(),s(),s()],K=[s(),s(),s(),s()];if(_.length!==e.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${e.SIGNATURE_LENGTH} bytes`);if(F(K,I))return!1;const V=new r.SHA512;V.update(_.subarray(0,32)),V.update(I),V.update(O);const ne=V.digest();return k(ne),T(D,K,ne),C(K,_.subarray(32)),H(D,K),W(a,D),!U(_,a)}e.verify=G;function Z(I){let O=[s(),s(),s(),s()];if(F(O,I))throw new Error("Ed25519: invalid public key");let _=s(),a=s(),D=O[1];v(_,u,D),b(a,u,D),A(a,a),o(_,_,a);let K=new Uint8Array(32);return R(K,_),K}e.convertPublicKeyToX25519=Z;function re(I){const O=(0,r.hash)(I.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const _=new Uint8Array(O.subarray(0,32));return(0,i.wipe)(O),_}e.convertSecretKeyToX25519=re}(qi);const Ql="EdDSA",Jl="JWT",Fn=".",Kn="base64url",Xl="utf8",Zl="utf8",eh=":",th="did",rh="key",zn="base58btc",ih="z",sh="K36",nh=32;function Yi(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Hn(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Yi(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Qi(e,t){t||(t=e.reduce((s,n)=>s+n.length,0));const r=Hn(t);let i=0;for(const s of e)r.set(s,i),i+=s.length;return Yi(r)}function oh(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),l=n.charCodeAt(0);if(r[l]!==255)throw new TypeError(n+" is ambiguous");r[l]=s}var u=e.length,h=e.charAt(0),c=Math.log(u)/Math.log(256),d=Math.log(256)/Math.log(u);function f(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var N=0,R=0,U=0,E=w.length;U!==E&&w[U]===0;)U++,N++;for(var S=(E-U)*d+1>>>0,y=new Uint8Array(S);U!==E;){for(var v=w[U],b=0,o=S-1;(v!==0||b<R)&&o!==-1;o--,b++)v+=256*y[o]>>>0,y[o]=v%u>>>0,v=v/u>>>0;if(v!==0)throw new Error("Non-zero carry");R=b,U++}for(var p=S-R;p!==S&&y[p]===0;)p++;for(var A=h.repeat(N);p<S;++p)A+=e.charAt(y[p]);return A}function g(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var N=0;if(w[N]!==" "){for(var R=0,U=0;w[N]===h;)R++,N++;for(var E=(w.length-N)*c+1>>>0,S=new Uint8Array(E);w[N];){var y=r[w.charCodeAt(N)];if(y===255)return;for(var v=0,b=E-1;(y!==0||v<U)&&b!==-1;b--,v++)y+=u*S[b]>>>0,S[b]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");U=v,N++}if(w[N]!==" "){for(var o=E-U;o!==E&&S[o]===0;)o++;for(var p=new Uint8Array(R+(E-o)),A=R;o!==E;)p[A++]=S[o++];return p}}}function m(w){var N=g(w);if(N)return N;throw new Error(`Non-${t} character`)}return{encode:f,decodeUnsafe:g,decode:m}}var ah=oh,ch=ah;const uh=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},lh=e=>new TextEncoder().encode(e),hh=e=>new TextDecoder().decode(e);class dh{constructor(t,r,i){this.name=t,this.prefix=r,this.baseEncode=i}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class ph{constructor(t,r,i){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Vn(this,t)}}class fh{constructor(t){this.decoders=t}or(t){return Vn(this,t)}decode(t){const r=t[0],i=this.decoders[r];if(i)return i.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Vn=(e,t)=>new fh({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class gh{constructor(t,r,i,s){this.name=t,this.prefix=r,this.baseEncode=i,this.baseDecode=s,this.encoder=new dh(t,r,i),this.decoder=new ph(t,r,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const ni=({name:e,prefix:t,encode:r,decode:i})=>new gh(e,t,r,i),Er=({prefix:e,name:t,alphabet:r})=>{const{encode:i,decode:s}=ch(r,t);return ni({prefix:e,name:t,encode:i,decode:n=>uh(s(n))})},yh=(e,t,r,i)=>{const s={};for(let d=0;d<t.length;++d)s[t[d]]=d;let n=e.length;for(;e[n-1]==="=";)--n;const l=new Uint8Array(n*r/8|0);let u=0,h=0,c=0;for(let d=0;d<n;++d){const f=s[e[d]];if(f===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|f,u+=r,u>=8&&(u-=8,l[c++]=255&h>>u)}if(u>=r||255&h<<8-u)throw new SyntaxError("Unexpected end of data");return l},mh=(e,t,r)=>{const i=t[t.length-1]==="=",s=(1<<r)-1;let n="",l=0,u=0;for(let h=0;h<e.length;++h)for(u=u<<8|e[h],l+=8;l>r;)l-=r,n+=t[s&u>>l];if(l&&(n+=t[s&u<<r-l]),i)for(;n.length*r&7;)n+="=";return n},Re=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>ni({prefix:t,name:e,encode(s){return mh(s,i,r)},decode(s){return yh(s,i,r,e)}}),wh=ni({prefix:"\0",name:"identity",encode:e=>hh(e),decode:e=>lh(e)}),Dh=Object.freeze(Object.defineProperty({__proto__:null,identity:wh},Symbol.toStringTag,{value:"Module"})),bh=Re({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),vh=Object.freeze(Object.defineProperty({__proto__:null,base2:bh},Symbol.toStringTag,{value:"Module"})),Eh=Re({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),_h=Object.freeze(Object.defineProperty({__proto__:null,base8:Eh},Symbol.toStringTag,{value:"Module"})),Sh=Er({prefix:"9",name:"base10",alphabet:"0123456789"}),Ih=Object.freeze(Object.defineProperty({__proto__:null,base10:Sh},Symbol.toStringTag,{value:"Module"})),Oh=Re({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ch=Re({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Nh=Object.freeze(Object.defineProperty({__proto__:null,base16:Oh,base16upper:Ch},Symbol.toStringTag,{value:"Module"})),Th=Re({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ah=Re({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ph=Re({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Rh=Re({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),xh=Re({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Uh=Re({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Lh=Re({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),jh=Re({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Mh=Re({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),kh=Object.freeze(Object.defineProperty({__proto__:null,base32:Th,base32hex:xh,base32hexpad:Lh,base32hexpadupper:jh,base32hexupper:Uh,base32pad:Ph,base32padupper:Rh,base32upper:Ah,base32z:Mh},Symbol.toStringTag,{value:"Module"})),Fh=Er({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Kh=Er({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),zh=Object.freeze(Object.defineProperty({__proto__:null,base36:Fh,base36upper:Kh},Symbol.toStringTag,{value:"Module"})),Hh=Er({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vh=Er({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),qh=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Hh,base58flickr:Vh},Symbol.toStringTag,{value:"Module"})),$h=Re({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Bh=Re({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Wh=Re({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Gh=Re({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Yh=Object.freeze(Object.defineProperty({__proto__:null,base64:$h,base64pad:Bh,base64url:Wh,base64urlpad:Gh},Symbol.toStringTag,{value:"Module"})),qn=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Qh=qn.reduce((e,t,r)=>(e[r]=t,e),[]),Jh=qn.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function Xh(e){return e.reduce((t,r)=>(t+=Qh[r],t),"")}function Zh(e){const t=[];for(const r of e){const i=Jh[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(i)}return new Uint8Array(t)}const ed=ni({prefix:"\u{1F680}",name:"base256emoji",encode:Xh,decode:Zh}),td=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:ed},Symbol.toStringTag,{value:"Module"}));new TextEncoder,new TextDecoder;const $n={...Dh,...vh,..._h,...Ih,...Nh,...kh,...zh,...qh,...Yh,...td};function Bn(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}const Wn=Bn("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Ji=Bn("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=Hn(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Gn={utf8:Wn,"utf-8":Wn,hex:$n.base16,latin1:Ji,ascii:Ji,binary:Ji,...$n};function et(e,t="utf8"){const r=Gn[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function ot(e,t="utf8"){const r=Gn[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Yi(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}function oi(e){return et(ot(dr(e),Xl),Kn)}function Yn(e){const t=ot(sh,zn),r=ih+et(Qi([t,e]),zn);return[th,rh,r].join(eh)}function rd(e){return et(e,Kn)}function id(e){return ot([oi(e.header),oi(e.payload)].join(Fn),Zl)}function sd(e){return[oi(e.header),oi(e.payload),rd(e.signature)].join(Fn)}function Qn(e=rr.randomBytes(nh)){return qi.generateKeyPairFromSeed(e)}async function nd(e,t,r,i,s=$.fromMiliseconds(Date.now())){const n={alg:Ql,typ:Jl},l=Yn(i.publicKey),u=s+r,h={iss:l,sub:e,aud:t,iat:s,exp:u},c=id({header:n,payload:h}),d=qi.sign(i.secretKey,c);return sd({header:n,payload:h,signature:d})}var Xi={},ai={};Object.defineProperty(ai,"__esModule",{value:!0});var Ue=Y,Zi=lt,od=20;function ad(e,t,r){for(var i=1634760805,s=857760878,n=2036477234,l=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],c=r[11]<<24|r[10]<<16|r[9]<<8|r[8],d=r[15]<<24|r[14]<<16|r[13]<<8|r[12],f=r[19]<<24|r[18]<<16|r[17]<<8|r[16],g=r[23]<<24|r[22]<<16|r[21]<<8|r[20],m=r[27]<<24|r[26]<<16|r[25]<<8|r[24],w=r[31]<<24|r[30]<<16|r[29]<<8|r[28],N=t[3]<<24|t[2]<<16|t[1]<<8|t[0],R=t[7]<<24|t[6]<<16|t[5]<<8|t[4],U=t[11]<<24|t[10]<<16|t[9]<<8|t[8],E=t[15]<<24|t[14]<<16|t[13]<<8|t[12],S=i,y=s,v=n,b=l,o=u,p=h,A=c,P=d,H=f,B=g,W=m,T=w,C=N,q=R,M=U,x=E,L=0;L<od;L+=2)S=S+o|0,C^=S,C=C>>>16|C<<16,H=H+C|0,o^=H,o=o>>>20|o<<12,y=y+p|0,q^=y,q=q>>>16|q<<16,B=B+q|0,p^=B,p=p>>>20|p<<12,v=v+A|0,M^=v,M=M>>>16|M<<16,W=W+M|0,A^=W,A=A>>>20|A<<12,b=b+P|0,x^=b,x=x>>>16|x<<16,T=T+x|0,P^=T,P=P>>>20|P<<12,v=v+A|0,M^=v,M=M>>>24|M<<8,W=W+M|0,A^=W,A=A>>>25|A<<7,b=b+P|0,x^=b,x=x>>>24|x<<8,T=T+x|0,P^=T,P=P>>>25|P<<7,y=y+p|0,q^=y,q=q>>>24|q<<8,B=B+q|0,p^=B,p=p>>>25|p<<7,S=S+o|0,C^=S,C=C>>>24|C<<8,H=H+C|0,o^=H,o=o>>>25|o<<7,S=S+p|0,x^=S,x=x>>>16|x<<16,W=W+x|0,p^=W,p=p>>>20|p<<12,y=y+A|0,C^=y,C=C>>>16|C<<16,T=T+C|0,A^=T,A=A>>>20|A<<12,v=v+P|0,q^=v,q=q>>>16|q<<16,H=H+q|0,P^=H,P=P>>>20|P<<12,b=b+o|0,M^=b,M=M>>>16|M<<16,B=B+M|0,o^=B,o=o>>>20|o<<12,v=v+P|0,q^=v,q=q>>>24|q<<8,H=H+q|0,P^=H,P=P>>>25|P<<7,b=b+o|0,M^=b,M=M>>>24|M<<8,B=B+M|0,o^=B,o=o>>>25|o<<7,y=y+A|0,C^=y,C=C>>>24|C<<8,T=T+C|0,A^=T,A=A>>>25|A<<7,S=S+p|0,x^=S,x=x>>>24|x<<8,W=W+x|0,p^=W,p=p>>>25|p<<7;Ue.writeUint32LE(S+i|0,e,0),Ue.writeUint32LE(y+s|0,e,4),Ue.writeUint32LE(v+n|0,e,8),Ue.writeUint32LE(b+l|0,e,12),Ue.writeUint32LE(o+u|0,e,16),Ue.writeUint32LE(p+h|0,e,20),Ue.writeUint32LE(A+c|0,e,24),Ue.writeUint32LE(P+d|0,e,28),Ue.writeUint32LE(H+f|0,e,32),Ue.writeUint32LE(B+g|0,e,36),Ue.writeUint32LE(W+m|0,e,40),Ue.writeUint32LE(T+w|0,e,44),Ue.writeUint32LE(C+N|0,e,48),Ue.writeUint32LE(q+R|0,e,52),Ue.writeUint32LE(M+U|0,e,56),Ue.writeUint32LE(x+E|0,e,60)}function Jn(e,t,r,i,s){if(s===void 0&&(s=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var n,l;if(s===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");n=new Uint8Array(16),l=n.length-t.length,n.set(t,l)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");n=t,l=s}for(var u=new Uint8Array(64),h=0;h<r.length;h+=64){ad(u,n,e);for(var c=h;c<h+64&&c<r.length;c++)i[c]=r[c]^u[c-h];ud(n,0,l)}return Zi.wipe(u),s===0&&Zi.wipe(n),i}ai.streamXOR=Jn;function cd(e,t,r,i){return i===void 0&&(i=0),Zi.wipe(r),Jn(e,t,r,r,i)}ai.stream=cd;function ud(e,t,r){for(var i=1;r--;)i=i+(e[t]&255)|0,e[t]=i&255,i>>>=8,t++;if(i>0)throw new Error("ChaCha: counter overflow")}var Xn={},Pt={};Object.defineProperty(Pt,"__esModule",{value:!0});function ld(e,t,r){return~(e-1)&t|e-1&r}Pt.select=ld;function hd(e,t){return(e|0)-(t|0)-1>>>31&1}Pt.lessOrEqual=hd;function Zn(e,t){if(e.length!==t.length)return 0;for(var r=0,i=0;i<e.length;i++)r|=e[i]^t[i];return 1&r-1>>>8}Pt.compare=Zn;function dd(e,t){return e.length===0||t.length===0?!1:Zn(e,t)!==0}Pt.equal=dd,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Pt,r=lt;e.DIGEST_LENGTH=16;var i=function(){function l(u){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=u[0]|u[1]<<8;this._r[0]=h&8191;var c=u[2]|u[3]<<8;this._r[1]=(h>>>13|c<<3)&8191;var d=u[4]|u[5]<<8;this._r[2]=(c>>>10|d<<6)&7939;var f=u[6]|u[7]<<8;this._r[3]=(d>>>7|f<<9)&8191;var g=u[8]|u[9]<<8;this._r[4]=(f>>>4|g<<12)&255,this._r[5]=g>>>1&8190;var m=u[10]|u[11]<<8;this._r[6]=(g>>>14|m<<2)&8191;var w=u[12]|u[13]<<8;this._r[7]=(m>>>11|w<<5)&8065;var N=u[14]|u[15]<<8;this._r[8]=(w>>>8|N<<8)&8191,this._r[9]=N>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return l.prototype._blocks=function(u,h,c){for(var d=this._fin?0:2048,f=this._h[0],g=this._h[1],m=this._h[2],w=this._h[3],N=this._h[4],R=this._h[5],U=this._h[6],E=this._h[7],S=this._h[8],y=this._h[9],v=this._r[0],b=this._r[1],o=this._r[2],p=this._r[3],A=this._r[4],P=this._r[5],H=this._r[6],B=this._r[7],W=this._r[8],T=this._r[9];c>=16;){var C=u[h+0]|u[h+1]<<8;f+=C&8191;var q=u[h+2]|u[h+3]<<8;g+=(C>>>13|q<<3)&8191;var M=u[h+4]|u[h+5]<<8;m+=(q>>>10|M<<6)&8191;var x=u[h+6]|u[h+7]<<8;w+=(M>>>7|x<<9)&8191;var L=u[h+8]|u[h+9]<<8;N+=(x>>>4|L<<12)&8191,R+=L>>>1&8191;var j=u[h+10]|u[h+11]<<8;U+=(L>>>14|j<<2)&8191;var k=u[h+12]|u[h+13]<<8;E+=(j>>>11|k<<5)&8191;var Q=u[h+14]|u[h+15]<<8;S+=(k>>>8|Q<<8)&8191,y+=Q>>>5|d;var F=0,G=F;G+=f*v,G+=g*(5*T),G+=m*(5*W),G+=w*(5*B),G+=N*(5*H),F=G>>>13,G&=8191,G+=R*(5*P),G+=U*(5*A),G+=E*(5*p),G+=S*(5*o),G+=y*(5*b),F+=G>>>13,G&=8191;var Z=F;Z+=f*b,Z+=g*v,Z+=m*(5*T),Z+=w*(5*W),Z+=N*(5*B),F=Z>>>13,Z&=8191,Z+=R*(5*H),Z+=U*(5*P),Z+=E*(5*A),Z+=S*(5*p),Z+=y*(5*o),F+=Z>>>13,Z&=8191;var re=F;re+=f*o,re+=g*b,re+=m*v,re+=w*(5*T),re+=N*(5*W),F=re>>>13,re&=8191,re+=R*(5*B),re+=U*(5*H),re+=E*(5*P),re+=S*(5*A),re+=y*(5*p),F+=re>>>13,re&=8191;var I=F;I+=f*p,I+=g*o,I+=m*b,I+=w*v,I+=N*(5*T),F=I>>>13,I&=8191,I+=R*(5*W),I+=U*(5*B),I+=E*(5*H),I+=S*(5*P),I+=y*(5*A),F+=I>>>13,I&=8191;var O=F;O+=f*A,O+=g*p,O+=m*o,O+=w*b,O+=N*v,F=O>>>13,O&=8191,O+=R*(5*T),O+=U*(5*W),O+=E*(5*B),O+=S*(5*H),O+=y*(5*P),F+=O>>>13,O&=8191;var _=F;_+=f*P,_+=g*A,_+=m*p,_+=w*o,_+=N*b,F=_>>>13,_&=8191,_+=R*v,_+=U*(5*T),_+=E*(5*W),_+=S*(5*B),_+=y*(5*H),F+=_>>>13,_&=8191;var a=F;a+=f*H,a+=g*P,a+=m*A,a+=w*p,a+=N*o,F=a>>>13,a&=8191,a+=R*b,a+=U*v,a+=E*(5*T),a+=S*(5*W),a+=y*(5*B),F+=a>>>13,a&=8191;var D=F;D+=f*B,D+=g*H,D+=m*P,D+=w*A,D+=N*p,F=D>>>13,D&=8191,D+=R*o,D+=U*b,D+=E*v,D+=S*(5*T),D+=y*(5*W),F+=D>>>13,D&=8191;var K=F;K+=f*W,K+=g*B,K+=m*H,K+=w*P,K+=N*A,F=K>>>13,K&=8191,K+=R*p,K+=U*o,K+=E*b,K+=S*v,K+=y*(5*T),F+=K>>>13,K&=8191;var V=F;V+=f*T,V+=g*W,V+=m*B,V+=w*H,V+=N*P,F=V>>>13,V&=8191,V+=R*A,V+=U*p,V+=E*o,V+=S*b,V+=y*v,F+=V>>>13,V&=8191,F=(F<<2)+F|0,F=F+G|0,G=F&8191,F=F>>>13,Z+=F,f=G,g=Z,m=re,w=I,N=O,R=_,U=a,E=D,S=K,y=V,h+=16,c-=16}this._h[0]=f,this._h[1]=g,this._h[2]=m,this._h[3]=w,this._h[4]=N,this._h[5]=R,this._h[6]=U,this._h[7]=E,this._h[8]=S,this._h[9]=y},l.prototype.finish=function(u,h){h===void 0&&(h=0);var c=new Uint16Array(10),d,f,g,m;if(this._leftover){for(m=this._leftover,this._buffer[m++]=1;m<16;m++)this._buffer[m]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(d=this._h[1]>>>13,this._h[1]&=8191,m=2;m<10;m++)this._h[m]+=d,d=this._h[m]>>>13,this._h[m]&=8191;for(this._h[0]+=d*5,d=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=d,d=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=d,c[0]=this._h[0]+5,d=c[0]>>>13,c[0]&=8191,m=1;m<10;m++)c[m]=this._h[m]+d,d=c[m]>>>13,c[m]&=8191;for(c[9]-=8192,f=(d^1)-1,m=0;m<10;m++)c[m]&=f;for(f=~f,m=0;m<10;m++)this._h[m]=this._h[m]&f|c[m];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,g=this._h[0]+this._pad[0],this._h[0]=g&65535,m=1;m<8;m++)g=(this._h[m]+this._pad[m]|0)+(g>>>16)|0,this._h[m]=g&65535;return u[h+0]=this._h[0]>>>0,u[h+1]=this._h[0]>>>8,u[h+2]=this._h[1]>>>0,u[h+3]=this._h[1]>>>8,u[h+4]=this._h[2]>>>0,u[h+5]=this._h[2]>>>8,u[h+6]=this._h[3]>>>0,u[h+7]=this._h[3]>>>8,u[h+8]=this._h[4]>>>0,u[h+9]=this._h[4]>>>8,u[h+10]=this._h[5]>>>0,u[h+11]=this._h[5]>>>8,u[h+12]=this._h[6]>>>0,u[h+13]=this._h[6]>>>8,u[h+14]=this._h[7]>>>0,u[h+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(u){var h=0,c=u.length,d;if(this._leftover){d=16-this._leftover,d>c&&(d=c);for(var f=0;f<d;f++)this._buffer[this._leftover+f]=u[h+f];if(c-=d,h+=d,this._leftover+=d,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(c>=16&&(d=c-c%16,this._blocks(u,h,d),h+=d,c-=d),c){for(var f=0;f<c;f++)this._buffer[this._leftover+f]=u[h+f];this._leftover+=c}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},l.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();e.Poly1305=i;function s(l,u){var h=new i(l);h.update(u);var c=h.digest();return h.clean(),c}e.oneTimeAuth=s;function n(l,u){return l.length!==e.DIGEST_LENGTH||u.length!==e.DIGEST_LENGTH?!1:t.equal(l,u)}e.equal=n}(Xn),function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=ai,r=Xn,i=lt,s=Y,n=Pt;e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var l=new Uint8Array(16),u=function(){function h(c){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,c.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(c)}return h.prototype.seal=function(c,d,f,g){if(c.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var m=new Uint8Array(16);m.set(c,m.length-c.length);var w=new Uint8Array(32);t.stream(this._key,m,w,4);var N=d.length+this.tagLength,R;if(g){if(g.length!==N)throw new Error("ChaCha20Poly1305: incorrect destination length");R=g}else R=new Uint8Array(N);return t.streamXOR(this._key,m,d,R,4),this._authenticate(R.subarray(R.length-this.tagLength,R.length),w,R.subarray(0,R.length-this.tagLength),f),i.wipe(m),R},h.prototype.open=function(c,d,f,g){if(c.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(d.length<this.tagLength)return null;var m=new Uint8Array(16);m.set(c,m.length-c.length);var w=new Uint8Array(32);t.stream(this._key,m,w,4);var N=new Uint8Array(this.tagLength);if(this._authenticate(N,w,d.subarray(0,d.length-this.tagLength),f),!n.equal(N,d.subarray(d.length-this.tagLength,d.length)))return null;var R=d.length-this.tagLength,U;if(g){if(g.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");U=g}else U=new Uint8Array(R);return t.streamXOR(this._key,m,d.subarray(0,d.length-this.tagLength),U,4),i.wipe(m),U},h.prototype.clean=function(){return i.wipe(this._key),this},h.prototype._authenticate=function(c,d,f,g){var m=new r.Poly1305(d);g&&(m.update(g),g.length%16>0&&m.update(l.subarray(g.length%16))),m.update(f),f.length%16>0&&m.update(l.subarray(f.length%16));var w=new Uint8Array(8);g&&s.writeUint64LE(g.length,w),m.update(w),s.writeUint64LE(f.length,w),m.update(w);for(var N=m.digest(),R=0;R<N.length;R++)c[R]=N[R];m.clean(),i.wipe(N),i.wipe(w)},h}();e.ChaCha20Poly1305=u}(Xi);var eo={},_r={},es={};Object.defineProperty(es,"__esModule",{value:!0});function pd(e){return typeof e.saveState<"u"&&typeof e.restoreState<"u"&&typeof e.cleanSavedState<"u"}es.isSerializableHash=pd,Object.defineProperty(_r,"__esModule",{value:!0});var Dt=es,fd=Pt,gd=lt,to=function(){function e(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var s=0;s<i.length;s++)i[s]^=54;this._inner.update(i);for(var s=0;s<i.length;s++)i[s]^=106;this._outer.update(i),Dt.isSerializableHash(this._inner)&&Dt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),gd.wipe(i)}return e.prototype.reset=function(){if(!Dt.isSerializableHash(this._inner)||!Dt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){Dt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Dt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(t){return this._inner.update(t),this},e.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},e.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},e.prototype.saveState=function(){if(!Dt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(t){if(!Dt.isSerializableHash(this._inner)||!Dt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(t){if(!Dt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},e}();_r.HMAC=to;function yd(e,t,r){var i=new to(e,t);i.update(r);var s=i.digest();return i.clean(),s}_r.hmac=yd,_r.equal=fd.equal,Object.defineProperty(eo,"__esModule",{value:!0});var ro=_r,io=lt,md=function(){function e(t,r,i,s){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=s;var n=ro.hmac(this._hash,i,r);this._hmac=new ro.HMAC(t,n),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(t){for(var r=new Uint8Array(t),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},e.prototype.clean=function(){this._hmac.clean(),io.wipe(this._buffer),io.wipe(this._counter),this._bufpos=0},e}(),wd=eo.HKDF=md,ci={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Y,r=lt;e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var i=function(){function u(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},u.prototype.update=function(h,c){if(c===void 0&&(c=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var d=0;if(this._bytesHashed+=c,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&c>0;)this._buffer[this._bufferLength++]=h[d++],c--;this._bufferLength===this.blockSize&&(n(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(c>=this.blockSize&&(d=n(this._temp,this._state,h,d,c),c%=this.blockSize);c>0;)this._buffer[this._bufferLength++]=h[d++],c--;return this},u.prototype.finish=function(h){if(!this._finished){var c=this._bytesHashed,d=this._bufferLength,f=c/536870912|0,g=c<<3,m=c%64<56?64:128;this._buffer[d]=128;for(var w=d+1;w<m-8;w++)this._buffer[w]=0;t.writeUint32BE(f,this._buffer,m-8),t.writeUint32BE(g,this._buffer,m-4),n(this._temp,this._state,this._buffer,0,m),this._finished=!0}for(var w=0;w<this.digestLength/4;w++)t.writeUint32BE(this._state[w],h,w*4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();e.SHA256=i;var s=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function n(u,h,c,d,f){for(;f>=64;){for(var g=h[0],m=h[1],w=h[2],N=h[3],R=h[4],U=h[5],E=h[6],S=h[7],y=0;y<16;y++){var v=d+y*4;u[y]=t.readUint32BE(c,v)}for(var y=16;y<64;y++){var b=u[y-2],o=(b>>>17|b<<15)^(b>>>19|b<<13)^b>>>10;b=u[y-15];var p=(b>>>7|b<<25)^(b>>>18|b<<14)^b>>>3;u[y]=(o+u[y-7]|0)+(p+u[y-16]|0)}for(var y=0;y<64;y++){var o=(((R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7))+(R&U^~R&E)|0)+(S+(s[y]+u[y]|0)|0)|0,p=((g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10))+(g&m^g&w^m&w)|0;S=E,E=U,U=R,R=N+o|0,N=w,w=m,m=g,g=o+p|0}h[0]+=g,h[1]+=m,h[2]+=w,h[3]+=N,h[4]+=R,h[5]+=U,h[6]+=E,h[7]+=S,d+=64,f-=64}return d}function l(u){var h=new i;h.update(u);var c=h.digest();return h.clean(),c}e.hash=l})(ci);var ts={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.sharedKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.scalarMultBase=e.scalarMult=e.SHARED_KEY_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=void 0;const t=rr,r=lt;e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;function i(y){const v=new Float64Array(16);if(y)for(let b=0;b<y.length;b++)v[b]=y[b];return v}const s=new Uint8Array(32);s[0]=9;const n=i([56129,1]);function l(y){let v=1;for(let b=0;b<16;b++){let o=y[b]+v+65535;v=Math.floor(o/65536),y[b]=o-v*65536}y[0]+=v-1+37*(v-1)}function u(y,v,b){const o=~(b-1);for(let p=0;p<16;p++){const A=o&(y[p]^v[p]);y[p]^=A,v[p]^=A}}function h(y,v){const b=i(),o=i();for(let p=0;p<16;p++)o[p]=v[p];l(o),l(o),l(o);for(let p=0;p<2;p++){b[0]=o[0]-65517;for(let P=1;P<15;P++)b[P]=o[P]-65535-(b[P-1]>>16&1),b[P-1]&=65535;b[15]=o[15]-32767-(b[14]>>16&1);const A=b[15]>>16&1;b[14]&=65535,u(o,b,1-A)}for(let p=0;p<16;p++)y[2*p]=o[p]&255,y[2*p+1]=o[p]>>8}function c(y,v){for(let b=0;b<16;b++)y[b]=v[2*b]+(v[2*b+1]<<8);y[15]&=32767}function d(y,v,b){for(let o=0;o<16;o++)y[o]=v[o]+b[o]}function f(y,v,b){for(let o=0;o<16;o++)y[o]=v[o]-b[o]}function g(y,v,b){let o,p,A=0,P=0,H=0,B=0,W=0,T=0,C=0,q=0,M=0,x=0,L=0,j=0,k=0,Q=0,F=0,G=0,Z=0,re=0,I=0,O=0,_=0,a=0,D=0,K=0,V=0,ne=0,he=0,oe=0,fe=0,Ie=0,_e=0,ue=b[0],ae=b[1],se=b[2],ie=b[3],te=b[4],ee=b[5],J=b[6],X=b[7],ce=b[8],le=b[9],de=b[10],pe=b[11],ge=b[12],ye=b[13],me=b[14],De=b[15];o=v[0],A+=o*ue,P+=o*ae,H+=o*se,B+=o*ie,W+=o*te,T+=o*ee,C+=o*J,q+=o*X,M+=o*ce,x+=o*le,L+=o*de,j+=o*pe,k+=o*ge,Q+=o*ye,F+=o*me,G+=o*De,o=v[1],P+=o*ue,H+=o*ae,B+=o*se,W+=o*ie,T+=o*te,C+=o*ee,q+=o*J,M+=o*X,x+=o*ce,L+=o*le,j+=o*de,k+=o*pe,Q+=o*ge,F+=o*ye,G+=o*me,Z+=o*De,o=v[2],H+=o*ue,B+=o*ae,W+=o*se,T+=o*ie,C+=o*te,q+=o*ee,M+=o*J,x+=o*X,L+=o*ce,j+=o*le,k+=o*de,Q+=o*pe,F+=o*ge,G+=o*ye,Z+=o*me,re+=o*De,o=v[3],B+=o*ue,W+=o*ae,T+=o*se,C+=o*ie,q+=o*te,M+=o*ee,x+=o*J,L+=o*X,j+=o*ce,k+=o*le,Q+=o*de,F+=o*pe,G+=o*ge,Z+=o*ye,re+=o*me,I+=o*De,o=v[4],W+=o*ue,T+=o*ae,C+=o*se,q+=o*ie,M+=o*te,x+=o*ee,L+=o*J,j+=o*X,k+=o*ce,Q+=o*le,F+=o*de,G+=o*pe,Z+=o*ge,re+=o*ye,I+=o*me,O+=o*De,o=v[5],T+=o*ue,C+=o*ae,q+=o*se,M+=o*ie,x+=o*te,L+=o*ee,j+=o*J,k+=o*X,Q+=o*ce,F+=o*le,G+=o*de,Z+=o*pe,re+=o*ge,I+=o*ye,O+=o*me,_+=o*De,o=v[6],C+=o*ue,q+=o*ae,M+=o*se,x+=o*ie,L+=o*te,j+=o*ee,k+=o*J,Q+=o*X,F+=o*ce,G+=o*le,Z+=o*de,re+=o*pe,I+=o*ge,O+=o*ye,_+=o*me,a+=o*De,o=v[7],q+=o*ue,M+=o*ae,x+=o*se,L+=o*ie,j+=o*te,k+=o*ee,Q+=o*J,F+=o*X,G+=o*ce,Z+=o*le,re+=o*de,I+=o*pe,O+=o*ge,_+=o*ye,a+=o*me,D+=o*De,o=v[8],M+=o*ue,x+=o*ae,L+=o*se,j+=o*ie,k+=o*te,Q+=o*ee,F+=o*J,G+=o*X,Z+=o*ce,re+=o*le,I+=o*de,O+=o*pe,_+=o*ge,a+=o*ye,D+=o*me,K+=o*De,o=v[9],x+=o*ue,L+=o*ae,j+=o*se,k+=o*ie,Q+=o*te,F+=o*ee,G+=o*J,Z+=o*X,re+=o*ce,I+=o*le,O+=o*de,_+=o*pe,a+=o*ge,D+=o*ye,K+=o*me,V+=o*De,o=v[10],L+=o*ue,j+=o*ae,k+=o*se,Q+=o*ie,F+=o*te,G+=o*ee,Z+=o*J,re+=o*X,I+=o*ce,O+=o*le,_+=o*de,a+=o*pe,D+=o*ge,K+=o*ye,V+=o*me,ne+=o*De,o=v[11],j+=o*ue,k+=o*ae,Q+=o*se,F+=o*ie,G+=o*te,Z+=o*ee,re+=o*J,I+=o*X,O+=o*ce,_+=o*le,a+=o*de,D+=o*pe,K+=o*ge,V+=o*ye,ne+=o*me,he+=o*De,o=v[12],k+=o*ue,Q+=o*ae,F+=o*se,G+=o*ie,Z+=o*te,re+=o*ee,I+=o*J,O+=o*X,_+=o*ce,a+=o*le,D+=o*de,K+=o*pe,V+=o*ge,ne+=o*ye,he+=o*me,oe+=o*De,o=v[13],Q+=o*ue,F+=o*ae,G+=o*se,Z+=o*ie,re+=o*te,I+=o*ee,O+=o*J,_+=o*X,a+=o*ce,D+=o*le,K+=o*de,V+=o*pe,ne+=o*ge,he+=o*ye,oe+=o*me,fe+=o*De,o=v[14],F+=o*ue,G+=o*ae,Z+=o*se,re+=o*ie,I+=o*te,O+=o*ee,_+=o*J,a+=o*X,D+=o*ce,K+=o*le,V+=o*de,ne+=o*pe,he+=o*ge,oe+=o*ye,fe+=o*me,Ie+=o*De,o=v[15],G+=o*ue,Z+=o*ae,re+=o*se,I+=o*ie,O+=o*te,_+=o*ee,a+=o*J,D+=o*X,K+=o*ce,V+=o*le,ne+=o*de,he+=o*pe,oe+=o*ge,fe+=o*ye,Ie+=o*me,_e+=o*De,A+=38*Z,P+=38*re,H+=38*I,B+=38*O,W+=38*_,T+=38*a,C+=38*D,q+=38*K,M+=38*V,x+=38*ne,L+=38*he,j+=38*oe,k+=38*fe,Q+=38*Ie,F+=38*_e,p=1,o=A+p+65535,p=Math.floor(o/65536),A=o-p*65536,o=P+p+65535,p=Math.floor(o/65536),P=o-p*65536,o=H+p+65535,p=Math.floor(o/65536),H=o-p*65536,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=W+p+65535,p=Math.floor(o/65536),W=o-p*65536,o=T+p+65535,p=Math.floor(o/65536),T=o-p*65536,o=C+p+65535,p=Math.floor(o/65536),C=o-p*65536,o=q+p+65535,p=Math.floor(o/65536),q=o-p*65536,o=M+p+65535,p=Math.floor(o/65536),M=o-p*65536,o=x+p+65535,p=Math.floor(o/65536),x=o-p*65536,o=L+p+65535,p=Math.floor(o/65536),L=o-p*65536,o=j+p+65535,p=Math.floor(o/65536),j=o-p*65536,o=k+p+65535,p=Math.floor(o/65536),k=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,o=F+p+65535,p=Math.floor(o/65536),F=o-p*65536,o=G+p+65535,p=Math.floor(o/65536),G=o-p*65536,A+=p-1+37*(p-1),p=1,o=A+p+65535,p=Math.floor(o/65536),A=o-p*65536,o=P+p+65535,p=Math.floor(o/65536),P=o-p*65536,o=H+p+65535,p=Math.floor(o/65536),H=o-p*65536,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=W+p+65535,p=Math.floor(o/65536),W=o-p*65536,o=T+p+65535,p=Math.floor(o/65536),T=o-p*65536,o=C+p+65535,p=Math.floor(o/65536),C=o-p*65536,o=q+p+65535,p=Math.floor(o/65536),q=o-p*65536,o=M+p+65535,p=Math.floor(o/65536),M=o-p*65536,o=x+p+65535,p=Math.floor(o/65536),x=o-p*65536,o=L+p+65535,p=Math.floor(o/65536),L=o-p*65536,o=j+p+65535,p=Math.floor(o/65536),j=o-p*65536,o=k+p+65535,p=Math.floor(o/65536),k=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,o=F+p+65535,p=Math.floor(o/65536),F=o-p*65536,o=G+p+65535,p=Math.floor(o/65536),G=o-p*65536,A+=p-1+37*(p-1),y[0]=A,y[1]=P,y[2]=H,y[3]=B,y[4]=W,y[5]=T,y[6]=C,y[7]=q,y[8]=M,y[9]=x,y[10]=L,y[11]=j,y[12]=k,y[13]=Q,y[14]=F,y[15]=G}function m(y,v){g(y,v,v)}function w(y,v){const b=i();for(let o=0;o<16;o++)b[o]=v[o];for(let o=253;o>=0;o--)m(b,b),o!==2&&o!==4&&g(b,b,v);for(let o=0;o<16;o++)y[o]=b[o]}function N(y,v){const b=new Uint8Array(32),o=new Float64Array(80),p=i(),A=i(),P=i(),H=i(),B=i(),W=i();for(let M=0;M<31;M++)b[M]=y[M];b[31]=y[31]&127|64,b[0]&=248,c(o,v);for(let M=0;M<16;M++)A[M]=o[M];p[0]=H[0]=1;for(let M=254;M>=0;--M){const x=b[M>>>3]>>>(M&7)&1;u(p,A,x),u(P,H,x),d(B,p,P),f(p,p,P),d(P,A,H),f(A,A,H),m(H,B),m(W,p),g(p,P,p),g(P,A,B),d(B,p,P),f(p,p,P),m(A,p),f(P,H,W),g(p,P,n),d(p,p,H),g(P,P,p),g(p,H,W),g(H,A,o),m(A,B),u(p,A,x),u(P,H,x)}for(let M=0;M<16;M++)o[M+16]=p[M],o[M+32]=P[M],o[M+48]=A[M],o[M+64]=H[M];const T=o.subarray(32),C=o.subarray(16);w(T,T),g(C,C,T);const q=new Uint8Array(32);return h(q,C),q}e.scalarMult=N;function R(y){return N(y,s)}e.scalarMultBase=R;function U(y){if(y.length!==e.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${e.SECRET_KEY_LENGTH} bytes`);const v=new Uint8Array(y);return{publicKey:R(v),secretKey:v}}e.generateKeyPairFromSeed=U;function E(y){const v=(0,t.randomBytes)(32,y),b=U(v);return(0,r.wipe)(v),b}e.generateKeyPair=E;function S(y,v,b=!1){if(y.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(v.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=N(y,v);if(b){let p=0;for(let A=0;A<o.length;A++)p|=o[A];if(p===0)throw new Error("X25519: invalid shared key")}return o}e.sharedKey=S})(ts);var so=function(e,t,r){if(r||arguments.length===2)for(var i=0,s=t.length,n;i<s;i++)(n||!(i in t))&&(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Dd=function(){function e(t,r,i){this.name=t,this.version=r,this.os=i,this.type="browser"}return e}(),bd=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=Lt.platform}return e}(),vd=function(){function e(t,r,i,s){this.name=t,this.version=r,this.os=i,this.bot=s,this.type="bot-device"}return e}(),Ed=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),_d=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),Sd=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Id=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,no=3,Od=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Sd]],oo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Cd(e){return e?ao(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new _d:typeof navigator<"u"?ao(navigator.userAgent):Ad()}function Nd(e){return e!==""&&Od.reduce(function(t,r){var i=r[0],s=r[1];if(t)return t;var n=s.exec(e);return!!n&&[i,n]},!1)}function ao(e){var t=Nd(e);if(!t)return null;var r=t[0],i=t[1];if(r==="searchbot")return new Ed;var s=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);s?s.length<no&&(s=so(so([],s,!0),Pd(no-s.length),!0)):s=[];var n=s.join("."),l=Td(e),u=Id.exec(e);return u&&u[1]?new vd(r,n,l,u[1]):new Dd(r,n,l)}function Td(e){for(var t=0,r=oo.length;t<r;t++){var i=oo[t],s=i[0],n=i[1],l=n.exec(e);if(l)return s}return null}function Ad(){var e=typeof Lt<"u"&&"v20.9.0";return e?new bd("v20.9.0".slice(1)):null}function Pd(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}var we={};Object.defineProperty(we,"__esModule",{value:!0}),we.getLocalStorage=we.getLocalStorageOrThrow=we.getCrypto=we.getCryptoOrThrow=uo=we.getLocation=we.getLocationOrThrow=rs=we.getNavigator=we.getNavigatorOrThrow=co=we.getDocument=we.getDocumentOrThrow=we.getFromWindowOrThrow=we.getFromWindow=void 0;function qt(e){let t;return typeof window<"u"&&typeof window[e]<"u"&&(t=window[e]),t}we.getFromWindow=qt;function ir(e){const t=qt(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}we.getFromWindowOrThrow=ir;function Rd(){return ir("document")}we.getDocumentOrThrow=Rd;function xd(){return qt("document")}var co=we.getDocument=xd;function Ud(){return ir("navigator")}we.getNavigatorOrThrow=Ud;function Ld(){return qt("navigator")}var rs=we.getNavigator=Ld;function jd(){return ir("location")}we.getLocationOrThrow=jd;function Md(){return qt("location")}var uo=we.getLocation=Md;function kd(){return ir("crypto")}we.getCryptoOrThrow=kd;function Fd(){return qt("crypto")}we.getCrypto=Fd;function Kd(){return ir("localStorage")}we.getLocalStorageOrThrow=Kd;function zd(){return qt("localStorage")}we.getLocalStorage=zd;var is={};Object.defineProperty(is,"__esModule",{value:!0});var lo=is.getWindowMetadata=void 0;const ho=we;function Hd(){let e,t;try{e=ho.getDocumentOrThrow(),t=ho.getLocationOrThrow()}catch{return null}function r(){const d=e.getElementsByTagName("link"),f=[];for(let g=0;g<d.length;g++){const m=d[g],w=m.getAttribute("rel");if(w&&w.toLowerCase().indexOf("icon")>-1){const N=m.getAttribute("href");if(N)if(N.toLowerCase().indexOf("https:")===-1&&N.toLowerCase().indexOf("http:")===-1&&N.indexOf("//")!==0){let R=t.protocol+"//"+t.host;if(N.indexOf("/")===0)R+=N;else{const U=t.pathname.split("/");U.pop();const E=U.join("/");R+=E+"/"+N}f.push(R)}else if(N.indexOf("//")===0){const R=t.protocol+N;f.push(R)}else f.push(N)}}return f}function i(...d){const f=e.getElementsByTagName("meta");for(let g=0;g<f.length;g++){const m=f[g],w=["itemprop","property","name"].map(N=>m.getAttribute(N)).filter(N=>N?d.includes(N):!1);if(w.length&&w){const N=m.getAttribute("content");if(N)return N}}return""}function s(){let d=i("name","og:site_name","og:title","twitter:title");return d||(d=e.title),d}function n(){return i("description","og:description","twitter:description","keywords")}const l=s(),u=n(),h=t.origin,c=r();return{description:u,url:h,icons:c,name:l}}lo=is.getWindowMetadata=Hd;var Sr={},Vd=e=>encodeURIComponent(e).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),po="%[a-f0-9]{2}",fo=new RegExp("("+po+")|([^%]+?)","gi"),go=new RegExp("("+po+")+","gi");function ss(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;t=t||1;var r=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],ss(r),ss(i))}function qd(e){try{return decodeURIComponent(e)}catch{for(var t=e.match(fo)||[],r=1;r<t.length;r++)e=ss(t,r).join(""),t=e.match(fo)||[];return e}}function $d(e){for(var t={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=go.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var i=qd(r[0]);i!==r[0]&&(t[r[0]]=i)}r=go.exec(e)}t["%C2"]="\uFFFD";for(var s=Object.keys(t),n=0;n<s.length;n++){var l=s[n];e=e.replace(new RegExp(l,"g"),t[l])}return e}var Bd=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return $d(e)}},Wd=(e,t)=>{if(!(typeof e=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[e];const r=e.indexOf(t);return r===-1?[e]:[e.slice(0,r),e.slice(r+t.length)]},Gd=function(e,t){for(var r={},i=Object.keys(e),s=Array.isArray(t),n=0;n<i.length;n++){var l=i[n],u=e[l];(s?t.indexOf(l)!==-1:t(l,u,e))&&(r[l]=u)}return r};(function(e){const t=Vd,r=Bd,i=Wd,s=Gd,n=E=>E==null,l=Symbol("encodeFragmentIdentifier");function u(E){switch(E.arrayFormat){case"index":return S=>(y,v)=>{const b=y.length;return v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?y:v===null?[...y,[d(S,E),"[",b,"]"].join("")]:[...y,[d(S,E),"[",d(b,E),"]=",d(v,E)].join("")]};case"bracket":return S=>(y,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?y:v===null?[...y,[d(S,E),"[]"].join("")]:[...y,[d(S,E),"[]=",d(v,E)].join("")];case"colon-list-separator":return S=>(y,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?y:v===null?[...y,[d(S,E),":list="].join("")]:[...y,[d(S,E),":list=",d(v,E)].join("")];case"comma":case"separator":case"bracket-separator":{const S=E.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(v,b)=>b===void 0||E.skipNull&&b===null||E.skipEmptyString&&b===""?v:(b=b===null?"":b,v.length===0?[[d(y,E),S,d(b,E)].join("")]:[[v,d(b,E)].join(E.arrayFormatSeparator)])}default:return S=>(y,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?y:v===null?[...y,d(S,E)]:[...y,[d(S,E),"=",d(v,E)].join("")]}}function h(E){let S;switch(E.arrayFormat){case"index":return(y,v,b)=>{if(S=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!S){b[y]=v;return}b[y]===void 0&&(b[y]={}),b[y][S[1]]=v};case"bracket":return(y,v,b)=>{if(S=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!S){b[y]=v;return}if(b[y]===void 0){b[y]=[v];return}b[y]=[].concat(b[y],v)};case"colon-list-separator":return(y,v,b)=>{if(S=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!S){b[y]=v;return}if(b[y]===void 0){b[y]=[v];return}b[y]=[].concat(b[y],v)};case"comma":case"separator":return(y,v,b)=>{const o=typeof v=="string"&&v.includes(E.arrayFormatSeparator),p=typeof v=="string"&&!o&&f(v,E).includes(E.arrayFormatSeparator);v=p?f(v,E):v;const A=o||p?v.split(E.arrayFormatSeparator).map(P=>f(P,E)):v===null?v:f(v,E);b[y]=A};case"bracket-separator":return(y,v,b)=>{const o=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!o){b[y]=v&&f(v,E);return}const p=v===null?[]:v.split(E.arrayFormatSeparator).map(A=>f(A,E));if(b[y]===void 0){b[y]=p;return}b[y]=[].concat(b[y],p)};default:return(y,v,b)=>{if(b[y]===void 0){b[y]=v;return}b[y]=[].concat(b[y],v)}}}function c(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function d(E,S){return S.encode?S.strict?t(E):encodeURIComponent(E):E}function f(E,S){return S.decode?r(E):E}function g(E){return Array.isArray(E)?E.sort():typeof E=="object"?g(Object.keys(E)).sort((S,y)=>Number(S)-Number(y)).map(S=>E[S]):E}function m(E){const S=E.indexOf("#");return S!==-1&&(E=E.slice(0,S)),E}function w(E){let S="";const y=E.indexOf("#");return y!==-1&&(S=E.slice(y)),S}function N(E){E=m(E);const S=E.indexOf("?");return S===-1?"":E.slice(S+1)}function R(E,S){return S.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):S.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function U(E,S){S=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},S),c(S.arrayFormatSeparator);const y=h(S),v=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return v;for(const b of E.split("&")){if(b==="")continue;let[o,p]=i(S.decode?b.replace(/\+/g," "):b,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(S.arrayFormat)?p:f(p,S),y(f(o,S),p,v)}for(const b of Object.keys(v)){const o=v[b];if(typeof o=="object"&&o!==null)for(const p of Object.keys(o))o[p]=R(o[p],S);else v[b]=R(o,S)}return S.sort===!1?v:(S.sort===!0?Object.keys(v).sort():Object.keys(v).sort(S.sort)).reduce((b,o)=>{const p=v[o];return p&&typeof p=="object"&&!Array.isArray(p)?b[o]=g(p):b[o]=p,b},Object.create(null))}e.extract=N,e.parse=U,e.stringify=(E,S)=>{if(!E)return"";S=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},S),c(S.arrayFormatSeparator);const y=p=>S.skipNull&&n(E[p])||S.skipEmptyString&&E[p]==="",v=u(S),b={};for(const p of Object.keys(E))y(p)||(b[p]=E[p]);const o=Object.keys(b);return S.sort!==!1&&o.sort(S.sort),o.map(p=>{const A=E[p];return A===void 0?"":A===null?d(p,S):Array.isArray(A)?A.length===0&&S.arrayFormat==="bracket-separator"?d(p,S)+"[]":A.reduce(v(p),[]).join("&"):d(p,S)+"="+d(A,S)}).filter(p=>p.length>0).join("&")},e.parseUrl=(E,S)=>{S=Object.assign({decode:!0},S);const[y,v]=i(E,"#");return Object.assign({url:y.split("?")[0]||"",query:U(N(E),S)},S&&S.parseFragmentIdentifier&&v?{fragmentIdentifier:f(v,S)}:{})},e.stringifyUrl=(E,S)=>{S=Object.assign({encode:!0,strict:!0,[l]:!0},S);const y=m(E.url).split("?")[0]||"",v=e.extract(E.url),b=e.parse(v,{sort:!1}),o=Object.assign(b,E.query);let p=e.stringify(o,S);p&&(p=`?${p}`);let A=w(E.url);return E.fragmentIdentifier&&(A=`#${S[l]?d(E.fragmentIdentifier,S):E.fragmentIdentifier}`),`${y}${p}${A}`},e.pick=(E,S,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[l]:!1},y);const{url:v,query:b,fragmentIdentifier:o}=e.parseUrl(E,y);return e.stringifyUrl({url:v,query:s(b,S),fragmentIdentifier:o},y)},e.exclude=(E,S,y)=>{const v=Array.isArray(S)?b=>!S.includes(b):(b,o)=>!S(b,o);return e.pick(E,v,y)}})(Sr);const Yd={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function yo(e,t){return e.includes(":")?[e]:t.chains||[]}const mo="base10",tt="base16",ns="base64pad",os="utf8",wo=0,$t=1,Qd=0,Do=1,as=12,cs=32;function Jd(){const e=ts.generateKeyPair();return{privateKey:et(e.secretKey,tt),publicKey:et(e.publicKey,tt)}}function us(){const e=rr.randomBytes(cs);return et(e,tt)}function Xd(e,t){const r=ts.sharedKey(ot(e,tt),ot(t,tt)),i=new wd(ci.SHA256,r).expand(cs);return et(i,tt)}function Zd(e){const t=ci.hash(ot(e,tt));return et(t,tt)}function sr(e){const t=ci.hash(ot(e,os));return et(t,tt)}function ep(e){return ot(`${e}`,mo)}function Ir(e){return Number(et(e,mo))}function tp(e){const t=ep(typeof e.type<"u"?e.type:wo);if(Ir(t)===$t&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?ot(e.senderPublicKey,tt):void 0,i=typeof e.iv<"u"?ot(e.iv,tt):rr.randomBytes(as),s=new Xi.ChaCha20Poly1305(ot(e.symKey,tt)).seal(i,ot(e.message,os));return ip({type:t,sealed:s,iv:i,senderPublicKey:r})}function rp(e){const t=new Xi.ChaCha20Poly1305(ot(e.symKey,tt)),{sealed:r,iv:i}=ui(e.encoded),s=t.open(i,r);if(s===null)throw new Error("Failed to decrypt");return et(s,os)}function ip(e){if(Ir(e.type)===$t){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return et(Qi([e.type,e.senderPublicKey,e.iv,e.sealed]),ns)}return et(Qi([e.type,e.iv,e.sealed]),ns)}function ui(e){const t=ot(e,ns),r=t.slice(Qd,Do),i=Do;if(Ir(r)===$t){const u=i+cs,h=u+as,c=t.slice(i,u),d=t.slice(u,h),f=t.slice(h);return{type:r,sealed:f,iv:d,senderPublicKey:c}}const s=i+as,n=t.slice(i,s),l=t.slice(s);return{type:r,sealed:l,iv:n}}function sp(e,t){const r=ui(e);return bo({type:Ir(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?et(r.senderPublicKey,tt):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function bo(e){const t=(e==null?void 0:e.type)||wo;if(t===$t){if(typeof(e==null?void 0:e.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(e==null?void 0:e.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e==null?void 0:e.senderPublicKey,receiverPublicKey:e==null?void 0:e.receiverPublicKey}}function vo(e){return e.type===$t&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}var np=Object.defineProperty,Eo=Object.getOwnPropertySymbols,op=Object.prototype.hasOwnProperty,ap=Object.prototype.propertyIsEnumerable,_o=(e,t,r)=>t in e?np(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,So=(e,t)=>{for(var r in t||(t={}))op.call(t,r)&&_o(e,r,t[r]);if(Eo)for(var r of Eo(t))ap.call(t,r)&&_o(e,r,t[r]);return e};const cp="ReactNative",ht={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},up="js";function ls(){return typeof Lt<"u"&&typeof Lt.versions<"u"&&typeof Lt.versions.node<"u"}function li(){return!co()&&!!rs()&&navigator.product===cp}function Or(){return!ls()&&!!rs()}function Cr(){return li()?ht.reactNative:ls()?ht.node:Or()?ht.browser:ht.unknown}function lp(e,t){let r=Sr.parse(e);return r=So(So({},r),t),e=Sr.stringify(r),e}function hp(){return lo()||{name:"",description:"",url:"",icons:[""]}}function dp(){if(Cr()===ht.reactNative&&typeof be<"u"&&typeof(be==null?void 0:be.Platform)<"u"){const{OS:r,Version:i}=be.Platform;return[r,i].join("-")}const e=Cd();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function pp(){var e;const t=Cr();return t===ht.browser?[t,((e=uo())==null?void 0:e.host)||"unknown"].join(":"):t}function fp(e,t,r){const i=dp(),s=pp();return[[e,t].join("-"),[up,r].join("-"),i,s].join("/")}function gp({protocol:e,version:t,relayUrl:r,sdkVersion:i,auth:s,projectId:n,useOnCloseEvent:l}){const u=r.split("?"),h=fp(e,t,i),c={auth:s,ua:h,projectId:n,useOnCloseEvent:l||void 0},d=lp(u[1]||"",c);return u[0]+"?"+d}function Bt(e,t){return e.filter(r=>t.includes(r)).length===e.length}function Io(e){return Object.fromEntries(e.entries())}function Oo(e){return new Map(Object.entries(e))}function nr(e=$.FIVE_MINUTES,t){const r=$.toMiliseconds(e||$.FIVE_MINUTES);let i,s,n;return{resolve:l=>{n&&i&&(clearTimeout(n),i(l))},reject:l=>{n&&s&&(clearTimeout(n),s(l))},done:()=>new Promise((l,u)=>{n=setTimeout(()=>{u(new Error(t))},r),i=l,s=u})}}function Nr(e,t,r){return new Promise(async(i,s)=>{const n=setTimeout(()=>s(new Error(r)),t);try{const l=await e;i(l)}catch(l){s(l)}clearTimeout(n)})}function Co(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function yp(e){return Co("topic",e)}function mp(e){return Co("id",e)}function No(e){const[t,r]=e.split(":"),i={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")i.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return i}function yt(e,t){return $.fromMiliseconds((t||Date.now())+$.toMiliseconds(e))}function Rt(e){return Date.now()>=$.toMiliseconds(e)}function Ee(e,t){return`${e}${t?`:${t}`:""}`}async function wp({id:e,topic:t,wcDeepLink:r}){var i;try{if(!r)return;let s=(i=typeof r=="string"?JSON.parse(r):r)==null?void 0:i.href;if(typeof s!="string")return;s.endsWith("/")&&(s=s.slice(0,-1));const n=`${s}/wc?requestId=${e}&sessionTopic=${t}`,l=Cr();l===ht.browser?n.startsWith("https://")?window.open(n,"_blank","noreferrer noopener"):window.open(n,"_self","noreferrer noopener"):l===ht.reactNative&&typeof(be==null?void 0:be.Linking)<"u"&&await be.Linking.openURL(n)}catch(s){console.error(s)}}const Dp="irn";function hs(e){return(e==null?void 0:e.relay)||{protocol:Dp}}function hi(e){const t=Yd[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var bp=Object.defineProperty,To=Object.getOwnPropertySymbols,vp=Object.prototype.hasOwnProperty,Ep=Object.prototype.propertyIsEnumerable,Ao=(e,t,r)=>t in e?bp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_p=(e,t)=>{for(var r in t||(t={}))vp.call(t,r)&&Ao(e,r,t[r]);if(To)for(var r of To(t))Ep.call(t,r)&&Ao(e,r,t[r]);return e};function Sp(e,t="-"){const r={},i="relay"+t;return Object.keys(e).forEach(s=>{if(s.startsWith(i)){const n=s.replace(i,""),l=e[s];r[n]=l}}),r}function Ip(e){const t=e.indexOf(":"),r=e.indexOf("?")!==-1?e.indexOf("?"):void 0,i=e.substring(0,t),s=e.substring(t+1,r).split("@"),n=typeof r<"u"?e.substring(r):"",l=Sr.parse(n);return{protocol:i,topic:Op(s[0]),version:parseInt(s[1],10),symKey:l.symKey,relay:Sp(l)}}function Op(e){return e.startsWith("//")?e.substring(2):e}function Cp(e,t="-"){const r="relay",i={};return Object.keys(e).forEach(s=>{const n=r+t+s;e[s]&&(i[n]=e[s])}),i}function Np(e){return`${e.protocol}:${e.topic}@${e.version}?`+Sr.stringify(_p({symKey:e.symKey},Cp(e.relay)))}function or(e){const t=[];return e.forEach(r=>{const[i,s]=r.split(":");t.push(`${i}:${s}`)}),t}function Tp(e){const t=[];return Object.values(e).forEach(r=>{t.push(...or(r.accounts))}),t}function Ap(e,t){const r=[];return Object.values(e).forEach(i=>{or(i.accounts).includes(t)&&r.push(...i.methods)}),r}function Pp(e,t){const r=[];return Object.values(e).forEach(i=>{or(i.accounts).includes(t)&&r.push(...i.events)}),r}function Rp(e,t){const r=pi(e,t);if(r)throw new Error(r.message);const i={};for(const[s,n]of Object.entries(e))i[s]={methods:n.methods,events:n.events,chains:n.accounts.map(l=>`${l.split(":")[0]}:${l.split(":")[1]}`)};return i}const xp={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Up={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function z(e,t){const{message:r,code:i}=Up[e];return{message:t?`${r} ${t}`:r,code:i}}function Ce(e,t){const{message:r,code:i}=xp[e];return{message:t?`${r} ${t}`:r,code:i}}function Tr(e,t){return Array.isArray(e)?typeof t<"u"&&e.length?e.every(t):!0:!1}function Ar(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function rt(e){return typeof e>"u"}function Ne(e,t){return t&&rt(e)?!0:typeof e=="string"&&!!e.trim().length}function ds(e,t){return t&&rt(e)?!0:typeof e=="number"&&!isNaN(e)}function Lp(e,t){const{requiredNamespaces:r}=t,i=Object.keys(e.namespaces),s=Object.keys(r);let n=!0;return Bt(s,i)?(i.forEach(l=>{const{accounts:u,methods:h,events:c}=e.namespaces[l],d=or(u),f=r[l];(!Bt(yo(l,f),d)||!Bt(f.methods,h)||!Bt(f.events,c))&&(n=!1)}),n):!1}function di(e){return Ne(e,!1)&&e.includes(":")?e.split(":").length===2:!1}function jp(e){if(Ne(e,!1)&&e.includes(":")){const t=e.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&di(r)}}return!1}function Mp(e){if(Ne(e,!1))try{return typeof new URL(e)<"u"}catch{return!1}return!1}function kp(e){var t;return(t=e==null?void 0:e.proposer)==null?void 0:t.publicKey}function Fp(e){return e==null?void 0:e.topic}function Kp(e,t){let r=null;return Ne(e==null?void 0:e.publicKey,!1)||(r=z("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Po(e){let t=!0;return Tr(e)?e.length&&(t=e.every(r=>Ne(r,!1))):t=!1,t}function zp(e,t,r){let i=null;return Tr(t)&&t.length?t.forEach(s=>{i||di(s)||(i=Ce("UNSUPPORTED_CHAINS",`${r}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):di(e)||(i=Ce("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function Hp(e,t,r){let i=null;return Object.entries(e).forEach(([s,n])=>{if(i)return;const l=zp(s,yo(s,n),`${t} ${r}`);l&&(i=l)}),i}function Vp(e,t){let r=null;return Tr(e)?e.forEach(i=>{r||jp(i)||(r=Ce("UNSUPPORTED_ACCOUNTS",`${t}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=Ce("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function qp(e,t){let r=null;return Object.values(e).forEach(i=>{if(r)return;const s=Vp(i==null?void 0:i.accounts,`${t} namespace`);s&&(r=s)}),r}function $p(e,t){let r=null;return Po(e==null?void 0:e.methods)?Po(e==null?void 0:e.events)||(r=Ce("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Ce("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Ro(e,t){let r=null;return Object.values(e).forEach(i=>{if(r)return;const s=$p(i,`${t}, namespace`);s&&(r=s)}),r}function Bp(e,t,r){let i=null;if(e&&Ar(e)){const s=Ro(e,t);s&&(i=s);const n=Hp(e,t,r);n&&(i=n)}else i=z("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return i}function pi(e,t){let r=null;if(e&&Ar(e)){const i=Ro(e,t);i&&(r=i);const s=qp(e,t);s&&(r=s)}else r=z("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function xo(e){return Ne(e.protocol,!0)}function Wp(e,t){let r=!1;return t&&!e?r=!0:e&&Tr(e)&&e.length&&e.forEach(i=>{r=xo(i)}),r}function Gp(e){return typeof e=="number"}function at(e){return typeof e<"u"&&typeof e!==null}function Yp(e){return!(!e||typeof e!="object"||!e.code||!ds(e.code,!1)||!e.message||!Ne(e.message,!1))}function Qp(e){return!(rt(e)||!Ne(e.method,!1))}function Jp(e){return!(rt(e)||rt(e.result)&&rt(e.error)||!ds(e.id,!1)||!Ne(e.jsonrpc,!1))}function Xp(e){return!(rt(e)||!Ne(e.name,!1))}function Uo(e,t){return!(!di(t)||!Tp(e).includes(t))}function Zp(e,t,r){return Ne(r,!1)?Ap(e,t).includes(r):!1}function ef(e,t,r){return Ne(r,!1)?Pp(e,t).includes(r):!1}function Lo(e,t,r){let i=null;const s=tf(e),n=rf(t),l=Object.keys(s),u=Object.keys(n),h=jo(Object.keys(e)),c=jo(Object.keys(t)),d=h.filter(f=>!c.includes(f));return d.length&&(i=z("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${d.toString()}
      Received: ${Object.keys(t).toString()}`)),Bt(l,u)||(i=z("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${l.toString()}
      Approved: ${u.toString()}`)),Object.keys(t).forEach(f=>{if(!f.includes(":")||i)return;const g=or(t[f].accounts);g.includes(f)||(i=z("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${f}
        Required: ${f}
        Approved: ${g.toString()}`))}),l.forEach(f=>{i||(Bt(s[f].methods,n[f].methods)?Bt(s[f].events,n[f].events)||(i=z("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${f}`)):i=z("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${f}`))}),i}function tf(e){const t={};return Object.keys(e).forEach(r=>{var i;r.includes(":")?t[r]=e[r]:(i=e[r].chains)==null||i.forEach(s=>{t[s]={methods:e[r].methods,events:e[r].events}})}),t}function jo(e){return[...new Set(e.map(t=>t.includes(":")?t.split(":")[0]:t))]}function rf(e){const t={};return Object.keys(e).forEach(r=>{var i;r.includes(":")?t[r]=e[r]:(i=or(e[r].accounts))==null||i.forEach(s=>{t[s]={accounts:e[r].accounts.filter(n=>n.includes(`${s}:`)),methods:e[r].methods,events:e[r].events}})}),t}function sf(e,t){return ds(e,!1)&&e<=t.max&&e>=t.min}function Mo(){const e=Cr();return new Promise(t=>{switch(e){case ht.browser:t(nf());break;case ht.reactNative:t(of());break;case ht.node:t(af());break;default:t(!0)}})}function nf(){return Or()&&(navigator==null?void 0:navigator.onLine)}async function of(){var e;return li()&&typeof be<"u"&&be!=null&&be.NetInfo?(e=await(be==null?void 0:be.NetInfo.fetch()))==null?void 0:e.isConnected:!0}function af(){return!0}function cf(e){switch(Cr()){case ht.browser:uf(e);break;case ht.reactNative:lf(e);break}}function uf(e){Or()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)))}function lf(e){var t;li()&&typeof be<"u"&&be!=null&&be.NetInfo&&((t=be)==null||t.NetInfo.addEventListener(r=>e(r==null?void 0:r.isConnected)))}const ps={};let fi=class{static get(e){return ps[e]}static set(e,t){ps[e]=t}static delete(e){delete ps[e]}};const hf="PARSE_ERROR",df="INVALID_REQUEST",pf="METHOD_NOT_FOUND",ff="INVALID_PARAMS",ko="INTERNAL_ERROR",fs="SERVER_ERROR",gf=[-32700,-32600,-32601,-32602,-32603],Pr={[hf]:{code:-32700,message:"Parse error"},[df]:{code:-32600,message:"Invalid Request"},[pf]:{code:-32601,message:"Method not found"},[ff]:{code:-32602,message:"Invalid params"},[ko]:{code:-32603,message:"Internal error"},[fs]:{code:-32e3,message:"Server error"}},Fo=fs;function yf(e){return gf.includes(e)}function Ko(e){return Object.keys(Pr).includes(e)?Pr[e]:Pr[Fo]}function mf(e){return Object.values(Pr).find(r=>r.code===e)||Pr[Fo]}function wf(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}var zo={},gs=function(e,t){return gs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},gs(e,t)};function Df(e,t){gs(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ys=function(){return ys=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ys.apply(this,arguments)};function bf(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(r[i[s]]=e[i[s]]);return r}function vf(e,t,r,i){var s=arguments.length,n=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,r):i,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(e,t,r,i);else for(var u=e.length-1;u>=0;u--)(l=e[u])&&(n=(s<3?l(n):s>3?l(t,r,n):l(t,r))||n);return s>3&&n&&Object.defineProperty(t,r,n),n}function Ef(e,t){return function(r,i){t(r,i,e)}}function _f(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Sf(e,t,r,i){function s(n){return n instanceof r?n:new r(function(l){l(n)})}return new(r||(r=Promise))(function(n,l){function u(d){try{c(i.next(d))}catch(f){l(f)}}function h(d){try{c(i.throw(d))}catch(f){l(f)}}function c(d){d.done?n(d.value):s(d.value).then(u,h)}c((i=i.apply(e,t||[])).next())})}function If(e,t){var r={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,s,n,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(c){return function(d){return h([c,d])}}function h(c){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,s&&(n=c[0]&2?s.return:c[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,c[1])).done)return n;switch(s=0,n&&(c=[c[0]&2,n.value]),c[0]){case 0:case 1:n=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,s=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(n=r.trys,!(n=n.length>0&&n[n.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!n||c[1]>n[0]&&c[1]<n[3])){r.label=c[1];break}if(c[0]===6&&r.label<n[1]){r.label=n[1],n=c;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(c);break}n[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(d){c=[6,d],s=0}finally{i=n=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Of(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}function Cf(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function ms(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ho(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var i=r.call(e),s,n=[],l;try{for(;(t===void 0||t-- >0)&&!(s=i.next()).done;)n.push(s.value)}catch(u){l={error:u}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(l)throw l.error}}return n}function Nf(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ho(arguments[t]));return e}function Tf(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),s=0,t=0;t<r;t++)for(var n=arguments[t],l=0,u=n.length;l<u;l++,s++)i[s]=n[l];return i}function Rr(e){return this instanceof Rr?(this.v=e,this):new Rr(e)}function Af(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(e,t||[]),s,n=[];return s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s;function l(g){i[g]&&(s[g]=function(m){return new Promise(function(w,N){n.push([g,m,w,N])>1||u(g,m)})})}function u(g,m){try{h(i[g](m))}catch(w){f(n[0][3],w)}}function h(g){g.value instanceof Rr?Promise.resolve(g.value.v).then(c,d):f(n[0][2],g)}function c(g){u("next",g)}function d(g){u("throw",g)}function f(g,m){g(m),n.shift(),n.length&&u(n[0][0],n[0][1])}}function Pf(e){var t,r;return t={},i("next"),i("throw",function(s){throw s}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(s,n){t[s]=e[s]?function(l){return(r=!r)?{value:Rr(e[s](l)),done:s==="return"}:n?n(l):l}:n}}function Rf(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof ms=="function"?ms(e):e[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(n){r[n]=e[n]&&function(l){return new Promise(function(u,h){l=e[n](l),s(u,h,l.done,l.value)})}}function s(n,l,u,h){Promise.resolve(h).then(function(c){n({value:c,done:u})},l)}}function xf(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Uf(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Lf(e){return e&&e.__esModule?e:{default:e}}function jf(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Mf(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}const kf=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return ys},__asyncDelegator:Pf,__asyncGenerator:Af,__asyncValues:Rf,__await:Rr,__awaiter:Sf,__classPrivateFieldGet:jf,__classPrivateFieldSet:Mf,__createBinding:Of,__decorate:vf,__exportStar:Cf,__extends:Df,__generator:If,__importDefault:Lf,__importStar:Uf,__makeTemplateObject:xf,__metadata:_f,__param:Ef,__read:Ho,__rest:bf,__spread:Nf,__spreadArrays:Tf,__values:ms},Symbol.toStringTag,{value:"Module"})),Ff=Ei(kf);var Et={},Vo;function Kf(){if(Vo)return Et;Vo=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.isBrowserCryptoAvailable=Et.getSubtleCrypto=Et.getBrowerCrypto=void 0;function e(){return(ur===null||ur===void 0?void 0:ur.crypto)||(ur===null||ur===void 0?void 0:ur.msCrypto)||{}}Et.getBrowerCrypto=e;function t(){const i=e();return i.subtle||i.webkitSubtle}Et.getSubtleCrypto=t;function r(){return!!e()&&!!t()}return Et.isBrowserCryptoAvailable=r,Et}var _t={},qo;function zf(){if(qo)return _t;qo=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.isBrowser=_t.isNode=_t.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}_t.isReactNative=e;function t(){return typeof Lt<"u"&&typeof Lt.versions<"u"&&typeof Lt.versions.node<"u"}_t.isNode=t;function r(){return!e()&&!t()}return _t.isBrowser=r,_t}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Ff;t.__exportStar(Kf(),e),t.__exportStar(zf(),e)})(zo);function ws(e=3){const t=Date.now()*Math.pow(10,e),r=Math.floor(Math.random()*Math.pow(10,e));return t+r}function $o(e=6){return BigInt(ws(e))}function xr(e,t,r){return{id:r||ws(),jsonrpc:"2.0",method:e,params:t}}function Ds(e,t){return{id:e,jsonrpc:"2.0",result:t}}function bs(e,t,r){return{id:e,jsonrpc:"2.0",error:Hf(t,r)}}function Hf(e,t){return typeof e>"u"?Ko(ko):(typeof e=="string"&&(e=Object.assign(Object.assign({},Ko(fs)),{message:e})),typeof t<"u"&&(e.data=t),yf(e.code)&&(e=mf(e.code)),e)}class Vf{}class qf extends Vf{constructor(){super()}}class $f extends qf{constructor(t){super()}}const Bf="^wss?:";function Wf(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Gf(e,t){const r=Wf(e);return typeof r>"u"?!1:new RegExp(t).test(r)}function Bo(e){return Gf(e,Bf)}function Yf(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function Wo(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function vs(e){return Wo(e)&&"method"in e}function gi(e){return Wo(e)&&(St(e)||mt(e))}function St(e){return"result"in e}function mt(e){return"error"in e}class Qf extends $f{constructor(t){super(t),this.events=new Ct.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(xr(t.method,t.params||[],t.id||$o().toString()),r)}async requestStrict(t,r){return new Promise(async(i,s)=>{if(!this.connection.connected)try{await this.open()}catch(n){s(n)}this.events.on(`${t.id}`,n=>{mt(n)?s(n.error):i(n.result)});try{await this.connection.send(t,r)}catch(n){s(n)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),gi(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Jf=()=>typeof WebSocket<"u"?WebSocket:typeof be<"u"&&typeof be.WebSocket<"u"?be.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Xf=()=>typeof WebSocket<"u"||typeof be<"u"&&typeof be.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Go=e=>e.split("?")[0],Yo=10,Zf=Jf();class eg{constructor(t){if(this.url=t,this.events=new Ct.EventEmitter,this.registering=!1,!Bo(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(dr(t))}catch(i){this.onError(t.id,i)}}register(t=this.url){if(!Bo(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,s)=>{this.events.once("register_error",n=>{this.resetMaxListeners(),s(n)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,i)=>{const s=zo.isReactNative()?void 0:{rejectUnauthorized:!Yf(t)},n=new Zf(t,[],s);Xf()?n.onerror=l=>{const u=l;i(this.emitError(u.error))}:n.on("error",l=>{i(this.emitError(l))}),n.onopen=()=>{this.onOpen(n),r(n)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?Gr(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const i=this.parseError(r),s=i.message||i.toString(),n=bs(t,s);this.events.emit("payload",n)}parseError(t,r=this.url){return wf(t,Go(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Yo&&this.events.setMaxListeners(Yo)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Go(this.url)}`));return this.events.emit("register_error",r),r}}var tg={};function rg(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),l=n.charCodeAt(0);if(r[l]!==255)throw new TypeError(n+" is ambiguous");r[l]=s}var u=e.length,h=e.charAt(0),c=Math.log(u)/Math.log(256),d=Math.log(256)/Math.log(u);function f(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var N=0,R=0,U=0,E=w.length;U!==E&&w[U]===0;)U++,N++;for(var S=(E-U)*d+1>>>0,y=new Uint8Array(S);U!==E;){for(var v=w[U],b=0,o=S-1;(v!==0||b<R)&&o!==-1;o--,b++)v+=256*y[o]>>>0,y[o]=v%u>>>0,v=v/u>>>0;if(v!==0)throw new Error("Non-zero carry");R=b,U++}for(var p=S-R;p!==S&&y[p]===0;)p++;for(var A=h.repeat(N);p<S;++p)A+=e.charAt(y[p]);return A}function g(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var N=0;if(w[N]!==" "){for(var R=0,U=0;w[N]===h;)R++,N++;for(var E=(w.length-N)*c+1>>>0,S=new Uint8Array(E);w[N];){var y=r[w.charCodeAt(N)];if(y===255)return;for(var v=0,b=E-1;(y!==0||v<U)&&b!==-1;b--,v++)y+=u*S[b]>>>0,S[b]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");U=v,N++}if(w[N]!==" "){for(var o=E-U;o!==E&&S[o]===0;)o++;for(var p=new Uint8Array(R+(E-o)),A=R;o!==E;)p[A++]=S[o++];return p}}}function m(w){var N=g(w);if(N)return N;throw new Error(`Non-${t} character`)}return{encode:f,decodeUnsafe:g,decode:m}}var ig=rg,sg=ig;const Qo=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},ng=e=>new TextEncoder().encode(e),og=e=>new TextDecoder().decode(e);class ag{constructor(t,r,i){this.name=t,this.prefix=r,this.baseEncode=i}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class cg{constructor(t,r,i){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Jo(this,t)}}class ug{constructor(t){this.decoders=t}or(t){return Jo(this,t)}decode(t){const r=t[0],i=this.decoders[r];if(i)return i.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Jo=(e,t)=>new ug({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class lg{constructor(t,r,i,s){this.name=t,this.prefix=r,this.baseEncode=i,this.baseDecode=s,this.encoder=new ag(t,r,i),this.decoder=new cg(t,r,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const yi=({name:e,prefix:t,encode:r,decode:i})=>new lg(e,t,r,i),Ur=({prefix:e,name:t,alphabet:r})=>{const{encode:i,decode:s}=sg(r,t);return yi({prefix:e,name:t,encode:i,decode:n=>Qo(s(n))})},hg=(e,t,r,i)=>{const s={};for(let d=0;d<t.length;++d)s[t[d]]=d;let n=e.length;for(;e[n-1]==="=";)--n;const l=new Uint8Array(n*r/8|0);let u=0,h=0,c=0;for(let d=0;d<n;++d){const f=s[e[d]];if(f===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|f,u+=r,u>=8&&(u-=8,l[c++]=255&h>>u)}if(u>=r||255&h<<8-u)throw new SyntaxError("Unexpected end of data");return l},dg=(e,t,r)=>{const i=t[t.length-1]==="=",s=(1<<r)-1;let n="",l=0,u=0;for(let h=0;h<e.length;++h)for(u=u<<8|e[h],l+=8;l>r;)l-=r,n+=t[s&u>>l];if(l&&(n+=t[s&u<<r-l]),i)for(;n.length*r&7;)n+="=";return n},xe=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>yi({prefix:t,name:e,encode(s){return dg(s,i,r)},decode(s){return hg(s,i,r,e)}}),pg=yi({prefix:"\0",name:"identity",encode:e=>og(e),decode:e=>ng(e)});var fg=Object.freeze({__proto__:null,identity:pg});const gg=xe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var yg=Object.freeze({__proto__:null,base2:gg});const mg=xe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var wg=Object.freeze({__proto__:null,base8:mg});const Dg=Ur({prefix:"9",name:"base10",alphabet:"0123456789"});var bg=Object.freeze({__proto__:null,base10:Dg});const vg=xe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Eg=xe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var _g=Object.freeze({__proto__:null,base16:vg,base16upper:Eg});const Sg=xe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ig=xe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Og=xe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Cg=xe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ng=xe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Tg=xe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ag=xe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Pg=xe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Rg=xe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var xg=Object.freeze({__proto__:null,base32:Sg,base32upper:Ig,base32pad:Og,base32padupper:Cg,base32hex:Ng,base32hexupper:Tg,base32hexpad:Ag,base32hexpadupper:Pg,base32z:Rg});const Ug=Ur({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Lg=Ur({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var jg=Object.freeze({__proto__:null,base36:Ug,base36upper:Lg});const Mg=Ur({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),kg=Ur({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Fg=Object.freeze({__proto__:null,base58btc:Mg,base58flickr:kg});const Kg=xe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zg=xe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Hg=xe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Vg=xe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var qg=Object.freeze({__proto__:null,base64:Kg,base64pad:zg,base64url:Hg,base64urlpad:Vg});const Xo=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),$g=Xo.reduce((e,t,r)=>(e[r]=t,e),[]),Bg=Xo.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function Wg(e){return e.reduce((t,r)=>(t+=$g[r],t),"")}function Gg(e){const t=[];for(const r of e){const i=Bg[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(i)}return new Uint8Array(t)}const Yg=yi({prefix:"\u{1F680}",name:"base256emoji",encode:Wg,decode:Gg});var Qg=Object.freeze({__proto__:null,base256emoji:Yg}),Jg=ea,Zo=128,Xg=127,Zg=~Xg,ey=Math.pow(2,31);function ea(e,t,r){t=t||[],r=r||0;for(var i=r;e>=ey;)t[r++]=e&255|Zo,e/=128;for(;e&Zg;)t[r++]=e&255|Zo,e>>>=7;return t[r]=e|0,ea.bytes=r-i+1,t}var ty=Es,ry=128,ta=127;function Es(e,i){var r=0,i=i||0,s=0,n=i,l,u=e.length;do{if(n>=u)throw Es.bytes=0,new RangeError("Could not decode varint");l=e[n++],r+=s<28?(l&ta)<<s:(l&ta)*Math.pow(2,s),s+=7}while(l>=ry);return Es.bytes=n-i,r}var iy=Math.pow(2,7),sy=Math.pow(2,14),ny=Math.pow(2,21),oy=Math.pow(2,28),ay=Math.pow(2,35),cy=Math.pow(2,42),uy=Math.pow(2,49),ly=Math.pow(2,56),hy=Math.pow(2,63),dy=function(e){return e<iy?1:e<sy?2:e<ny?3:e<oy?4:e<ay?5:e<cy?6:e<uy?7:e<ly?8:e<hy?9:10},py={encode:Jg,decode:ty,encodingLength:dy},ra=py;const ia=(e,t,r=0)=>(ra.encode(e,t,r),t),sa=e=>ra.encodingLength(e),_s=(e,t)=>{const r=t.byteLength,i=sa(e),s=i+sa(r),n=new Uint8Array(s+r);return ia(e,n,0),ia(r,n,i),n.set(t,s),new fy(e,r,t,n)};class fy{constructor(t,r,i,s){this.code=t,this.size=r,this.digest=i,this.bytes=s}}const na=({name:e,code:t,encode:r})=>new gy(e,t,r);class gy{constructor(t,r,i){this.name=t,this.code=r,this.encode=i}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?_s(this.code,r):r.then(i=>_s(this.code,i))}else throw Error("Unknown type, must be binary type")}}const oa=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),yy=na({name:"sha2-256",code:18,encode:oa("SHA-256")}),my=na({name:"sha2-512",code:19,encode:oa("SHA-512")});var wy=Object.freeze({__proto__:null,sha256:yy,sha512:my});const aa=0,Dy="identity",ca=Qo;var by=Object.freeze({__proto__:null,identity:{code:aa,name:Dy,encode:ca,digest:e=>_s(aa,ca(e))}});new TextEncoder,new TextDecoder;const ua={...fg,...yg,...wg,...bg,..._g,...xg,...jg,...Fg,...qg,...Qg};({...wy,...by});function la(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function vy(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?la(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function ha(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}const da=ha("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Ss=ha("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=vy(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Ey={utf8:da,"utf-8":da,hex:ua.base16,latin1:Ss,ascii:Ss,binary:Ss,...ua};function _y(e,t="utf8"){const r=Ey[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?la(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}const pa="wc",Sy=2,Is="core",xt=`${pa}@2:${Is}:`,Iy={name:Is,logger:"error"},Oy={database:":memory:"},Cy="crypto",fa="client_ed25519_seed",Ny=$.ONE_DAY,Ty="keychain",Ay="0.3",Py="messages",Ry="0.3",xy=$.SIX_HOURS,Uy="publisher",ga="irn",Ly="error",ya="wss://relay.walletconnect.com",ma="wss://relay.walletconnect.org",jy="relayer",Le={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},My="_subscription",It={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ky=$.ONE_SECOND,Fy="2.10.0",Ky=1e4,zy="0.3",Hy="WALLETCONNECT_CLIENT_ID",bt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Vy="subscription",qy="0.3",$y=$.FIVE_SECONDS*1e3,By="pairing",Wy="0.3",Lr={wc_pairingDelete:{req:{ttl:$.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:$.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:$.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:$.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:$.ONE_DAY,prompt:!1,tag:0},res:{ttl:$.ONE_DAY,prompt:!1,tag:0}}},vt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Gy="history",Yy="0.3",Qy="expirer",pt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Jy="0.3",Os="verify-api",mi="https://verify.walletconnect.com",wa="https://verify.walletconnect.org";class Xy{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=Ty,this.version=Ay,this.initialized=!1,this.storagePrefix=xt,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,s)=>{this.isInitialized(),this.keychain.set(i,s),await this.persist()},this.get=i=>{this.isInitialized();const s=this.keychain.get(i);if(typeof s>"u"){const{message:n}=z("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return s},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=t,this.logger=ut(r,this.name)}get context(){return nt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Io(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Oo(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Zy{constructor(t,r,i){this.core=t,this.logger=r,this.name=Cy,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),n=Qn(s);return Yn(n.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=Jd();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const n=await this.getClientSeed(),l=Qn(n),u=us();return await nd(u,s,Ny,l)},this.generateSharedKey=(s,n,l)=>{this.isInitialized();const u=this.getPrivateKey(s),h=Xd(u,n);return this.setSymKey(h,l)},this.setSymKey=async(s,n)=>{this.isInitialized();const l=n||Zd(s);return await this.keychain.set(l,s),l},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,n,l)=>{this.isInitialized();const u=bo(l),h=dr(n);if(vo(u)){const g=u.senderPublicKey,m=u.receiverPublicKey;s=await this.generateSharedKey(g,m)}const c=this.getSymKey(s),{type:d,senderPublicKey:f}=u;return tp({type:d,symKey:c,message:h,senderPublicKey:f})},this.decode=async(s,n,l)=>{this.isInitialized();const u=sp(n,l);if(vo(u)){const h=u.receiverPublicKey,c=u.senderPublicKey;s=await this.generateSharedKey(h,c)}try{const h=this.getSymKey(s),c=rp({symKey:h,encoded:n});return Gr(c)}catch(h){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(h)}},this.getPayloadType=s=>{const n=ui(s);return Ir(n.type)},this.getPayloadSenderPublicKey=s=>{const n=ui(s);return n.senderPublicKey?et(n.senderPublicKey,tt):void 0},this.core=t,this.logger=ut(r,this.name),this.keychain=i||new Xy(this.core,this.logger)}get context(){return nt(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(fa)}catch{t=us(),await this.keychain.set(fa,t)}return _y(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class em extends fl{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=Py,this.version=Ry,this.initialized=!1,this.storagePrefix=xt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,s)=>{this.isInitialized();const n=sr(s);let l=this.messages.get(i);return typeof l>"u"&&(l={}),typeof l[n]<"u"||(l[n]=s,this.messages.set(i,l),await this.persist()),n},this.get=i=>{this.isInitialized();let s=this.messages.get(i);return typeof s>"u"&&(s={}),s},this.has=(i,s)=>{this.isInitialized();const n=this.get(i),l=sr(s);return typeof n[l]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=ut(t,this.name),this.core=r}get context(){return nt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Io(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Oo(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class tm extends gl{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Ct.EventEmitter,this.name=Uy,this.queue=new Map,this.publishTimeout=$.toMiliseconds($.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(i,s,n)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:s,opts:n}});try{const u=(n==null?void 0:n.ttl)||xy,h=hs(n),c=(n==null?void 0:n.prompt)||!1,d=(n==null?void 0:n.tag)||0,f=(n==null?void 0:n.id)||$o().toString(),g={topic:i,message:s,opts:{ttl:u,relay:h,prompt:c,tag:d,id:f}},m=setTimeout(()=>this.queue.set(f,g),this.publishTimeout);try{await await Nr(this.rpcPublish(i,s,u,h,c,d,f),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(f),this.relayer.events.emit(Le.publish,g)}catch(w){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=n==null?void 0:n.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(f),w;return}finally{clearTimeout(m)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:s,opts:n}})}catch(u){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(u),u}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.relayer=t,this.logger=ut(r,this.name),this.registerEventListeners()}get context(){return nt(this.logger)}rpcPublish(t,r,i,s,n,l,u){var h,c,d,f;const g={method:hi(s.protocol).publish,params:{topic:t,message:r,ttl:i,prompt:n,tag:l},id:u};return rt((h=g.params)==null?void 0:h.prompt)&&((c=g.params)==null||delete c.prompt),rt((d=g.params)==null?void 0:d.tag)&&((f=g.params)==null||delete f.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:g}),this.relayer.request(g)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:i,opts:s}=t;await this.publish(r,i,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(Jt.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Le.connection_stalled);return}this.checkQueue()}),this.relayer.on(Le.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class rm{constructor(){this.map=new Map,this.set=(t,r)=>{const i=this.get(t);this.exists(t,r)||this.map.set(t,[...i,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const i=this.get(t);if(!this.exists(t,r))return;const s=i.filter(n=>n!==r);if(!s.length){this.map.delete(t);return}this.map.set(t,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var im=Object.defineProperty,sm=Object.defineProperties,nm=Object.getOwnPropertyDescriptors,Da=Object.getOwnPropertySymbols,om=Object.prototype.hasOwnProperty,am=Object.prototype.propertyIsEnumerable,ba=(e,t,r)=>t in e?im(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,jr=(e,t)=>{for(var r in t||(t={}))om.call(t,r)&&ba(e,r,t[r]);if(Da)for(var r of Da(t))am.call(t,r)&&ba(e,r,t[r]);return e},Cs=(e,t)=>sm(e,nm(t));class cm extends wl{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new rm,this.events=new Ct.EventEmitter,this.name=Vy,this.version=qy,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=xt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,s)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}});try{const n=hs(s),l={topic:i,relay:n};this.pending.set(i,l);const u=await this.rpcSubscribe(i,n);return this.onSubscribe(u,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}}),u}catch(n){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(n),n}},this.unsubscribe=async(i,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(i,s.id,s):await this.unsubscribeByTopic(i,s)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((s,n)=>{const l=new $.Watch;l.start(this.pendingSubscriptionWatchLabel);const u=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(u),l.stop(this.pendingSubscriptionWatchLabel),s(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=$y&&(clearInterval(u),l.stop(this.pendingSubscriptionWatchLabel),n(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=ut(r,this.name),this.clientId=""}get context(){return nt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let i=!1;try{i=this.getSubscription(t).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const i=this.topicMap.get(t);await Promise.all(i.map(async s=>await this.unsubscribeById(t,s,r)))}async unsubscribeById(t,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:i}});try{const s=hs(i);await this.rpcUnsubscribe(t,r,s);const n=Ce("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,n),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:i}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(t,r){const i={method:hi(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await Nr(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Le.connection_stalled)}return sr(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,i={method:hi(r.protocol).batchSubscribe,params:{topics:t.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await Nr(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Le.connection_stalled)}}rpcUnsubscribe(t,r,i){const s={method:hi(i.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(t,r){this.setSubscription(t,Cs(jr({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,jr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,i),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,jr({},r)),this.topicMap.set(r.topic,t),this.events.emit(bt.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:i}=z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(i)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const i=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(i.topic,t),this.events.emit(bt.deleted,Cs(jr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(bt.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(bt.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);Tr(r)&&this.onBatchSubscribe(r.map((i,s)=>Cs(jr({},t[s]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Jt.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Le.connect,async()=>{await this.onConnect()}),this.relayer.on(Le.disconnect,()=>{this.onDisconnect()}),this.events.on(bt.created,async t=>{const r=bt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(bt.deleted,async t=>{const r=bt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=z("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var um=Object.defineProperty,va=Object.getOwnPropertySymbols,lm=Object.prototype.hasOwnProperty,hm=Object.prototype.propertyIsEnumerable,Ea=(e,t,r)=>t in e?um(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,dm=(e,t)=>{for(var r in t||(t={}))lm.call(t,r)&&Ea(e,r,t[r]);if(va)for(var r of va(t))hm.call(t,r)&&Ea(e,r,t[r]);return e};class pm extends yl{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Ct.EventEmitter,this.name=jy,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Le.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Le.error,r)},this.registerProviderListeners=()=>{this.provider.on(It.payload,this.onPayloadHandler),this.provider.on(It.connect,this.onConnectHandler),this.provider.on(It.disconnect,this.onDisconnectHandler),this.provider.on(It.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?ut(t.logger,this.name):Hi(Vi({level:t.logger||Ly})),this.messages=new em(this.logger,t.core),this.subscriber=new cm(this,this.logger),this.publisher=new tm(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||ya,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${ma}...`),await this.restartTransport(ma)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},Ky)}get context(){return nt(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,i){this.isInitialized(),await this.publisher.publish(t,r,i),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var i;this.isInitialized();let s=((i=this.subscriber.topicMap.get(t))==null?void 0:i[0])||"";return s||(await Promise.all([new Promise(n=>{this.subscriber.once(bt.created,l=>{l.topic===t&&n()})}),new Promise(async n=>{s=await this.subscriber.subscribe(t,r),n()})]),s)}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Nr(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(bt.resubscribed,()=>{r()})}),new Promise(async(r,i)=>{try{await Nr(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(s){i(s);return}r()})])}catch(r){this.logger.error(r);const i=r;if(!this.isConnectionStalled(i.message))throw r;this.provider.events.emit(It.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Mo())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Qf(new eg(gp({sdkVersion:Fy,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:i}=t;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(t){const{topic:r,message:i}=t;if(!i||i.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const s=this.messages.has(r,i);return s&&this.logger.debug(`Ignoring duplicate message: ${i}`),s}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),vs(t)){if(!t.method.endsWith(My))return;const r=t.params,{topic:i,message:s,publishedAt:n}=r.data,l={topic:i,message:s,publishedAt:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(dm({type:"event",event:r.id},l)),this.events.emit(r.id,l),await this.acknowledgePayload(t),await this.onMessageEvent(l)}else gi(t)&&this.events.emit(Le.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Le.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Ds(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(It.payload,this.onPayloadHandler),this.provider.off(It.connect,this.onConnectHandler),this.provider.off(It.disconnect,this.onDisconnectHandler),this.provider.off(It.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Le.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Mo();cf(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(i=>this.logger.error(i))))})}onProviderDisconnect(){this.events.emit(Le.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},$.toMiliseconds(ky)))}isInitialized(){if(!this.initialized){const{message:t}=z("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var fm=Object.defineProperty,_a=Object.getOwnPropertySymbols,gm=Object.prototype.hasOwnProperty,ym=Object.prototype.propertyIsEnumerable,Sa=(e,t,r)=>t in e?fm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ia=(e,t)=>{for(var r in t||(t={}))gm.call(t,r)&&Sa(e,r,t[r]);if(_a)for(var r of _a(t))ym.call(t,r)&&Sa(e,r,t[r]);return e};class wi extends ml{constructor(t,r,i,s=xt,n=void 0){super(t,r,i,s),this.core=t,this.logger=r,this.name=i,this.map=new Map,this.version=zy,this.cached=[],this.initialized=!1,this.storagePrefix=xt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!rt(l)?this.map.set(this.getKey(l),l):kp(l)?this.map.set(l.id,l):Fp(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,u)=>{this.isInitialized(),this.map.has(l)?await this.update(l,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:u}),this.map.set(l,u),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(u=>Object.keys(l).every(h=>e0(u[h],l[h]))):this.values),this.update=async(l,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:u});const h=Ia(Ia({},this.getData(l)),u);this.map.set(l,h),await this.persist()},this.delete=async(l,u)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:u}),this.map.delete(l),await this.persist())},this.logger=ut(r,this.name),this.storagePrefix=s,this.getKey=n}get context(){return nt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:i}=z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class mm{constructor(t,r){this.core=t,this.logger=r,this.name=By,this.version=Wy,this.events=new Ka,this.initialized=!1,this.storagePrefix=xt,this.ignoredPayloadTypes=[$t],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=us(),s=await this.core.crypto.setSymKey(i),n=yt($.FIVE_MINUTES),l={protocol:ga},u={topic:s,expiry:n,relay:l,active:!1},h=Np({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:l});return await this.pairings.set(s,u),await this.core.relayer.subscribe(s),this.core.expirer.set(s,n),{topic:s,uri:h}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:s,symKey:n,relay:l}=Ip(i.uri);if(this.pairings.keys.includes(s))throw new Error(`Pairing already exists: ${s}`);if(this.core.crypto.hasKeys(s))throw new Error(`Keychain already exists: ${s}`);const u=yt($.FIVE_MINUTES),h={topic:s,relay:l,expiry:u,active:!1};return await this.pairings.set(s,h),await this.core.crypto.setSymKey(n,s),await this.core.relayer.subscribe(s,{relay:l}),this.core.expirer.set(s,u),i.activatePairing&&await this.activate({topic:s}),h},this.activate=async({topic:i})=>{this.isInitialized();const s=yt($.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:s}),this.core.expirer.set(i,s)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:s}=i;if(this.pairings.keys.includes(s)){const n=await this.sendRequest(s,"wc_pairingPing",{}),{done:l,resolve:u,reject:h}=nr();this.events.once(Ee("pairing_ping",n),({error:c})=>{c?h(c):u()}),await l()}},this.updateExpiry=async({topic:i,expiry:s})=>{this.isInitialized(),await this.pairings.update(i,{expiry:s})},this.updateMetadata=async({topic:i,metadata:s})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:s}=i;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Ce("USER_DISCONNECTED")),await this.deletePairing(s))},this.sendRequest=async(i,s,n)=>{const l=xr(s,n),u=await this.core.crypto.encode(i,l),h=Lr[s].req;return this.core.history.set(i,l),this.core.relayer.publish(i,u,h),l.id},this.sendResult=async(i,s,n)=>{const l=Ds(i,n),u=await this.core.crypto.encode(s,l),h=await this.core.history.get(s,i),c=Lr[h.request.method].res;await this.core.relayer.publish(s,u,c),await this.core.history.resolve(l)},this.sendError=async(i,s,n)=>{const l=bs(i,n),u=await this.core.crypto.encode(s,l),h=await this.core.history.get(s,i),c=Lr[h.request.method]?Lr[h.request.method].res:Lr.unregistered_method.res;await this.core.relayer.publish(s,u,c),await this.core.history.resolve(l)},this.deletePairing=async(i,s)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Ce("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),s?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(s=>Rt(s.expiry));await Promise.all(i.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=i=>{const{topic:s,payload:n}=i;switch(n.method){case"wc_pairingPing":return this.onPairingPingRequest(s,n);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,n);default:return this.onUnknownRpcMethodRequest(s,n)}},this.onRelayEventResponse=async i=>{const{topic:s,payload:n}=i,l=(await this.core.history.get(s,n.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(s,n);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(i,s)=>{const{id:n}=s;try{this.isValidPing({topic:i}),await this.sendResult(n,i,!0),this.events.emit("pairing_ping",{id:n,topic:i})}catch(l){await this.sendError(n,i,l),this.logger.error(l)}},this.onPairingPingResponse=(i,s)=>{const{id:n}=s;setTimeout(()=>{St(s)?this.events.emit(Ee("pairing_ping",n),{}):mt(s)&&this.events.emit(Ee("pairing_ping",n),{error:s.error})},500)},this.onPairingDeleteRequest=async(i,s)=>{const{id:n}=s;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit("pairing_delete",{id:n,topic:i})}catch(l){await this.sendError(n,i,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(i,s)=>{const{id:n,method:l}=s;try{if(this.registeredMethods.includes(l))return;const u=Ce("WC_METHOD_UNSUPPORTED",l);await this.sendError(n,i,u),this.logger.error(u)}catch(u){await this.sendError(n,i,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Ce("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!at(i)){const{message:s}=z("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(s)}if(!Mp(i.uri)){const{message:s}=z("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(s)}},this.isValidPing=async i=>{if(!at(i)){const{message:n}=z("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(n)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidDisconnect=async i=>{if(!at(i)){const{message:n}=z("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(n)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async i=>{if(!Ne(i,!1)){const{message:s}=z("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(s)}if(!this.pairings.keys.includes(i)){const{message:s}=z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(s)}if(Rt(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:s}=z("EXPIRED",`pairing topic: ${i}`);throw new Error(s)}},this.core=t,this.logger=ut(r,this.name),this.pairings=new wi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return nt(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=z("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Le.message,async t=>{const{topic:r,message:i}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const s=await this.core.crypto.decode(r,i);try{vs(s)?(this.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):gi(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id))}catch(n){this.logger.error(n)}})}registerExpirerEvents(){this.core.expirer.on(pt.expired,async t=>{const{topic:r}=No(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class wm extends pl{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Ct.EventEmitter,this.name=Gy,this.version=Yy,this.cached=[],this.initialized=!1,this.storagePrefix=xt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,s,n)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:s,chainId:n}),this.records.has(s.id))return;const l={id:s.id,topic:i,request:{method:s.method,params:s.params||null},chainId:n,expiry:yt($.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(vt.created,l)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const s=await this.getRecord(i.id);typeof s.response>"u"&&(s.response=mt(i)?{error:i.error}:{result:i.result},this.records.set(s.id,s),this.events.emit(vt.updated,s))},this.get=async(i,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:s}),await this.getRecord(s)),this.delete=(i,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(n=>{if(n.topic===i){if(typeof s<"u"&&n.id!==s)return;this.records.delete(n.id),this.events.emit(vt.deleted,n)}})},this.exists=async(i,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===i:!1),this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=ut(r,this.name)}get context(){return nt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:xr(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(i)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:i}=z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(vt.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(vt.created,t=>{const r=vt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(vt.updated,t=>{const r=vt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(vt.deleted,t=>{const r=vt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Jt.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{$.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Dm extends Dl{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Ct.EventEmitter,this.name=Qy,this.version=Jy,this.cached=[],this.initialized=!1,this.storagePrefix=xt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const s=this.formatTarget(i);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(i,s)=>{this.isInitialized();const n=this.formatTarget(i),l={target:n,expiry:s};this.expirations.set(n,l),this.checkExpiry(n,l),this.events.emit(pt.created,{target:n,expiration:l})},this.get=i=>{this.isInitialized();const s=this.formatTarget(i);return this.getExpiration(s)},this.del=i=>{if(this.isInitialized(),this.has(i)){const s=this.formatTarget(i),n=this.getExpiration(s);this.expirations.delete(s),this.events.emit(pt.deleted,{target:s,expiration:n})}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=ut(r,this.name)}get context(){return nt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return yp(t);if(typeof t=="number")return mp(t);const{message:r}=z("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(pt.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:i}=z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(t,r){const{expiry:i}=r;$.toMiliseconds(i)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(pt.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Jt.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(pt.created,t=>{const r=pt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(pt.expired,t=>{const r=pt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(pt.deleted,t=>{const r=pt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class bm extends bl{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Os,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async i=>{if(this.verifyDisabled||li()||!Or())return;const s=(i==null?void 0:i.verifyUrl)||mi;this.verifyUrl!==s&&this.removeIframe(),this.verifyUrl=s;try{await this.createIframe()}catch(n){this.logger.warn(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.warn(n)}if(!this.initialized){this.removeIframe(),this.verifyUrl=wa;try{await this.createIframe()}catch(n){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(n),this.verifyDisabled=!0}}},this.register=async i=>{this.initialized?this.sendPost(i.attestationId):(this.addToQueue(i.attestationId),await this.init())},this.resolve=async i=>{if(this.isDevEnv)return"";const s=(i==null?void 0:i.verifyUrl)||mi;let n="";try{n=await this.fetchAttestation(i.attestationId,s)}catch(l){this.logger.warn(`failed to resolve attestation: ${i.attestationId} from url: ${s}`),this.logger.warn(l),n=await this.fetchAttestation(i.attestationId,wa)}return n},this.fetchAttestation=async(i,s)=>{var n;this.logger.info(`resolving attestation: ${i} from url: ${s}`);const l=this.startAbortTimer($.ONE_SECOND*2),u=await fetch(`${s}/attestation/${i}`,{signal:this.abortController.signal});return clearTimeout(l),u.status===200?(n=await u.json())==null?void 0:n.origin:""},this.addToQueue=i=>{this.queue.push(i)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(i=>this.sendPost(i)),this.queue=[])},this.sendPost=i=>{var s;try{if(!this.iframe)return;(s=this.iframe.contentWindow)==null||s.postMessage(i,"*"),this.logger.info(`postMessage sent: ${i} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let i;const s=n=>{n.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",s),i())};await Promise.race([new Promise(n=>{if(document.getElementById(Os))return n();window.addEventListener("message",s);const l=document.createElement("iframe");l.id=Os,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,i=n}),new Promise((n,l)=>setTimeout(()=>{window.removeEventListener("message",s),l("verify iframe load timeout")},$.toMiliseconds($.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=ut(r,this.name),this.verifyUrl=mi,this.abortController=new AbortController,this.isDevEnv=ls()&&tg.IS_VITEST}get context(){return nt(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),$.toMiliseconds(t))}}var vm=Object.defineProperty,Oa=Object.getOwnPropertySymbols,Em=Object.prototype.hasOwnProperty,_m=Object.prototype.propertyIsEnumerable,Ca=(e,t,r)=>t in e?vm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Na=(e,t)=>{for(var r in t||(t={}))Em.call(t,r)&&Ca(e,r,t[r]);if(Oa)for(var r of Oa(t))_m.call(t,r)&&Ca(e,r,t[r]);return e};class Ns extends dl{constructor(t){super(t),this.protocol=pa,this.version=Sy,this.name=Is,this.events=new Ct.EventEmitter,this.initialized=!1,this.on=(i,s)=>this.events.on(i,s),this.once=(i,s)=>this.events.once(i,s),this.off=(i,s)=>this.events.off(i,s),this.removeListener=(i,s)=>this.events.removeListener(i,s),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||ya;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Hi(Vi({level:(t==null?void 0:t.logger)||Iy.logger}));this.logger=ut(r,this.name),this.heartbeat=new Jt.HeartBeat,this.crypto=new Zy(this,this.logger,t==null?void 0:t.keychain),this.history=new wm(this,this.logger),this.expirer=new Dm(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new zc(Na(Na({},Oy),t==null?void 0:t.storageOptions)),this.relayer=new pm({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new mm(this,this.logger),this.verify=new bm(this.projectId||"",this.logger)}static async init(t){const r=new Ns(t);await r.initialize();const i=await r.crypto.getClientId();return await r.storage.setItem(Hy,i),r}get context(){return nt(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const Sm=Ns,Ta="wc",Aa=2,Pa="client",Ts=`${Ta}@${Aa}:${Pa}:`,As={name:Pa,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Ra="WALLETCONNECT_DEEPLINK_CHOICE",Im="proposal",Om="Proposal expired",Cm="session",Di=$.SEVEN_DAYS,Nm="engine",Mr={wc_sessionPropose:{req:{ttl:$.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:$.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:$.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:$.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:$.ONE_DAY,prompt:!1,tag:1104},res:{ttl:$.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:$.ONE_DAY,prompt:!1,tag:1106},res:{ttl:$.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:$.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:$.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:$.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:$.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:$.ONE_DAY,prompt:!1,tag:1112},res:{ttl:$.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:$.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:$.THIRTY_SECONDS,prompt:!1,tag:1115}}},Ps={min:$.FIVE_MINUTES,max:$.SEVEN_DAYS},Ot={idle:"IDLE",active:"ACTIVE"},Tm="request",Am=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Pm=Object.defineProperty,Rm=Object.defineProperties,xm=Object.getOwnPropertyDescriptors,xa=Object.getOwnPropertySymbols,Um=Object.prototype.hasOwnProperty,Lm=Object.prototype.propertyIsEnumerable,Ua=(e,t,r)=>t in e?Pm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ct=(e,t)=>{for(var r in t||(t={}))Um.call(t,r)&&Ua(e,r,t[r]);if(xa)for(var r of xa(t))Lm.call(t,r)&&Ua(e,r,t[r]);return e},kr=(e,t)=>Rm(e,xm(t));class jm extends El{constructor(t){super(t),this.name=Nm,this.events=new Ka,this.initialized=!1,this.ignoredPayloadTypes=[$t],this.requestQueue={state:Ot.idle,queue:[]},this.sessionRequestQueue={state:Ot.idle,queue:[]},this.requestQueueDelay=$.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Mr)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},$.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const i=kr(ct({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:s,requiredNamespaces:n,optionalNamespaces:l,sessionProperties:u,relays:h}=i;let c=s,d,f=!1;if(c&&(f=this.client.core.pairing.pairings.get(c).active),!c||!f){const{topic:S,uri:y}=await this.client.core.pairing.create();c=S,d=y}const g=await this.client.core.crypto.generateKeyPair(),m=ct({requiredNamespaces:n,optionalNamespaces:l,relays:h??[{protocol:ga}],proposer:{publicKey:g,metadata:this.client.metadata}},u&&{sessionProperties:u}),{reject:w,resolve:N,done:R}=nr($.FIVE_MINUTES,Om);if(this.events.once(Ee("session_connect"),async({error:S,session:y})=>{if(S)w(S);else if(y){y.self.publicKey=g;const v=kr(ct({},y),{requiredNamespaces:y.requiredNamespaces,optionalNamespaces:y.optionalNamespaces});await this.client.session.set(y.topic,v),await this.setExpiry(y.topic,y.expiry),c&&await this.client.core.pairing.updateMetadata({topic:c,metadata:y.peer.metadata}),N(v)}}),!c){const{message:S}=z("NO_MATCHING_KEY",`connect() pairing topic: ${c}`);throw new Error(S)}const U=await this.sendRequest({topic:c,method:"wc_sessionPropose",params:m}),E=yt($.FIVE_MINUTES);return await this.setProposal(U,ct({id:U,expiry:E},m)),{uri:d,approval:R}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:s,namespaces:n,sessionProperties:l}=r,u=this.client.proposal.get(i);let{pairingTopic:h,proposer:c,requiredNamespaces:d,optionalNamespaces:f}=u;h=h||"",Ar(d)||(d=Rp(n,"approve()"));const g=await this.client.core.crypto.generateKeyPair(),m=c.publicKey,w=await this.client.core.crypto.generateSharedKey(g,m);h&&i&&(await this.client.core.pairing.updateMetadata({topic:h,metadata:c.metadata}),await this.sendResult({id:i,topic:h,result:{relay:{protocol:s??"irn"},responderPublicKey:g}}),await this.client.proposal.delete(i,Ce("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:h}));const N=ct({relay:{protocol:s??"irn"},namespaces:n,requiredNamespaces:d,optionalNamespaces:f,pairingTopic:h,controller:{publicKey:g,metadata:this.client.metadata},expiry:yt(Di)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(w),await this.sendRequest({topic:w,method:"wc_sessionSettle",params:N,throwOnFailedPublish:!0});const R=kr(ct({},N),{topic:w,pairingTopic:h,acknowledged:!1,self:N.controller,peer:{publicKey:c.publicKey,metadata:c.metadata},controller:g});return await this.client.session.set(w,R),await this.setExpiry(w,yt(Di)),{topic:w,acknowledged:()=>new Promise(U=>setTimeout(()=>U(this.client.session.get(w)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:i,reason:s}=r,{pairingTopic:n}=this.client.proposal.get(i);n&&(await this.sendError(i,n,s),await this.client.proposal.delete(i,Ce("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:s}=r,n=await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:s}}),{done:l,resolve:u,reject:h}=nr();return this.events.once(Ee("session_update",n),({error:c})=>{c?h(c):u()}),await this.client.session.update(i,{namespaces:s}),{acknowledged:l}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,s=await this.sendRequest({topic:i,method:"wc_sessionExtend",params:{}}),{done:n,resolve:l,reject:u}=nr();return this.events.once(Ee("session_extend",s),({error:h})=>{h?u(h):l()}),await this.setExpiry(i,yt(Di)),{acknowledged:n}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:s,topic:n,expiry:l}=r,u=ws(),{done:h,resolve:c,reject:d}=nr(l);return this.events.once(Ee("session_request",u),({error:f,result:g})=>{f?d(f):c(g)}),await Promise.all([new Promise(async f=>{await this.sendRequest({clientRpcId:u,topic:n,method:"wc_sessionRequest",params:{request:s,chainId:i},expiry:l,throwOnFailedPublish:!0}).catch(g=>d(g)),this.client.events.emit("session_request_sent",{topic:n,request:s,chainId:i,id:u}),f()}),new Promise(async f=>{const g=await this.client.core.storage.getItem(Ra);wp({id:u,topic:n,wcDeepLink:g}),f()}),h()]).then(f=>f[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:s}=r,{id:n}=s;St(s)?await this.sendResult({id:n,topic:i,result:s.result,throwOnFailedPublish:!0}):mt(s)&&await this.sendError(n,i,s.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const s=await this.sendRequest({topic:i,method:"wc_sessionPing",params:{}}),{done:n,resolve:l,reject:u}=nr();this.events.once(Ee("session_ping",s),({error:h})=>{h?u(h):l()}),await n()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:s,chainId:n}=r;await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:s,chainId:n}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest({topic:i,method:"wc_sessionDelete",params:Ce("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>Lp(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const i=this.client.core.pairing.pairings.get(r.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(n=>{var l,u;return((l=n.peerMetadata)==null?void 0:l.url)&&((u=n.peerMetadata)==null?void 0:u.url)===r.peer.metadata.url&&n.topic&&n.topic!==i.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(n=>this.client.core.pairing.disconnect({topic:n.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async(r,i)=>{const{self:s}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Ce("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(s.publicKey)&&await this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Ra).catch(n=>this.client.logger.warn(n))},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,Ce("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),s?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(n=>n.id!==r),s&&(this.sessionRequestQueue.state=Ot.idle)},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=Mr.wc_sessionRequest.req.ttl,{id:s,topic:n,params:l}=r;await this.client.pendingRequest.set(s,{id:s,topic:n,params:l}),i&&this.client.core.expirer.set(s,yt(i))},this.sendRequest=async r=>{const{topic:i,method:s,params:n,expiry:l,relayRpcId:u,clientRpcId:h,throwOnFailedPublish:c}=r,d=xr(s,n,h);if(Or()&&Am.includes(s)){const m=sr(JSON.stringify(d));this.client.core.verify.register({attestationId:m})}const f=await this.client.core.crypto.encode(i,d),g=Mr[s].req;return l&&(g.ttl=l),u&&(g.id=u),this.client.core.history.set(i,d),c?(g.internal=kr(ct({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,f,g)):this.client.core.relayer.publish(i,f,g).catch(m=>this.client.logger.error(m)),d.id},this.sendResult=async r=>{const{id:i,topic:s,result:n,throwOnFailedPublish:l}=r,u=Ds(i,n),h=await this.client.core.crypto.encode(s,u),c=await this.client.core.history.get(s,i),d=Mr[c.request.method].res;l?(d.internal=kr(ct({},d.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,h,d)):this.client.core.relayer.publish(s,h,d).catch(f=>this.client.logger.error(f)),await this.client.core.history.resolve(u)},this.sendError=async(r,i,s)=>{const n=bs(r,s),l=await this.client.core.crypto.encode(i,n),u=await this.client.core.history.get(i,r),h=Mr[u.request.method].res;this.client.core.relayer.publish(i,l,h),await this.client.core.history.resolve(n)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(s=>{Rt(s.expiry)&&r.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Rt(s.expiry)&&i.push(s.id)}),await Promise.all([...r.map(s=>this.deleteSession(s)),...i.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Ot.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ot.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(i=>setTimeout(i,300))}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=Ot.idle},this.processRequest=r=>{const{topic:i,payload:s}=r,n=s.method;switch(n){case"wc_sessionPropose":return this.onSessionProposeRequest(i,s);case"wc_sessionSettle":return this.onSessionSettleRequest(i,s);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,s);case"wc_sessionExtend":return this.onSessionExtendRequest(i,s);case"wc_sessionPing":return this.onSessionPingRequest(i,s);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,s);case"wc_sessionRequest":return this.onSessionRequest(i,s);case"wc_sessionEvent":return this.onSessionEventRequest(i,s);default:return this.client.logger.info(`Unsupported request method ${n}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:s}=r,n=(await this.client.core.history.get(i,s.id)).request.method;switch(n){case"wc_sessionPropose":return this.onSessionProposeResponse(i,s);case"wc_sessionSettle":return this.onSessionSettleResponse(i,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,s);case"wc_sessionExtend":return this.onSessionExtendResponse(i,s);case"wc_sessionPing":return this.onSessionPingResponse(i,s);case"wc_sessionRequest":return this.onSessionRequestResponse(i,s);default:return this.client.logger.info(`Unsupported response method ${n}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:i}=r,{message:s}=z("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)},this.onSessionProposeRequest=async(r,i)=>{const{params:s,id:n}=i;try{this.isValidConnect(ct({},i.params));const l=yt($.FIVE_MINUTES),u=ct({id:n,pairingTopic:r,expiry:l},s);await this.setProposal(n,u);const h=sr(JSON.stringify(i)),c=await this.getVerifyContext(h,u.proposer.metadata);this.client.events.emit("session_proposal",{id:n,params:u,verifyContext:c})}catch(l){await this.sendError(n,r,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(r,i)=>{const{id:s}=i;if(St(i)){const{result:n}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:n});const l=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const u=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:u});const h=n.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});const c=await this.client.core.crypto.generateSharedKey(u,h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:c});const d=await this.client.core.relayer.subscribe(c);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:r})}else mt(i)&&(await this.client.proposal.delete(s,Ce("USER_DISCONNECTED")),this.events.emit(Ee("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:s,params:n}=i;try{this.isValidSessionSettleRequest(n);const{relay:l,controller:u,expiry:h,namespaces:c,requiredNamespaces:d,optionalNamespaces:f,sessionProperties:g,pairingTopic:m}=i.params,w=ct({topic:r,relay:l,expiry:h,namespaces:c,acknowledged:!0,pairingTopic:m,requiredNamespaces:d,optionalNamespaces:f,controller:u.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:u.publicKey,metadata:u.metadata}},g&&{sessionProperties:g});await this.sendResult({id:i.id,topic:r,result:!0}),this.events.emit(Ee("session_connect"),{session:w}),this.cleanupDuplicatePairings(w)}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(r,i)=>{const{id:s}=i;St(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ee("session_approve",s),{})):mt(i)&&(await this.client.session.delete(r,Ce("USER_DISCONNECTED")),this.events.emit(Ee("session_approve",s),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:s,id:n}=i;try{const l=`${r}_session_update`,u=fi.get(l);if(u&&this.isRequestOutOfSync(u,n)){this.client.logger.info(`Discarding out of sync request - ${n}`);return}this.isValidUpdate(ct({topic:r},s)),await this.client.session.update(r,{namespaces:s.namespaces}),await this.sendResult({id:n,topic:r,result:!0}),this.client.events.emit("session_update",{id:n,topic:r,params:s}),fi.set(l,n)}catch(l){await this.sendError(n,r,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(r,i)=>parseInt(i.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,i)=>{const{id:s}=i;St(i)?this.events.emit(Ee("session_update",s),{}):mt(i)&&this.events.emit(Ee("session_update",s),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:s}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,yt(Di)),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_extend",{id:s,topic:r})}catch(n){await this.sendError(s,r,n),this.client.logger.error(n)}},this.onSessionExtendResponse=(r,i)=>{const{id:s}=i;St(i)?this.events.emit(Ee("session_extend",s),{}):mt(i)&&this.events.emit(Ee("session_extend",s),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:s}=i;try{this.isValidPing({topic:r}),await this.sendResult({id:s,topic:r,result:!0}),this.client.events.emit("session_ping",{id:s,topic:r})}catch(n){await this.sendError(s,r,n),this.client.logger.error(n)}},this.onSessionPingResponse=(r,i)=>{const{id:s}=i;setTimeout(()=>{St(i)?this.events.emit(Ee("session_ping",s),{}):mt(i)&&this.events.emit(Ee("session_ping",s),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await Promise.all([new Promise(n=>{this.client.core.relayer.once(Le.publish,async()=>{n(await this.deleteSession(r))})}),this.sendResult({id:s,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:s,topic:r})}catch(n){this.client.logger.error(n)}},this.onSessionRequest=async(r,i)=>{const{id:s,params:n}=i;try{this.isValidRequest(ct({topic:r},n)),await this.setPendingSessionRequest({id:s,topic:r,params:n}),this.addSessionRequestToSessionRequestQueue({id:s,topic:r,params:n}),await this.processSessionRequestQueue()}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(r,i)=>{const{id:s}=i;St(i)?this.events.emit(Ee("session_request",s),{result:i.result}):mt(i)&&this.events.emit(Ee("session_request",s),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:s,params:n}=i;try{const l=`${r}_session_event_${n.event.name}`,u=fi.get(l);if(u&&this.isRequestOutOfSync(u,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(ct({topic:r},n)),this.client.events.emit("session_event",{id:s,topic:r,params:n}),fi.set(l,s)}catch(l){await this.sendError(s,r,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Ot.idle,this.processSessionRequestQueue()},$.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=async()=>{if(this.sessionRequestQueue.state===Ot.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{const{id:i,topic:s,params:n}=r,l=sr(JSON.stringify(xr("wc_sessionRequest",n,i))),u=this.client.session.get(s),h=await this.getVerifyContext(l,u.peer.metadata);this.sessionRequestQueue.state=Ot.active,this.client.events.emit("session_request",{id:i,topic:s,params:n,verifyContext:h})}catch(i){this.client.logger.error(i)}},this.isValidConnect=async r=>{if(!at(r)){const{message:h}=z("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(h)}const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:n,sessionProperties:l,relays:u}=r;if(rt(i)||await this.isValidPairingTopic(i),!Wp(u,!0)){const{message:h}=z("MISSING_OR_INVALID",`connect() relays: ${u}`);throw new Error(h)}!rt(s)&&Ar(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!rt(n)&&Ar(n)!==0&&this.validateNamespaces(n,"optionalNamespaces"),rt(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(r,i)=>{const s=Bp(r,"connect()",i);if(s)throw new Error(s.message)},this.isValidApprove=async r=>{if(!at(r))throw new Error(z("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:s,relayProtocol:n,sessionProperties:l}=r;await this.isValidProposalId(i);const u=this.client.proposal.get(i),h=pi(s,"approve()");if(h)throw new Error(h.message);const c=Lo(u.requiredNamespaces,s,"approve()");if(c)throw new Error(c.message);if(!Ne(n,!0)){const{message:d}=z("MISSING_OR_INVALID",`approve() relayProtocol: ${n}`);throw new Error(d)}rt(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async r=>{if(!at(r)){const{message:n}=z("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(n)}const{id:i,reason:s}=r;if(await this.isValidProposalId(i),!Yp(s)){const{message:n}=z("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(n)}},this.isValidSessionSettleRequest=r=>{if(!at(r)){const{message:c}=z("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(c)}const{relay:i,controller:s,namespaces:n,expiry:l}=r;if(!xo(i)){const{message:c}=z("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(c)}const u=Kp(s,"onSessionSettleRequest()");if(u)throw new Error(u.message);const h=pi(n,"onSessionSettleRequest()");if(h)throw new Error(h.message);if(Rt(l)){const{message:c}=z("EXPIRED","onSessionSettleRequest()");throw new Error(c)}},this.isValidUpdate=async r=>{if(!at(r)){const{message:h}=z("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(h)}const{topic:i,namespaces:s}=r;await this.isValidSessionTopic(i);const n=this.client.session.get(i),l=pi(s,"update()");if(l)throw new Error(l.message);const u=Lo(n.requiredNamespaces,s,"update()");if(u)throw new Error(u.message)},this.isValidExtend=async r=>{if(!at(r)){const{message:s}=z("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!at(r)){const{message:h}=z("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(h)}const{topic:i,request:s,chainId:n,expiry:l}=r;await this.isValidSessionTopic(i);const{namespaces:u}=this.client.session.get(i);if(!Uo(u,n)){const{message:h}=z("MISSING_OR_INVALID",`request() chainId: ${n}`);throw new Error(h)}if(!Qp(s)){const{message:h}=z("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(h)}if(!Zp(u,n,s.method)){const{message:h}=z("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(h)}if(l&&!sf(l,Ps)){const{message:h}=z("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${Ps.min} and ${Ps.max}`);throw new Error(h)}},this.isValidRespond=async r=>{if(!at(r)){const{message:n}=z("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(n)}const{topic:i,response:s}=r;if(await this.isValidSessionTopic(i),!Jp(s)){const{message:n}=z("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(n)}},this.isValidPing=async r=>{if(!at(r)){const{message:s}=z("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!at(r)){const{message:u}=z("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(u)}const{topic:i,event:s,chainId:n}=r;await this.isValidSessionTopic(i);const{namespaces:l}=this.client.session.get(i);if(!Uo(l,n)){const{message:u}=z("MISSING_OR_INVALID",`emit() chainId: ${n}`);throw new Error(u)}if(!Xp(s)){const{message:u}=z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(u)}if(!ef(l,n,s.name)){const{message:u}=z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(u)}},this.isValidDisconnect=async r=>{if(!at(r)){const{message:s}=z("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.getVerifyContext=async(r,i)=>{const s={verified:{verifyUrl:i.verifyUrl||mi,validation:"UNKNOWN",origin:i.url||""}};try{const n=await this.client.core.verify.resolve({attestationId:r,verifyUrl:i.verifyUrl});n&&(s.verified.origin=n,s.verified.validation=n===new URL(i.url).origin?"VALID":"INVALID")}catch(n){this.client.logger.error(n)}return this.client.logger.info(`Verify context: ${JSON.stringify(s)}`),s},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(s=>{if(!Ne(s,!1)){const{message:n}=z("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(n)}})}}async isInitialized(){if(!this.initialized){const{message:t}=z("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Le.message,async t=>{const{topic:r,message:i}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const s=await this.client.core.crypto.decode(r,i);try{vs(s)?(this.client.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):gi(s)?(await this.client.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.client.core.history.delete(r,s.id)):this.onRelayEventUnknownPayload({topic:r,payload:s})}catch(n){this.client.logger.error(n)}})}registerExpirerEvents(){this.client.core.expirer.on(pt.expired,async t=>{const{topic:r,id:i}=No(t.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,z("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(t){if(!Ne(t,!1)){const{message:r}=z("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Rt(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=z("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Ne(t,!1)){const{message:r}=z("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=z("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Rt(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=z("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Ne(t,!1)){const{message:r}=z("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=z("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!Gp(t)){const{message:r}=z("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=z("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Rt(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=z("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class Mm extends wi{constructor(t,r){super(t,r,Im,Ts),this.core=t,this.logger=r}}class km extends wi{constructor(t,r){super(t,r,Cm,Ts),this.core=t,this.logger=r}}class Fm extends wi{constructor(t,r){super(t,r,Tm,Ts,i=>i.id),this.core=t,this.logger=r}}class Rs extends vl{constructor(t){super(t),this.protocol=Ta,this.version=Aa,this.name=As.name,this.events=new Ct.EventEmitter,this.on=(i,s)=>this.events.on(i,s),this.once=(i,s)=>this.events.once(i,s),this.off=(i,s)=>this.events.off(i,s),this.removeListener=(i,s)=>this.events.removeListener(i,s),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(s){throw this.logger.error(s.message),s}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(s){throw this.logger.error(s.message),s}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(s){throw this.logger.error(s.message),s}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(s){throw this.logger.error(s.message),s}},this.update=async i=>{try{return await this.engine.update(i)}catch(s){throw this.logger.error(s.message),s}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(s){throw this.logger.error(s.message),s}},this.request=async i=>{try{return await this.engine.request(i)}catch(s){throw this.logger.error(s.message),s}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(s){throw this.logger.error(s.message),s}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(s){throw this.logger.error(s.message),s}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(s){throw this.logger.error(s.message),s}},this.find=i=>{try{return this.engine.find(i)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=(t==null?void 0:t.name)||As.name,this.metadata=(t==null?void 0:t.metadata)||hp();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Hi(Vi({level:(t==null?void 0:t.logger)||As.logger}));this.core=(t==null?void 0:t.core)||new Sm(t),this.logger=ut(r,this.name),this.session=new km(this.core,this.logger),this.proposal=new Mm(this.core,this.logger),this.pendingRequest=new Fm(this.core,this.logger),this.engine=new jm(this)}static async init(t){const r=new Rs(t);return await r.initialize(),r}get context(){return nt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}var Km=Object.defineProperty,zm=Object.defineProperties,Hm=Object.getOwnPropertyDescriptors,La=Object.getOwnPropertySymbols,Vm=Object.prototype.hasOwnProperty,qm=Object.prototype.propertyIsEnumerable,ja=(e,t,r)=>t in e?Km(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$m=(e,t)=>{for(var r in t||(t={}))Vm.call(t,r)&&ja(e,r,t[r]);if(La)for(var r of La(t))qm.call(t,r)&&ja(e,r,t[r]);return e},Bm=(e,t)=>zm(e,Hm(t)),xs=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},ve=(e,t,r)=>(xs(e,t,"read from private field"),r?r.call(e):t.get(e)),Wt=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},bi=(e,t,r,i)=>(xs(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),je=(e,t,r)=>(xs(e,t,"access private method"),r),Gt,ar,Fr,Te,Us,Ma,Me,it,Ls,ka;class Wm{constructor(t){Wt(this,Us),Wt(this,Me),Wt(this,Ls),Wt(this,Gt,void 0),Wt(this,ar,void 0),Wt(this,Fr,void 0),Wt(this,Te,void 0),bi(this,Gt,t),bi(this,ar,je(this,Us,Ma).call(this)),je(this,Me,it).call(this)}async connect(t){const{requiredNamespaces:r,optionalNamespaces:i}=t;return new Promise(async(s,n)=>{await je(this,Me,it).call(this);const l=ve(this,ar).subscribeModal(c=>{c.open||(l(),n(new Error("Modal closed")))}),{uri:u,approval:h}=await ve(this,Te).connect(t);if(u){const c=new Set;r&&Object.values(r).forEach(({chains:d})=>{d&&d.forEach(f=>c.add(f))}),i&&Object.values(i).forEach(({chains:d})=>{d&&d.forEach(f=>c.add(f))}),await ve(this,ar).openModal({uri:u,chains:Array.from(c)})}try{const c=await h();s(c)}catch(c){n(c)}finally{l(),ve(this,ar).closeModal()}})}async disconnect(t){await je(this,Me,it).call(this),await ve(this,Te).disconnect(t)}async request(t){return await je(this,Me,it).call(this),await ve(this,Te).request(t)}async getSessions(){return await je(this,Me,it).call(this),ve(this,Te).session.getAll()}async getSession(){return await je(this,Me,it).call(this),ve(this,Te).session.getAll().at(-1)}async onSessionEvent(t){await je(this,Me,it).call(this),ve(this,Te).on("session_event",t)}async offSessionEvent(t){await je(this,Me,it).call(this),ve(this,Te).off("session_event",t)}async onSessionUpdate(t){await je(this,Me,it).call(this),ve(this,Te).on("session_update",t)}async offSessionUpdate(t){await je(this,Me,it).call(this),ve(this,Te).off("session_update",t)}async onSessionDelete(t){await je(this,Me,it).call(this),ve(this,Te).on("session_delete",t)}async offSessionDelete(t){await je(this,Me,it).call(this),ve(this,Te).off("session_delete",t)}async onSessionExpire(t){await je(this,Me,it).call(this),ve(this,Te).on("session_expire",t)}async offSessionExpire(t){await je(this,Me,it).call(this),ve(this,Te).off("session_expire",t)}}Gt=new WeakMap,ar=new WeakMap,Fr=new WeakMap,Te=new WeakMap,Us=new WeakSet,Ma=function(){const{modalOptions:e,projectId:t}=ve(this,Gt);return new uc(Bm($m({},e),{projectId:t}))},Me=new WeakSet,it=async function(){return ve(this,Te)?!0:(!ve(this,Fr)&&typeof window<"u"&&bi(this,Fr,je(this,Ls,ka).call(this)),ve(this,Fr))},Ls=new WeakSet,ka=async function(){bi(this,Te,await Rs.init({metadata:ve(this,Gt).metadata,projectId:ve(this,Gt).projectId,relayUrl:ve(this,Gt).relayUrl}));const e=await ve(this,Te).core.crypto.getClientId();try{localStorage.setItem("WCM_WALLETCONNECT_CLIENT_ID",e)}catch{console.info("Unable to set client id")}},za=Object.freeze(Object.defineProperty({__proto__:null,WalletConnectModalSign:Wm},Symbol.toStringTag,{value:"Module"}))});export{ks as R,_i as T,t0 as __tla,Ae as a,za as i,Si as n,Ha as o,dt as p,zr as s,Va as t,jt as y};
